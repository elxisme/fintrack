var bu=Object.defineProperty;var wu=(r,e,t)=>e in r?bu(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var ye=(r,e,t)=>wu(r,typeof e!="symbol"?e+"":e,t);import{r as J,a as ku,b as Su,c as Wt,R as Q0}from"./vendor-Cu3A5fdw.js";import{c as eh}from"./store-BBwJGlAv.js";import{E as Tu,a as th,U as Eu,L as Au,H as rh,C as an,T as Ni,S as Cu,D as Nu,b as nh,M as Ou,c as Fu,d as Du,W as Iu,e as Pu,R as Oi,P as Bn,f as Pa,g as la,h as Dl,i as Ru,j as sh,F as ih,k as ju,X as Qt,B as Io,l as Po,A as Mu,m as ah,n as Fi,o as Di,p as In,q as Ii,r as Pi,s as co,t as Lu,u as oh,v as Bu,w as Uu,x as Ra,y as $u,z as Wu,G as Hu,I as zu,J as Vu,K as Gu,N as Xu,O as Ku}from"./ui-noLjsAKu.js";import{f as Ge,s as nn,e as yr,a as Yu,b as lh}from"./utils-D1mUarl-.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var ch={exports:{}},ca={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qu=J,Ju=Symbol.for("react.element"),Zu=Symbol.for("react.fragment"),Qu=Object.prototype.hasOwnProperty,eg=qu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tg={key:!0,ref:!0,__self:!0,__source:!0};function hh(r,e,t){var n,s={},i=null,a=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Qu.call(e,n)&&!tg.hasOwnProperty(n)&&(s[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:Ju,type:r,key:i,ref:a,props:s,_owner:eg.current}}ca.Fragment=Zu;ca.jsx=hh;ca.jsxs=hh;ch.exports=ca;var d=ch.exports,dh,Il=ku;dh=Il.createRoot,Il.hydrateRoot;const rg="modulepreload",ng=function(r){return"/"+r},Pl={},$s=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(t.map(l=>{if(l=ng(l),l in Pl)return;Pl[l]=!0;const c=l.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":rg,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((u,g)=>{f.addEventListener("load",u),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},sg=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>$s(async()=>{const{default:n}=await Promise.resolve().then(()=>Hn);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class Ro extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class ig extends Ro{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ag extends Ro{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class og extends Ro{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ho;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(ho||(ho={}));var lg=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(n.next(h))}catch(f){a(f)}}function l(h){try{c(n.throw(h))}catch(f){a(f)}}function c(h){h.done?i(h.value):s(h.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};class cg{constructor(e,{headers:t={},customFetch:n,region:s=ho.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=sg(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return lg(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const h=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:c}).catch(p=>{throw new ig(p)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new ag(h);if(!h.ok)throw new og(h);let u=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return u==="application/json"?g=yield h.json():u==="application/octet-stream"?g=yield h.blob():u==="text/event-stream"?g=h:u==="multipart/form-data"?g=yield h.formData():g=yield h.text(),{data:g,error:null}}catch(s){return{data:null,error:s}}})}}var St={},jo={},ha={},Ws={},da={},fa={},hg=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Un=hg();const dg=Un.fetch,fh=Un.fetch.bind(Un),uh=Un.Headers,fg=Un.Request,ug=Un.Response,Hn=Object.freeze(Object.defineProperty({__proto__:null,Headers:uh,Request:fg,Response:ug,default:fh,fetch:dg},Symbol.toStringTag,{value:"Module"})),gg=Su(Hn);var ua={};Object.defineProperty(ua,"__esModule",{value:!0});let mg=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};ua.default=mg;var gh=Wt&&Wt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(fa,"__esModule",{value:!0});const xg=gh(gg),pg=gh(ua);let vg=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=xg.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,l;let c=null,h=null,f=null,u=i.status,g=i.statusText;if(i.ok){if(this.method!=="HEAD"){const v=await i.text();v===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?h=v:h=JSON.parse(v))}const m=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),x=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&x&&x.length>1&&(f=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(c={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,f=null,u=406,g="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const m=await i.text();try{c=JSON.parse(m),Array.isArray(c)&&i.status===404&&(h=[],c=null,u=200,g="OK")}catch{i.status===404&&m===""?(u=204,g="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,u=200,g="OK"),c&&this.shouldThrowOnError)throw new pg.default(c)}return{error:c,data:h,count:f,status:u,statusText:g}});return this.shouldThrowOnError||(s=s.catch(i=>{var a,o,l;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};fa.default=vg;var yg=Wt&&Wt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(da,"__esModule",{value:!0});const _g=yg(fa);let bg=class extends _g.default{select(e){let t=!1;const n=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};da.default=bg;var wg=Wt&&Wt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ws,"__esModule",{value:!0});const kg=wg(da);let Sg=class extends kg.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,n])=>{this.url.searchParams.append(t,`eq.${n}`)}),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}};Ws.default=Sg;var Tg=Wt&&Wt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ha,"__esModule",{value:!0});const Qn=Tg(Ws);let Eg=class{constructor(e,{headers:t={},schema:n,fetch:s}){this.url=e,this.headers=t,this.schema=n,this.fetch=s}select(e,{head:t=!1,count:n}={}){const s=t?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new Qn.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:n=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Qn.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){const a="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(l.length>0){const c=[...new Set(l)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new Qn.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new Qn.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Qn.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};ha.default=Eg;var ga={},ma={};Object.defineProperty(ma,"__esModule",{value:!0});ma.version=void 0;ma.version="0.0.0-automated";Object.defineProperty(ga,"__esModule",{value:!0});ga.DEFAULT_HEADERS=void 0;const Ag=ma;ga.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Ag.version}`};var mh=Wt&&Wt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(jo,"__esModule",{value:!0});const Cg=mh(ha),Ng=mh(Ws),Og=ga;let Fg=class xh{constructor(e,{headers:t={},schema:n,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},Og.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new Cg.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new xh(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:s=!1,count:i}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let l;n||s?(a=n?"HEAD":"GET",Object.entries(t).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{o.searchParams.append(h,f)})):(a="POST",l=t);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new Ng.default({method:a,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};jo.default=Fg;var zn=Wt&&Wt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(St,"__esModule",{value:!0});St.PostgrestError=St.PostgrestBuilder=St.PostgrestTransformBuilder=St.PostgrestFilterBuilder=St.PostgrestQueryBuilder=St.PostgrestClient=void 0;const ph=zn(jo);St.PostgrestClient=ph.default;const vh=zn(ha);St.PostgrestQueryBuilder=vh.default;const yh=zn(Ws);St.PostgrestFilterBuilder=yh.default;const _h=zn(da);St.PostgrestTransformBuilder=_h.default;const bh=zn(fa);St.PostgrestBuilder=bh.default;const wh=zn(ua);St.PostgrestError=wh.default;var Dg=St.default={PostgrestClient:ph.default,PostgrestQueryBuilder:vh.default,PostgrestFilterBuilder:yh.default,PostgrestTransformBuilder:_h.default,PostgrestBuilder:bh.default,PostgrestError:wh.default};const{PostgrestClient:Ig,PostgrestQueryBuilder:TE,PostgrestFilterBuilder:EE,PostgrestTransformBuilder:AE,PostgrestBuilder:CE,PostgrestError:NE}=Dg;function Pg(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Rg=Pg(),jg="2.11.15",Mg=`realtime-js/${jg}`,Lg="1.0.0",kh=1e4,Bg=1e3;var gs;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(gs||(gs={}));var mt;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(mt||(mt={}));var Yt;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Yt||(Yt={}));var fo;(function(r){r.websocket="websocket"})(fo||(fo={}));var en;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(en||(en={}));class Ug{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const s=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(e.slice(a,a+s));a=a+s;const l=n.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(n.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class Sh{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var je;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(je||(je={}));const Rl=(r,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,a)=>(i[a]=$g(a,r,e,s),i),{})},$g=(r,e,t,n)=>{const s=e.find(o=>o.name===r),i=s==null?void 0:s.type,a=t[r];return i&&!n.includes(i)?Th(i,a):uo(a)},Th=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Vg(e,t)}switch(r){case je.bool:return Wg(e);case je.float4:case je.float8:case je.int2:case je.int4:case je.int8:case je.numeric:case je.oid:return Hg(e);case je.json:case je.jsonb:return zg(e);case je.timestamp:return Gg(e);case je.abstime:case je.date:case je.daterange:case je.int4range:case je.int8range:case je.money:case je.reltime:case je.text:case je.time:case je.timestamptz:case je.timetz:case je.tsrange:case je.tstzrange:return uo(e);default:return uo(e)}},uo=r=>r,Wg=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Hg=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},zg=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Vg=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let i;const a=r.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>Th(e,o))}return r},Gg=r=>typeof r=="string"?r.replace(" ","T"):r,Eh=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class ja{constructor(e,t,n={},s=kh){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var jl;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(jl||(jl={}));class ms{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ms.syncState(this.state,s,i,a),this.pendingDiffs.forEach(l=>{this.state=ms.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ms.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(c,h)=>{a[c]||(l[c]=h)}),this.map(a,(c,h)=>{const f=i[c];if(f){const u=h.map(x=>x.presence_ref),g=f.map(x=>x.presence_ref),p=h.filter(x=>g.indexOf(x.presence_ref)<0),m=f.filter(x=>u.indexOf(x.presence_ref)<0);p.length>0&&(o[c]=p),m.length>0&&(l[c]=m)}else o[c]=h}),this.syncDiff(i,{joins:o,leaves:l},n,s)}static syncDiff(e,t,n,s){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,l)=>{var c;const h=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),h.length>0){const f=e[o].map(g=>g.presence_ref),u=h.filter(g=>f.indexOf(g.presence_ref)<0);e[o].unshift(...u)}n(o,h,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const h=l.map(f=>f.presence_ref);c=c.filter(f=>h.indexOf(f.presence_ref)<0),e[o]=c,s(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ml;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Ml||(Ml={}));var Ll;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Ll||(Ll={}));var pr;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(pr||(pr={}));class Mo{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=mt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ja(this,Yt.join,this.params,this.timeout),this.rejoinTimer=new Sh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=mt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=mt.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=mt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=mt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Yt.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new ms(this),this.broadcastEndpointURL=Eh(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==mt.closed){const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(h=>e==null?void 0:e(pr.CHANNEL_ERROR,h)),this._onClose(()=>e==null?void 0:e(pr.CLOSED));const l={},c={broadcast:i,presence:a,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:h})=>{var f;if(this.socket.setAuth(),h===void 0){e==null||e(pr.SUBSCRIBED);return}else{const u=this.bindings.postgres_changes,g=(f=u==null?void 0:u.length)!==null&&f!==void 0?f:0,p=[];for(let m=0;m<g;m++){const x=u[m],{filter:{event:v,schema:b,table:_,filter:k}}=x,O=h&&h[m];if(O&&O.event===v&&O.schema===b&&O.table===_&&O.filter===k)p.push(Object.assign(Object.assign({},x),{id:O.id}));else{this.unsubscribe(),this.state=mt.errored,e==null||e(pr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(pr.SUBSCRIBED);return}}).receive("error",h=>{this.state=mt.errored,e==null||e(pr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(pr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=mt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Yt.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new ja(this,Yt.leave,{},e),n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),a}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new ja(this,e,t,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:h}=Yt;if(n&&[o,l,c,h].indexOf(a)>=0&&n!==this._joinRef())return;let u=this._onMessage(a,t,n);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(g=>{var p,m,x;return((p=g.filter)===null||p===void 0?void 0:p.event)==="*"||((x=(m=g.filter)===null||m===void 0?void 0:m.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===a}).map(g=>g.callback(u,n)):(i=this.bindings[a])===null||i===void 0||i.filter(g=>{var p,m,x,v,b,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in g){const k=g.id,O=(p=g.filter)===null||p===void 0?void 0:p.event;return k&&((m=t.ids)===null||m===void 0?void 0:m.includes(k))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((x=t.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const k=(b=(v=g==null?void 0:g.filter)===null||v===void 0?void 0:v.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return k==="*"||k===((_=t==null?void 0:t.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===a}).map(g=>{if(typeof u=="object"&&"ids"in u){const p=u.data,{schema:m,table:x,commit_timestamp:v,type:b,errors:_}=p;u=Object.assign(Object.assign({},{schema:m,table:x,commit_timestamp:v,eventType:b,new:{},old:{},errors:_}),this._getPayloadRecords(p))}g.callback(u,n)})}_isClosed(){return this.state===mt.closed}_isJoined(){return this.state===mt.joined}_isJoining(){return this.state===mt.joining}_isLeaving(){return this.state===mt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Mo.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Yt.close,{},e)}_onError(e){this._on(Yt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=mt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Rl(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Rl(e.columns,e.old_record)),t}}const Bl=()=>{},Xg=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Kg{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=kh,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Bl,this.ref=0,this.logger=Bl,this.conn=null,this.sendBuffer=[],this.serializer=new Ug,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>$s(async()=>{const{default:l}=await Promise.resolve().then(()=>Hn);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${fo.websocket}`,this.httpEndpoint=Eh(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Sh(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Rg),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Lg}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case gs.connecting:return en.Connecting;case gs.open:return en.Open;case gs.closing:return en.Closing;default:return en.Closed}}isConnected(){return this.connectionState()===en.Open}channel(e,t={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new Mo(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:n,payload:s,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${n} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const s={access_token:t,version:Mg};t&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Yt.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Bg,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:n,event:s,payload:i,ref:a}=t;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${a&&"("+a+")"||""}`,i),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(s,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Yt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([Xg],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class Lo extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function rt(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Yg extends Lo{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class go extends Lo{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var qg=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(n.next(h))}catch(f){a(f)}}function l(h){try{c(n.throw(h))}catch(f){a(f)}}function c(h){h.done?i(h.value):s(h.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};const Ah=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>$s(async()=>{const{default:n}=await Promise.resolve().then(()=>Hn);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},Jg=()=>qg(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $s(()=>Promise.resolve().then(()=>Hn),void 0)).Response:Response}),mo=r=>{if(Array.isArray(r))return r.map(t=>mo(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=mo(n)}),e};var gn=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(n.next(h))}catch(f){a(f)}}function l(h){try{c(n.throw(h))}catch(f){a(f)}}function c(h){h.done?i(h.value):s(h.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};const Ma=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Zg=(r,e,t)=>gn(void 0,void 0,void 0,function*(){const n=yield Jg();r instanceof n&&!(t!=null&&t.noResolveJson)?r.json().then(s=>{e(new Yg(Ma(s),r.status||500))}).catch(s=>{e(new go(Ma(s),s))}):e(new go(Ma(r),r))}),Qg=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),t))};function Hs(r,e,t,n,s,i){return gn(this,void 0,void 0,function*(){return new Promise((a,o)=>{r(t,Qg(e,n,s,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Zg(l,o,n))})})}function Ri(r,e,t,n){return gn(this,void 0,void 0,function*(){return Hs(r,"GET",e,t,n)})}function Or(r,e,t,n,s){return gn(this,void 0,void 0,function*(){return Hs(r,"POST",e,n,s,t)})}function em(r,e,t,n,s){return gn(this,void 0,void 0,function*(){return Hs(r,"PUT",e,n,s,t)})}function tm(r,e,t,n){return gn(this,void 0,void 0,function*(){return Hs(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function Ch(r,e,t,n,s){return gn(this,void 0,void 0,function*(){return Hs(r,"DELETE",e,n,s,t)})}var wt=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(n.next(h))}catch(f){a(f)}}function l(h){try{c(n.throw(h))}catch(f){a(f)}}function c(h){h.done?i(h.value):s(h.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};const rm={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ul={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class nm{constructor(e,t={},n,s){this.url=e,this.headers=t,this.bucketId=n,this.fetch=Ah(s)}uploadOrUpdate(e,t,n,s){return wt(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},Ul),s);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const c=this._removeEmptyFolders(t),h=this._getFinalPath(c),f=yield this.fetch(`${this.url}/object/${h}`,Object.assign({method:e,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),u=yield f.json();return f.ok?{data:{path:c,id:u.Id,fullPath:u.Key},error:null}:{data:null,error:u}}catch(i){if(rt(i))return{data:null,error:i};throw i}})}upload(e,t,n){return wt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,s){return wt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:Ul.upsert},s),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:h}),u=yield f.json();return f.ok?{data:{path:i,fullPath:u.Key},error:null}:{data:null,error:u}}catch(l){if(rt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return wt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield Or(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new Lo("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(n){if(rt(n))return{data:null,error:n};throw n}})}update(e,t,n){return wt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return wt(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(rt(s))return{data:null,error:s};throw s}})}copy(e,t,n){return wt(this,void 0,void 0,function*(){try{return{data:{path:(yield Or(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(rt(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,n){return wt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Or(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(rt(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,n){return wt(this,void 0,void 0,function*(){try{const s=yield Or(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(rt(s))return{data:null,error:s};throw s}})}download(e,t){return wt(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Ri(this.fetch,`${this.url}/${s}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(rt(o))return{data:null,error:o};throw o}})}info(e){return wt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield Ri(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:mo(n),error:null}}catch(n){if(rt(n))return{data:null,error:n};throw n}})}exists(e){return wt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield tm(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(rt(n)&&n instanceof go){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(e){return wt(this,void 0,void 0,function*(){try{return{data:yield Ch(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(rt(t))return{data:null,error:t};throw t}})}list(e,t,n){return wt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},rm),t),{prefix:e||""});return{data:yield Or(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(rt(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const sm="2.7.1",im={"X-Client-Info":`storage-js/${sm}`};var _n=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(n.next(h))}catch(f){a(f)}}function l(h){try{c(n.throw(h))}catch(f){a(f)}}function c(h){h.done?i(h.value):s(h.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};class am{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},im),t),this.fetch=Ah(n)}listBuckets(){return _n(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(rt(e))return{data:null,error:e};throw e}})}getBucket(e){return _n(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(rt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return _n(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(rt(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return _n(this,void 0,void 0,function*(){try{return{data:yield em(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(rt(n))return{data:null,error:n};throw n}})}emptyBucket(e){return _n(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(rt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return _n(this,void 0,void 0,function*(){try{return{data:yield Ch(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(rt(t))return{data:null,error:t};throw t}})}}class om extends am{constructor(e,t={},n){super(e,t,n)}from(e){return new nm(this.url,this.headers,e,this.fetch)}}const lm="2.50.2";let as="";typeof Deno<"u"?as="deno":typeof document<"u"?as="web":typeof navigator<"u"&&navigator.product==="ReactNative"?as="react-native":as="node";const cm={"X-Client-Info":`supabase-js-${as}/${lm}`},hm={headers:cm},dm={schema:"public"},fm={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},um={};var gm=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(n.next(h))}catch(f){a(f)}}function l(h){try{c(n.throw(h))}catch(f){a(f)}}function c(h){h.done?i(h.value):s(h.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};const mm=r=>{let e;return r?e=r:typeof fetch>"u"?e=fh:e=fetch,(...t)=>e(...t)},xm=()=>typeof Headers>"u"?uh:Headers,pm=(r,e,t)=>{const n=mm(t),s=xm();return(i,a)=>gm(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:r;let c=new s(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},a),{headers:c}))})};var vm=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(n.next(h))}catch(f){a(f)}}function l(h){try{c(n.throw(h))}catch(f){a(f)}}function c(h){h.done?i(h.value):s(h.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};function ym(r){return r.endsWith("/")?r:r+"/"}function _m(r,e){var t,n;const{db:s,auth:i,realtime:a,global:o}=r,{db:l,auth:c,realtime:h,global:f}=e,u={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},h),a),global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(t=f==null?void 0:f.headers)!==null&&t!==void 0?t:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>vm(this,void 0,void 0,function*(){return""})};return r.accessToken?u.accessToken=r.accessToken:delete u.accessToken,u}const Nh="2.70.0",On=30*1e3,xo=3,La=xo*On,bm="http://localhost:9999",wm="supabase.auth.token",km={"X-Client-Info":`gotrue-js/${Nh}`},po="X-Supabase-Api-Version",Oh={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Sm=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Tm=6e5;class Bo extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function ve(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class Em extends Bo{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function Am(r){return ve(r)&&r.name==="AuthApiError"}class Fh extends Bo{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Wr extends Bo{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class Nr extends Wr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Cm(r){return ve(r)&&r.name==="AuthSessionMissingError"}class ei extends Wr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ti extends Wr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ri extends Wr{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Nm(r){return ve(r)&&r.name==="AuthImplicitGrantRedirectError"}class $l extends Wr{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class vo extends Wr{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ba(r){return ve(r)&&r.name==="AuthRetryableFetchError"}class Wl extends Wr{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class xs extends Wr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ji="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Hl=` 	
\r=`.split(""),Om=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Hl.length;e+=1)r[Hl[e].charCodeAt(0)]=-2;for(let e=0;e<ji.length;e+=1)r[ji[e].charCodeAt(0)]=e;return r})();function zl(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(ji[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(ji[n]),e.queuedBits-=6}}function Dh(r,e,t){const n=Om[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Vl(r){const e=[],t=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{Im(a,n,t)};for(let a=0;a<r.length;a+=1)Dh(r.charCodeAt(a),s,i);return e.join("")}function Fm(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Dm(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}Fm(n,e)}}function Im(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if(!(r>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Pm(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<r.length;s+=1)Dh(r.charCodeAt(s),t,n);return new Uint8Array(e)}function Rm(r){const e=[];return Dm(r,t=>e.push(t)),new Uint8Array(e)}function jm(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};return r.forEach(s=>zl(s,t,n)),zl(null,t,n),e.join("")}function Mm(r){return Math.round(Date.now()/1e3)+r}function Lm(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const Kt=()=>typeof window<"u"&&typeof document<"u",Gr={tested:!1,writable:!1},ps=()=>{if(!Kt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Gr.tested)return Gr.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Gr.tested=!0,Gr.writable=!0}catch{Gr.tested=!0,Gr.writable=!1}return Gr.writable};function Bm(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((n,s)=>{e[s]=n}),e}const Ih=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>$s(async()=>{const{default:n}=await Promise.resolve().then(()=>Hn);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},Um=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Ph=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},ni=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},si=async(r,e)=>{await r.removeItem(e)};class xa{constructor(){this.promise=new xa.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}xa.promiseConstructor=Promise;function Ua(r){const e=r.split(".");if(e.length!==3)throw new xs("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!Sm.test(e[n]))throw new xs("JWT not in base64url format");return{header:JSON.parse(Vl(e[0])),payload:JSON.parse(Vl(e[1])),signature:Pm(e[2]),raw:{header:e[0],payload:e[1]}}}async function $m(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Wm(r,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await r(i);if(!e(i,null,a)){n(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function Hm(r){return("0"+r.toString(16)).substr(-2)}function zm(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,Hm).join("")}async function Vm(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function Gm(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Vm(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function bn(r,e,t=!1){const n=zm();let s=n;t&&(s+="/PASSWORD_RECOVERY"),await Ph(r,`${e}-code-verifier`,s);const i=await Gm(n);return[i,n===i?"plain":"s256"]}const Xm=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Km(r){const e=r.headers.get(po);if(!e||!e.match(Xm))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Ym(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function qm(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Jm=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function wn(r){if(!Jm.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Zm=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};const Zr=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Qm=[502,503,504];async function Gl(r){var e;if(!Um(r))throw new vo(Zr(r),0);if(Qm.includes(r.status))throw new vo(Zr(r),r.status);let t;try{t=await r.json()}catch(i){throw new Fh(Zr(i),i)}let n;const s=Km(r);if(s&&s.getTime()>=Oh["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new Wl(Zr(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Nr}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Wl(Zr(t),r.status,t.weak_password.reasons);throw new Em(Zr(t),r.status||500,n)}const ex=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};async function be(r,e,t,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[po]||(i[po]=Oh["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await tx(r,e,t+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function tx(r,e,t,n,s,i){const a=ex(e,n,s,i);let o;try{o=await r(t,Object.assign({},a))}catch(l){throw console.error(l),new vo(Zr(l),0)}if(o.ok||await Gl(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await Gl(l)}}function gr(r){var e;let t=null;ix(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=Mm(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function Xl(r){const e=gr(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Fr(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function rx(r){return{data:r,error:null}}function nx(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i}=r,a=Zm(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function sx(r){return r}function ix(r){return r.access_token&&r.refresh_token&&r.expires_in}const $a=["global","local","others"];var ax=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};class ox{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=Ih(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=$a[0]){if($a.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${$a.join(", ")}`);try{return await be(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ve(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await be(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Fr})}catch(n){if(ve(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=ax(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:nx,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(ve(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await be(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Fr})}catch(t){if(ve(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},h=await be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:sx});if(h.error)throw h.error;const f=await h.json(),u=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,g=(l=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return g.length>0&&(g.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(p.split(";")[1].split("=")[1]);c[`${x}Page`]=m}),c.total=parseInt(u)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(ve(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){wn(e);try{return await be(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Fr})}catch(t){if(ve(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){wn(e);try{return await be(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Fr})}catch(n){if(ve(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){wn(e);try{return await be(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Fr})}catch(n){if(ve(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){wn(e.userId);try{const{data:t,error:n}=await be(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:n}}catch(t){if(ve(t))return{data:null,error:t};throw t}}async _deleteFactor(e){wn(e.userId),wn(e.id);try{return{data:await be(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ve(t))return{data:null,error:t};throw t}}}const lx={getItem:r=>ps()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{ps()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{ps()&&globalThis.localStorage.removeItem(r)}};function Kl(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function cx(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const kn={debug:!!(globalThis&&ps()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Rh extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class hx extends Rh{}async function dx(r,e,t){kn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),kn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){kn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,s.name);try{return await t()}finally{kn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,s.name)}}else{if(e===0)throw kn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new hx(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(kn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}cx();const fx={url:bm,storageKey:wm,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:km,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Yl(r,e,t){return await t()}class Ns{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ns.nextInstanceID,Ns.nextInstanceID+=1,this.instanceID>0&&Kt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},fx),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new ox({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Ih(s.fetch),this.lock=s.lock||Yl,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Kt()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=dx:this.lock=Yl,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:ps()?this.storage=lx:(this.memoryStorage={},this.storage=Kl(this.memoryStorage)):(this.memoryStorage={},this.storage=Kl(this.memoryStorage)),Kt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Nh}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Bm(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Kt()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Nm(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ve(t)?{error:t}:{error:new Fh("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const i=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:gr}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(ve(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,n,s;try{let i;if("email"in e){const{email:h,password:f,options:u}=e;let g=null,p=null;this.flowType==="pkce"&&([g,p]=await bn(this.storage,this.storageKey)),i=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:u==null?void 0:u.emailRedirectTo,body:{email:h,password:f,data:(t=u==null?void 0:u.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:g,code_challenge_method:p},xform:gr})}else if("phone"in e){const{phone:h,password:f,options:u}=e;i=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:f,data:(n=u==null?void 0:u.data)!==null&&n!==void 0?n:{},channel:(s=u==null?void 0:u.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:gr})}else throw new ti("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(ve(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Xl})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Xl})}else throw new ti("You must provide either an email or phone number and a password");const{data:n,error:s}=t;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new ei}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(t){if(ve(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,n,s,i,a,o,l,c,h,f,u,g;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:x,wallet:v,statement:b,options:_}=e;let k;if(Kt())if(typeof v=="object")k=v;else{const P=window;if("solana"in P&&typeof P.solana=="object"&&("signIn"in P.solana&&typeof P.solana.signIn=="function"||"signMessage"in P.solana&&typeof P.solana.signMessage=="function"))k=P.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=v}const O=new URL((t=_==null?void 0:_.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in k&&k.signIn){const P=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),b?{statement:b}:null));let C;if(Array.isArray(P)&&P[0]&&typeof P[0]=="object")C=P[0];else if(P&&typeof P=="object"&&"signedMessage"in P&&"signature"in P)C=P;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)p=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),m=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${O.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(s=(n=_==null?void 0:_.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=_==null?void 0:_.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((f=(h=_==null?void 0:_.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||f===void 0)&&f.length?["Resources",..._.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const P=await k.signMessage(new TextEncoder().encode(p),"utf8");if(!P||!(P instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=P}}try{const{data:x,error:v}=await be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:jm(m)},!((u=e.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:gr});if(v)throw v;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new ei}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:v})}catch(x){if(ve(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(e){const t=await ni(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(t??"").split("/");try{const{data:i,error:a}=await be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:gr});if(await si(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ei}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(ve(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:i,nonce:a}=e,o=await be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:gr}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ei}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(ve(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,s,i,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,h=null;this.flowType==="pkce"&&([c,h]=await bn(this.storage,this.storageKey));const{error:f}=await be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:h},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:h}=await be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:h}}throw new ti("You must provide either an email or phone number.")}catch(o){if(ve(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,n;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:gr});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(ve(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,n,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await bn(this.storage,this.storageKey)),await be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:rx})}catch(i){if(ve(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Nr;const{error:s}=await be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(ve(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:a}=await be(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:a,error:o}=await be(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new ti("You must provide either an email or phone number and a type")}catch(t){if(ve(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ni(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<La:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,h)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,h))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Fr}):await this._useSession(async t=>{var n,s,i;const{data:a,error:o}=t;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Nr}:await be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Fr})})}catch(t){if(ve(t))return Cm(t)&&(await this._removeSession(),await si(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Nr;const a=s.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await bn(this.storage,this.storageKey));const{data:c,error:h}=await be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Fr});if(h)throw h;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(ve(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Nr;const t=Date.now()/1e3;let n=t,s=!0,i=null;const{payload:a}=Ua(e.access_token);if(a.exp&&(n=a.exp,s=n<=t),s){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(ve(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Nr;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ve(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Kt())throw new ri("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ri(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new $l("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ri("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new $l("No code detected.");const{data:b,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!i||!o||!a||!c)throw new ri("No session defined in URL");const h=Math.round(Date.now()/1e3),f=parseInt(o);let u=h+f;l&&(u=parseInt(l));const g=u-h;g*1e3<=On&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${f}s`);const p=u-f;h-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,u,h):h-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,u,h);const{data:m,error:x}=await this._getUser(i);if(x)throw x;const v={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:f,expires_at:u,refresh_token:a,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:e.type},error:null}}catch(n){if(ve(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ni(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return{error:i};const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(Am(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await si(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Lm(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:i},error:a}=t;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await bn(this.storage,this.storageKey,!0));try{return await be(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(ve(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ve(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:s}=await this._useSession(async i=>{var a,o,l,c,h;const{data:f,error:u}=i;if(u)throw u;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await be(this.fetch,"GET",g,{headers:this.headers,jwt:(h=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&h!==void 0?h:void 0})});if(s)throw s;return Kt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(ve(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:a}=t;if(a)throw a;return await be(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(ve(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await Wm(async s=>(s>0&&await $m(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:gr})),(s,i)=>{const a=200*Math.pow(2,s);return i&&Ba(i)&&Date.now()+a-n<On})}catch(n){if(this._debug(t,"error",n),ve(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Kt()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await ni(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const s=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<La;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${La}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Ba(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Nr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new xa;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new Nr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),ve(i)){const a={session:null,error:i};return Ba(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ph(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await si(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Kt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),On);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/On);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${On}ms, refresh threshold is ${xo} ticks`),s<=xo&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Rh)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Kt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,a]=await bn(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;return i?{data:null,error:i}:await be(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(ve(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await be(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(ve(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(ve(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;return i?{data:null,error:i}:await be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(ve(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(e==null?void 0:e.factors)||[],s=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Ua(s.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((n=(t=s.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const h=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(a=>a.kid===e);if(n||(n=this.jwks.keys.find(a=>a.kid===e),n&&this.jwks_cached_at+Tm>Date.now()))return n;const{data:s,error:i}=await be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new xs("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(a=>a.kid===e),!n)throw new xs("No matching signing key found in JWKS");return n}async getClaims(e,t={keys:[]}){try{let n=e;if(!n){const{data:g,error:p}=await this.getSession();if(p||!g.session)return{data:null,error:p};n=g.session.access_token}const{header:s,payload:i,signature:a,raw:{header:o,payload:l}}=Ua(n);if(Ym(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:g}=await this.getUser(n);if(g)throw g;return{data:{claims:i,header:s,signature:a},error:null}}const c=qm(s.alg),h=await this.fetchJwk(s.kid,t),f=await crypto.subtle.importKey("jwk",h,c,!0,["verify"]);if(!await crypto.subtle.verify(c,f,a,Rm(`${o}.${l}`)))throw new xs("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(n){if(ve(n))return{data:null,error:n};throw n}}}Ns.nextInstanceID=0;const ux=Ns;class gx extends ux{constructor(e){super(e)}}var mx=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(n.next(h))}catch(f){a(f)}}function l(h){try{c(n.throw(h))}catch(f){a(f)}}function c(h){h.done?i(h.value):s(h.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};class xx{constructor(e,t,n){var s,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=ym(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,h={db:dm,realtime:um,auth:Object.assign(Object.assign({},fm),{storageKey:c}),global:hm},f=_m(n??{},h);this.storageKey=(s=f.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(u,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=pm(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new Ig(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new cg(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new om(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return mx(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,storageKey:i,flowType:a,lock:o,debug:l},c,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new gx({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,flowType:a,lock:o,debug:l,fetch:h,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Kg(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const px=(r,e,t)=>new xx(r,e,t),vx="https://pxnhxfwbookofnumbedz.supabase.co",yx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB4bmh4Zndib29rb2ZudW1iZWR6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI5NjI4MDIsImV4cCI6MjA2ODUzODgwMn0.doJ5lv5m09L2DSIbhmaEoMUm6oMuQoklmSxdNCLjIlQ",Le=px(vx,yx),dr=eh((r,e)=>({user:null,userProfile:null,isAdmin:!1,loading:!0,signIn:async(t,n)=>{const{data:s,error:i}=await Le.auth.signInWithPassword({email:t,password:n});if(i)throw i;r({user:s.user}),s.user&&await e().loadUserProfile()},signUp:async(t,n,s)=>{const{data:i,error:a}=await Le.auth.signUp({email:t,password:n,options:{data:{full_name:s}}});if(a)throw a;i.user&&(r({user:i.user}),setTimeout(async()=>{await e().loadUserProfile()},1e3))},signOut:async()=>{const{error:t}=await Le.auth.signOut();if(t)throw t;r({user:null,userProfile:null,isAdmin:!1})},loadUserProfile:async()=>{const{user:t}=e();if(!t){r({userProfile:null,isAdmin:!1});return}try{const{data:n,error:s}=await Le.from("user_profiles").select("*").eq("id",t.id).single();if(s){console.error("Error loading user profile:",s),r({userProfile:null,isAdmin:!1});return}const i=(n==null?void 0:n.role)==="admin";r({userProfile:n,isAdmin:i})}catch(n){console.error("Error loading user profile:",n),r({userProfile:null,isAdmin:!1})}},initialize:async()=>{try{const{data:{user:t}}=await Le.auth.getUser();r({user:t,loading:!1}),t&&await e().loadUserProfile(),Le.auth.onAuthStateChange(async(n,s)=>{const i=(s==null?void 0:s.user)??null;r({user:i}),i?await e().loadUserProfile():r({userProfile:null,isAdmin:!1})})}catch(t){console.error("Auth initialization error:",t),r({loading:!1})}}})),_x=(r,e)=>e.some(t=>r instanceof t);let ql,Jl;function bx(){return ql||(ql=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function wx(){return Jl||(Jl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jh=new WeakMap,yo=new WeakMap,Mh=new WeakMap,Wa=new WeakMap,Uo=new WeakMap;function kx(r){const e=new Promise((t,n)=>{const s=()=>{r.removeEventListener("success",i),r.removeEventListener("error",a)},i=()=>{t(jr(r.result)),s()},a=()=>{n(r.error),s()};r.addEventListener("success",i),r.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&jh.set(t,r)}).catch(()=>{}),Uo.set(e,r),e}function Sx(r){if(yo.has(r))return;const e=new Promise((t,n)=>{const s=()=>{r.removeEventListener("complete",i),r.removeEventListener("error",a),r.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{n(r.error||new DOMException("AbortError","AbortError")),s()};r.addEventListener("complete",i),r.addEventListener("error",a),r.addEventListener("abort",a)});yo.set(r,e)}let _o={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return yo.get(r);if(e==="objectStoreNames")return r.objectStoreNames||Mh.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return jr(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function Tx(r){_o=r(_o)}function Ex(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(Ha(this),e,...t);return Mh.set(n,e.sort?e.sort():[e]),jr(n)}:wx().includes(r)?function(...e){return r.apply(Ha(this),e),jr(jh.get(this))}:function(...e){return jr(r.apply(Ha(this),e))}}function Ax(r){return typeof r=="function"?Ex(r):(r instanceof IDBTransaction&&Sx(r),_x(r,bx())?new Proxy(r,_o):r)}function jr(r){if(r instanceof IDBRequest)return kx(r);if(Wa.has(r))return Wa.get(r);const e=Ax(r);return e!==r&&(Wa.set(r,e),Uo.set(e,r)),e}const Ha=r=>Uo.get(r);function Cx(r,e,{blocked:t,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(r,e),o=jr(a);return n&&a.addEventListener("upgradeneeded",l=>{n(jr(a.result),l.oldVersion,l.newVersion,jr(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const Nx=["get","getKey","getAll","getAllKeys","count"],Ox=["put","add","delete","clear"],za=new Map;function Zl(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(za.get(e))return za.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=Ox.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||Nx.includes(t)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),s&&l.done]))[0]};return za.set(e,i),i}Tx(r=>({...r,get:(e,t,n)=>Zl(e,t)||r.get(e,t,n),has:(e,t)=>!!Zl(e,t)||r.has(e,t)}));let ii;async function Ye(){return ii||(ii=await Cx("FinanceTracker",1,{upgrade(r){r.createObjectStore("accounts",{keyPath:"id"}).createIndex("by-user","user_id");const t=r.createObjectStore("transactions",{keyPath:"id"});t.createIndex("by-account","account_id"),t.createIndex("by-sync","is_synced"),r.createObjectStore("categories",{keyPath:"id"}).createIndex("by-user","user_id"),r.createObjectStore("sync_queue",{keyPath:"id"})}}),ii)}async function Fx(r){const e=await Ye();await e.put("accounts",{...r,is_synced:!1}),await e.put("sync_queue",{id:`account_${r.id}_${Date.now()}`,table:"accounts",action:"create",data:r,timestamp:Date.now()})}async function Ql(r){return(await Ye()).getAllFromIndex("accounts","by-user",r)}async function Ot(r){const e=await Ye();await e.put("accounts",{...r,is_synced:!1}),await e.put("sync_queue",{id:`account_${r.id}_${Date.now()}`,table:"accounts",action:"update",data:r,timestamp:Date.now()})}async function Dx(r){const e=await Ye();await e.put("transactions",{...r,is_synced:!1,sync_status:"pending"}),await e.put("sync_queue",{id:`transaction_${r.id}_${Date.now()}`,table:"transactions",action:"create",data:r,timestamp:Date.now()})}async function ec(r){return(await Ye()).getAll("transactions")}async function Ix(r){const e=await Ye();await e.put("transactions",{...r,is_synced:!1,sync_status:"pending"}),await e.put("sync_queue",{id:`transaction_${r.id}_${Date.now()}`,table:"transactions",action:"update",data:r,timestamp:Date.now()})}async function tc(r){const t=(await Ye()).transaction("categories","readwrite");for(const n of r)await t.store.put({...n,is_synced:!0});await t.done}async function rc(){return(await Ye()).getAll("categories")}async function Px(){return(await Ye()).getAll("sync_queue")}async function Xr(r){await(await Ye()).delete("sync_queue",r)}async function Sn(r,e){const t=await Ye();if(r==="accounts"){const n=await t.get("accounts",e);n&&await t.put("accounts",{...n,is_synced:!0})}else if(r==="transactions"){const n=await t.get("transactions",e);n&&await t.put("transactions",{...n,is_synced:!0,sync_status:"synced"})}else if(r==="categories"){const n=await t.get("categories",e);n&&await t.put("categories",{...n,is_synced:!0})}}class Rx{constructor(){this.isOnline=navigator.onLine,this.syncInProgress=!1,this.syncCallbacks=[],this.dbInitialized=!1,this.setupNetworkListeners(),this.startPeriodicSync()}setupNetworkListeners(){window.addEventListener("online",()=>{this.isOnline=!0,this.sync()}),window.addEventListener("offline",()=>{this.isOnline=!1})}startPeriodicSync(){setInterval(()=>{this.isOnline&&!this.syncInProgress&&this.sync()},3e4)}async sync(){if(!(!this.isOnline||this.syncInProgress)){this.syncInProgress=!0;try{const{data:{user:e},error:t}=await Le.auth.getUser();if(t||!e){console.log("No authenticated user, skipping sync");return}console.log("Starting sync for user:",e.id),await this.syncFromServer(e.id),await this.syncToServer(e.id),this.notifyCallbacks()}catch(e){console.error("Sync failed:",e)}finally{this.syncInProgress=!1}}}async syncFromServer(e){try{console.log("Syncing data from server for user:",e),await this.syncCategoriesFromServer(),await this.syncAccountsFromServer(e),await this.syncTransactionsFromServer(e),this.dbInitialized=!0,console.log("Server sync completed successfully")}catch(t){console.error("Failed to sync from server:",t),await this.createDefaultCategoriesOffline()}}async syncAccountsFromServer(e){try{console.log("Fetching accounts from server for user:",e);const{data:t,error:n}=await Le.from("accounts").select("*").eq("user_id",e);if(n){n.code==="42P01"?console.warn("Accounts table does not exist in database. Please apply migrations to your Supabase project."):console.error("Error syncing accounts from server:",n);return}if(t&&t.length>0){console.log("Found accounts on server:",t.length);const s=await Ye(),i=await s.getAllFromIndex("accounts","by-user",e),a=new Map(i.map(o=>[o.id,o]));for(const o of t){const l=a.get(o.id);if(!l)await s.put("accounts",{...o,is_synced:!0}),console.log("Added new account from server:",o.name);else{const c=new Date(o.updated_at).getTime(),h=new Date(l.updated_at).getTime();c>h&&l.is_synced?(await s.put("accounts",{...o,is_synced:!0}),console.log("Updated account from server (newer):",o.name)):l.is_synced||console.log("Keeping local account (has unsynced changes):",l.name)}}}else console.log("No accounts found on server for user:",e)}catch(t){console.error("Failed to sync accounts from server:",t)}}async syncTransactionsFromServer(e){try{console.log("Fetching transactions from server for user:",e);const{data:t,error:n}=await Le.from("transactions").select(`
          *,
          accounts!transactions_account_id_fkey!inner(user_id)
        `).eq("accounts.user_id",e);if(n){n.code==="42P01"?console.warn("Transactions table does not exist in database. Please apply migrations to your Supabase project."):console.error("Error syncing transactions from server:",n);return}if(t&&t.length>0){console.log("Found transactions on server:",t.length);const s=await Ye(),i=await s.getAll("transactions"),a=new Map(i.map(o=>[o.id,o]));for(const o of t){const{accounts:l,...c}=o,h=a.get(c.id);if(!h)await s.put("transactions",{...c,is_synced:!0,sync_status:"synced"}),console.log("Added new transaction from server:",c.description||"Untitled");else{const f=new Date(c.updated_at).getTime(),u=new Date(h.updated_at).getTime();f>u&&h.is_synced?(await s.put("transactions",{...c,is_synced:!0,sync_status:"synced"}),console.log("Updated transaction from server (newer):",c.description||"Untitled")):(!h.is_synced||h.sync_status==="pending")&&console.log("Keeping local transaction (has unsynced changes):",h.description||"Untitled")}}}else console.log("No transactions found on server for user:",e)}catch(t){console.error("Failed to sync transactions from server:",t)}}async syncToServer(e){const{data:{user:t},error:n}=await Le.auth.getUser();if(n){console.error("Failed to get current user for sync:",n);return}if(!t){console.log("No authenticated user found, skipping server sync");return}let s=!1;try{const{data:o}=await Le.from("user_profiles").select("role").eq("id",t.id).single();s=(o==null?void 0:o.role)==="admin"}catch(o){console.error("Error checking admin status:",o)}console.log("Syncing to server for user:",t.id);const i=await Px();console.log("Syncing to server, queue items:",i.length);const a=await Ye();for(const o of i)try{let l=!1;if(o.table==="accounts")o.data.user_id===t.id?l=!0:console.warn(`Skipping account sync - user_id mismatch. Expected: ${t.id}, Got: ${o.data.user_id}`);else if(o.table==="transactions")try{const c=await a.get("accounts",o.data.account_id);c&&c.user_id===t.id?l=!0:console.warn(`Skipping transaction sync - account not found or user_id mismatch. Account ID: ${o.data.account_id}, Expected user: ${t.id}`)}catch(c){console.error("Error checking account ownership for transaction:",c)}else o.table==="categories"&&(o.data.user_id===t.id||s&&o.data.user_id===null?l=!0:console.warn(`Skipping category sync - user_id mismatch or insufficient permissions. Expected: ${t.id}, Got: ${o.data.user_id}, IsAdmin: ${s}`));if(!l){await Xr(o.id);continue}if(o.table==="accounts"){const{is_synced:c,...h}=o.data;if(o.action==="create"){console.log("Creating account:",h.name,"for user:",t.id);const{error:f}=await Le.from("accounts").insert(h);f?f.code==="42501"?console.error("RLS Policy Violation for account creation:",{error:f,accountData:h,currentUserId:t.id,accountUserId:h.user_id}):f.code==="42P01"?console.error("Database table does not exist. Please apply migrations to your Supabase project."):console.error("Supabase error creating account:",f):(console.log("Account created successfully, marking as synced"),await Sn("accounts",o.data.id),await Xr(o.id))}else if(o.action==="update"){console.log("Updating account:",h.name,"for user:",t.id);const{error:f}=await Le.from("accounts").update(h).eq("id",h.id);f?f.code==="42501"?console.error("RLS Policy Violation for account update:",{error:f,accountData:h,currentUserId:t.id,accountUserId:h.user_id}):f.code==="42P01"?console.error("Database table does not exist. Please apply migrations to your Supabase project."):console.error("Supabase error updating account:",f):(console.log("Account updated successfully, marking as synced"),await Sn("accounts",o.data.id),await Xr(o.id))}}else if(o.table==="transactions"){const{is_synced:c,...h}=o.data;if(o.action==="create"){console.log("Creating transaction:",h.description,"for account:",h.account_id);const f={...h,sync_status:"synced"},{error:u}=await Le.from("transactions").insert(f);if(u)if(u.code==="42501"){const g=await a.get("accounts",h.account_id);console.error("RLS Policy Violation for transaction creation:",{error:u,transactionData:h,currentUserId:t.id,accountId:h.account_id,accountUserId:g==null?void 0:g.user_id,accountExists:!!g})}else u.code==="42P01"?console.error("Database table does not exist. Please apply migrations to your Supabase project."):console.error("Supabase error creating transaction:",u);else console.log("Transaction created successfully, marking as synced"),await Sn("transactions",o.data.id),await Xr(o.id)}else if(o.action==="update"){console.log("Updating transaction:",h.description,"for account:",h.account_id);const f={...h,sync_status:"synced"},{error:u}=await Le.from("transactions").update(f).eq("id",h.id);if(u)if(u.code==="42501"){const g=await a.get("accounts",h.account_id);console.error("RLS Policy Violation for transaction update:",{error:u,transactionData:h,currentUserId:t.id,accountId:h.account_id,accountUserId:g==null?void 0:g.user_id,accountExists:!!g})}else u.code==="42P01"?console.error("Database table does not exist. Please apply migrations to your Supabase project."):console.error("Supabase error updating transaction:",u);else console.log("Transaction updated successfully, marking as synced"),await Sn("transactions",o.data.id),await Xr(o.id)}}else if(o.table==="categories"){const{is_synced:c,...h}=o.data;if(o.action==="create"){console.log("Creating category:",h.name,"for user:",t.id);const{error:f}=await Le.from("categories").insert(h);f?f.code==="42501"?console.error("RLS Policy Violation for category creation:",{error:f,categoryData:h,currentUserId:t.id,categoryUserId:h.user_id}):f.code==="42P01"?console.error("Database table does not exist. Please apply migrations to your Supabase project."):console.error("Supabase error creating category:",f):(console.log("Category created successfully, marking as synced"),await Sn("categories",o.data.id),await Xr(o.id))}else if(o.action==="update"){console.log("Updating category:",h.name,"for user:",t.id);const{error:f}=await Le.from("categories").update(h).eq("id",h.id);f?f.code==="42501"?console.error("RLS Policy Violation for category update:",{error:f,categoryData:h,currentUserId:t.id,categoryUserId:h.user_id}):f.code==="42P01"?console.error("Database table does not exist. Please apply migrations to your Supabase project."):console.error("Supabase error updating category:",f):(console.log("Category updated successfully, marking as synced"),await Sn("categories",o.data.id),await Xr(o.id))}}}catch(l){console.error(`Failed to sync ${o.table} ${o.action}:`,l)}}async syncCategoriesFromServer(){try{const{data:e,error:t}=await Le.from("categories").select("*");t?t.code==="42P01"?(console.warn("Categories table does not exist in database. Please apply migrations to your Supabase project."),await this.createDefaultCategoriesOffline()):console.error("Error syncing categories from server:",t):e&&(console.log("Synced categories from server:",e.length),await tc(e.map(n=>({...n,is_synced:!0}))))}catch(e){console.error("Failed to sync categories from server:",e),await this.createDefaultCategoriesOffline()}}async createDefaultCategoriesOffline(){try{const e=[{id:"default-salary",user_id:null,name:"Salary",type:"income",color:"#10b981",created_at:new Date().toISOString(),is_synced:!1},{id:"default-freelance",user_id:null,name:"Freelance",type:"income",color:"#059669",created_at:new Date().toISOString(),is_synced:!1},{id:"default-investment",user_id:null,name:"Investment",type:"income",color:"#047857",created_at:new Date().toISOString(),is_synced:!1},{id:"default-business",user_id:null,name:"Business",type:"income",color:"#065f46",created_at:new Date().toISOString(),is_synced:!1},{id:"default-other-income",user_id:null,name:"Other Income",type:"income",color:"#064e3b",created_at:new Date().toISOString(),is_synced:!1},{id:"default-food",user_id:null,name:"Food & Dining",type:"expense",color:"#ef4444",created_at:new Date().toISOString(),is_synced:!1},{id:"default-transport",user_id:null,name:"Transportation",type:"expense",color:"#dc2626",created_at:new Date().toISOString(),is_synced:!1},{id:"default-shopping",user_id:null,name:"Shopping",type:"expense",color:"#b91c1c",created_at:new Date().toISOString(),is_synced:!1},{id:"default-bills",user_id:null,name:"Bills & Utilities",type:"expense",color:"#991b1b",created_at:new Date().toISOString(),is_synced:!1},{id:"default-entertainment",user_id:null,name:"Entertainment",type:"expense",color:"#7c2d12",created_at:new Date().toISOString(),is_synced:!1},{id:"default-healthcare",user_id:null,name:"Healthcare",type:"expense",color:"#92400e",created_at:new Date().toISOString(),is_synced:!1},{id:"default-travel",user_id:null,name:"Travel",type:"expense",color:"#a16207",created_at:new Date().toISOString(),is_synced:!1},{id:"default-education",user_id:null,name:"Education",type:"expense",color:"#a3a3a3",created_at:new Date().toISOString(),is_synced:!1},{id:"default-personal",user_id:null,name:"Personal Care",type:"expense",color:"#737373",created_at:new Date().toISOString(),is_synced:!1},{id:"default-other-expense",user_id:null,name:"Other Expense",type:"expense",color:"#525252",created_at:new Date().toISOString(),is_synced:!1}];await tc(e),console.log("Created default categories offline")}catch(e){console.error("Failed to create default categories offline:",e)}}onSync(e){this.syncCallbacks.push(e)}notifyCallbacks(){this.syncCallbacks.forEach(e=>e())}getStatus(){return{isOnline:this.isOnline,syncInProgress:this.syncInProgress,dbInitialized:this.dbInitialized}}}const or=new Rx,jx=()=>{try{const r=localStorage.getItem("fintrack-exchange-rate");return r?parseFloat(r):null}catch{return null}},Ht=eh((r,e)=>({accounts:[],transactions:[],categories:[],isOnline:navigator.onLine,syncInProgress:!1,exchangeRate:jx(),loadData:async t=>{try{console.log("Loading data for user:",t);const[n,s,i]=await Promise.all([Ql(t),ec(),rc()]);console.log("Loaded from offline storage:",{accounts:n.length,transactions:s.length,categories:i.length}),r({accounts:n,transactions:s,categories:i}),navigator.onLine?(console.log("Online - initiating sync to get latest data..."),await or.sync(),console.log("Sync completed, reloading data from local storage..."),await e().reloadDataFromLocal(t)):console.log("Offline - using local data only")}catch(n){console.error("Error loading data:",n)}},reloadDataFromLocal:async t=>{try{console.log("Reloading data from local storage for user:",t);const[n,s,i]=await Promise.all([Ql(t),ec(),rc()]);console.log("Reloaded from offline storage:",{accounts:n.length,transactions:s.length,categories:i.length}),r({accounts:n,transactions:s,categories:i})}catch(n){console.error("Error reloading data from local storage:",n)}},createAccount:async t=>{const n={...t,id:crypto.randomUUID(),created_at:new Date().toISOString(),updated_at:new Date().toISOString(),is_synced:!1};await Fx(n),r(s=>({accounts:[...s.accounts,n]})),navigator.onLine&&or.sync()},updateAccount:async t=>{const n={...t,updated_at:new Date().toISOString(),is_synced:!1};await Ot(n),r(s=>({accounts:s.accounts.map(i=>i.id===t.id?n:i)})),navigator.onLine&&or.sync()},deleteAccount:async t=>{try{const n=await Ye(),s=e();if(!s.accounts.find(l=>l.id===t))throw new Error("Account not found");const a=s.transactions.filter(l=>l.account_id===t),o=n.transaction(["accounts","transactions"],"readwrite");await o.objectStore("accounts").delete(t);for(const l of a)await o.objectStore("transactions").delete(l.id);if(await o.done,navigator.onLine){const{error:l}=await Le.from("accounts").delete().eq("id",t);l&&console.error("Error deleting account from Supabase:",l)}r(l=>({accounts:l.accounts.filter(c=>c.id!==t),transactions:l.transactions.filter(c=>c.account_id!==t)}))}catch(n){throw console.error("Error deleting account:",n),n}},createTransaction:async t=>{const n={...t,id:crypto.randomUUID(),created_at:new Date().toISOString(),updated_at:new Date().toISOString(),is_synced:!1,sync_status:"pending"},s=e();if(n.type==="transfer"){const i=s.accounts.find(c=>c.id===n.account_id),a=s.accounts.find(c=>c.id===n.target_account_id);if(!i||!a)throw new Error("Source or target account not found for transfer");const o={...i,current_balance:i.current_balance-n.amount,updated_at:new Date().toISOString(),is_synced:!1},l={...a,current_balance:a.current_balance+n.amount,updated_at:new Date().toISOString(),is_synced:!1};await Ot(o),await Ot(l),r(c=>({accounts:c.accounts.map(h=>h.id===i.id?o:h.id===a.id?l:h)}))}else{const i=s.accounts.find(a=>a.id===n.account_id);if(i){const a=n.type==="expense"?-n.amount:n.amount,o={...i,current_balance:i.current_balance+a,updated_at:new Date().toISOString(),is_synced:!1};await Ot(o),r(l=>({accounts:l.accounts.map(c=>c.id===i.id?o:c)}))}}await Dx(n),r(i=>({transactions:[...i.transactions,n]})),navigator.onLine&&or.sync()},updateTransaction:async t=>{const n=e(),s=n.transactions.find(a=>a.id===t.id);if(s){if(s.type==="transfer"){const a=n.accounts.find(l=>l.id===s.account_id),o=n.accounts.find(l=>l.id===s.target_account_id);if(a){const l={...a,current_balance:a.current_balance+s.amount,updated_at:new Date().toISOString(),is_synced:!1};await Ot(l),r(c=>({accounts:c.accounts.map(h=>h.id===a.id?l:h)}))}if(o){const l={...o,current_balance:o.current_balance-s.amount,updated_at:new Date().toISOString(),is_synced:!1};await Ot(l),r(c=>({accounts:c.accounts.map(h=>h.id===o.id?l:h)}))}}else{const a=n.accounts.find(o=>o.id===s.account_id);if(a){const o=s.type==="expense"?s.amount:-s.amount,l={...a,current_balance:a.current_balance+o,updated_at:new Date().toISOString(),is_synced:!1};await Ot(l),r(c=>({accounts:c.accounts.map(h=>h.id===a.id?l:h)}))}}if(t.type==="transfer"){const a=e().accounts.find(l=>l.id===t.account_id),o=e().accounts.find(l=>l.id===t.target_account_id);if(a){const l={...a,current_balance:a.current_balance-t.amount,updated_at:new Date().toISOString(),is_synced:!1};await Ot(l),r(c=>({accounts:c.accounts.map(h=>h.id===a.id?l:h)}))}if(o){const l={...o,current_balance:o.current_balance+t.amount,updated_at:new Date().toISOString(),is_synced:!1};await Ot(l),r(c=>({accounts:c.accounts.map(h=>h.id===o.id?l:h)}))}}else{const a=e().accounts.find(o=>o.id===t.account_id);if(a){const o=t.type==="expense"?-t.amount:t.amount,l={...a,current_balance:a.current_balance+o,updated_at:new Date().toISOString(),is_synced:!1};await Ot(l),r(c=>({accounts:c.accounts.map(h=>h.id===a.id?l:h)}))}}}const i={...t,updated_at:new Date().toISOString(),is_synced:!1,sync_status:"pending"};await Ix(i),r(a=>({transactions:a.transactions.map(o=>o.id===t.id?i:o)})),navigator.onLine&&or.sync()},deleteTransaction:async t=>{try{const n=await Ye(),s=e(),i=s.transactions.find(a=>a.id===t);if(!i)throw new Error("Transaction not found");if(i.type==="transfer"){const a=s.accounts.find(l=>l.id===i.account_id),o=s.accounts.find(l=>l.id===i.target_account_id);if(a){const l={...a,current_balance:a.current_balance+i.amount,updated_at:new Date().toISOString(),is_synced:!1};await Ot(l),r(c=>({accounts:c.accounts.map(h=>h.id===a.id?l:h)}))}if(o){const l={...o,current_balance:o.current_balance-i.amount,updated_at:new Date().toISOString(),is_synced:!1};await Ot(l),r(c=>({accounts:c.accounts.map(h=>h.id===o.id?l:h)}))}}else{const a=s.accounts.find(o=>o.id===i.account_id);if(a){const o=i.type==="expense"?i.amount:-i.amount,l={...a,current_balance:a.current_balance+o,updated_at:new Date().toISOString(),is_synced:!1};await Ot(l),r(c=>({accounts:c.accounts.map(h=>h.id===a.id?l:h)}))}}if(await n.delete("transactions",t),navigator.onLine){const{error:a}=await Le.from("transactions").delete().eq("id",t);a&&console.error("Error deleting transaction from Supabase:",a)}r(a=>({transactions:a.transactions.filter(o=>o.id!==t)}))}catch(n){throw console.error("Error deleting transaction:",n),n}},createCategory:async t=>{const n={...t,id:crypto.randomUUID(),created_at:new Date().toISOString(),is_synced:!1};try{const s=await Ye();await s.put("categories",n),await s.put("sync_queue",{id:`category_${n.id}_${Date.now()}`,table:"categories",action:"create",data:n,timestamp:Date.now()}),r(i=>({categories:[...i.categories,n]})),navigator.onLine&&or.sync()}catch(s){throw console.error("Error creating category:",s),s}},updateCategory:async t=>{try{const n={...t,is_synced:!1},s=await Ye();await s.put("categories",n),await s.put("sync_queue",{id:`category_${t.id}_${Date.now()}`,table:"categories",action:"update",data:n,timestamp:Date.now()}),r(i=>({categories:i.categories.map(a=>a.id===t.id?n:a)})),navigator.onLine&&or.sync()}catch(n){throw console.error("Error updating category:",n),n}},deleteCategory:async t=>{try{if(await(await Ye()).delete("categories",t),navigator.onLine){const{error:s}=await Le.from("categories").delete().eq("id",t);s&&console.error("Error deleting category from Supabase:",s)}r(s=>({categories:s.categories.filter(i=>i.id!==t)}))}catch(n){throw console.error("Error deleting category:",n),n}},setExchangeRate:t=>{r({exchangeRate:t}),t!==null?localStorage.setItem("fintrack-exchange-rate",t.toString()):localStorage.removeItem("fintrack-exchange-rate")},updateSyncStatus:()=>{const t=or.getStatus();r({isOnline:t.isOnline,syncInProgress:t.syncInProgress})}}));or.onSync(async()=>{const r=Ht.getState();r.updateSyncStatus();try{const{data:{user:e}}=await Le.auth.getUser();e&&(console.log("Sync completed, reloading data for user:",e.id),await r.reloadDataFromLocal(e.id))}catch(e){console.error("Error reloading data after sync:",e)}});function Mx(){const[r,e]=J.useState([]),t=J.useCallback(s=>{const a={id:Math.random().toString(36).substr(2,9),...s,onClose:()=>{}};e(o=>[...o,a])},[]),n=J.useCallback(s=>{e(i=>i.filter(a=>a.id!==s))},[]);return{toasts:r,addToast:t,removeToast:n}}function Lh(){const[r,e]=J.useState(()=>{if(typeof window<"u"){const n=localStorage.getItem("theme");return n==="dark"||!n&&window.matchMedia("(prefers-color-scheme: dark)").matches}return!1});return J.useEffect(()=>{const n=window.document.documentElement;r?n.classList.add("dark"):n.classList.remove("dark"),localStorage.setItem("theme",r?"dark":"light")},[r]),{isDark:r,toggleTheme:()=>e(!r)}}function Lx(r){const[e,t]=J.useState({isInstallable:!1,isInstalled:!1,isStandalone:!1,showInstallPrompt:!1,isIOS:!1,isAndroid:!1,timeSpent:0,pagesVisited:0,engagementMet:!1}),[n,s]=J.useState(null),[i,a]=J.useState(null),o=J.useRef(new Set),l=J.useRef(Date.now()),c=J.useRef(null);J.useEffect(()=>{const g=()=>{const p=Date.now(),m=Math.floor((p-l.current)/1e3);t(x=>({...x,timeSpent:m}))};return c.current=setInterval(g,1e3),()=>{c.current&&clearInterval(c.current)}},[]),J.useEffect(()=>{if(r){o.current.add(r);const g=o.current.size;t(p=>({...p,pagesVisited:g}))}},[r]),J.useEffect(()=>{const{timeSpent:g,pagesVisited:p}=e,m=g>=30&&p>=2;t(x=>({...x,engagementMet:m}))},[e.timeSpent,e.pagesVisited]),J.useEffect(()=>{const g=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),p=/iPad|iPhone|iPod/.test(navigator.userAgent),m=/Android/.test(navigator.userAgent),x=g||localStorage.getItem("pwa-installed")==="true",v=window.location.hostname.includes("stackblitz")||window.location.hostname.includes("webcontainer")||window.location.hostname==="localhost";t(k=>({...k,isStandalone:g,isInstalled:x,isIOS:p,isAndroid:m}));const b=k=>{k.preventDefault(),s(k),t(P=>({...P,isInstallable:!0}))},_=()=>{console.log("PWA was installed"),localStorage.setItem("pwa-installed","true"),t(k=>({...k,isInstalled:!0,showInstallPrompt:!1,isInstallable:!1})),s(null),o.current.clear(),l.current=Date.now()};return window.addEventListener("beforeinstallprompt",b),window.addEventListener("appinstalled",_),"serviceWorker"in navigator&&!v?navigator.serviceWorker.register("/sw.js").then(k=>{console.log("Service Worker registered:",k),k.addEventListener("updatefound",()=>{const O=k.installing;O&&O.addEventListener("statechange",()=>{O.state==="installed"&&navigator.serviceWorker.controller&&(console.log("New content available"),a(O))})})}).catch(k=>{console.error("Service Worker registration failed:",k)}):v&&console.log("Service Worker registration skipped: Running in StackBlitz environment"),()=>{window.removeEventListener("beforeinstallprompt",b),window.removeEventListener("appinstalled",_)}},[]),J.useEffect(()=>{const{isInstallable:g,isInstalled:p,engagementMet:m}=e,x=g&&!p&&m&&u();t(v=>({...v,showInstallPrompt:x}))},[e.isInstallable,e.isInstalled,e.engagementMet]);const h=async()=>{if(!n)return!1;try{await n.prompt();const{outcome:g}=await n.userChoice;return g==="accepted"?(console.log("User accepted the install prompt"),localStorage.setItem("pwa-installed","true"),t(p=>({...p,isInstalled:!0,showInstallPrompt:!1,isInstallable:!1})),o.current.clear(),l.current=Date.now()):(console.log("User dismissed the install prompt"),t(p=>({...p,showInstallPrompt:!1})),localStorage.setItem("pwa-prompt-dismissed",Date.now().toString()),o.current.clear(),l.current=Date.now(),t(p=>({...p,timeSpent:0,pagesVisited:0,engagementMet:!1}))),s(null),g==="accepted"}catch(g){return console.error("Error during app installation:",g),!1}},f=()=>{t(g=>({...g,showInstallPrompt:!1})),localStorage.setItem("pwa-prompt-dismissed",Date.now().toString()),o.current.clear(),l.current=Date.now(),t(g=>({...g,timeSpent:0,pagesVisited:0,engagementMet:!1}))},u=()=>{const g=localStorage.getItem("pwa-prompt-dismissed");if(g){const p=parseInt(g),m=24*60*60*1e3;return Date.now()-p>m}return!0};return{...e,installApp:h,dismissInstallPrompt:f,shouldShowPrompt:u(),canInstall:!!n,newWorker:i}}function Bx(){const[r,e]=J.useState(!1),[t,n]=J.useState(""),[s,i]=J.useState(""),[a,o]=J.useState(""),[l,c]=J.useState(!1),[h,f]=J.useState(!1),[u,g]=J.useState(""),{signIn:p,signUp:m}=dr(),x=async v=>{v.preventDefault(),f(!0),g("");try{r?await m(t,s,a):await p(t,s)}catch(b){g(b.message||"An error occurred")}finally{f(!1)}};return d.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-blue-900 dark:to-indigo-900 flex items-center justify-center p-3 sm:p-4 transition-colors duration-200",children:d.jsxs("div",{className:"max-w-md w-full",children:[d.jsxs("div",{className:"text-center mb-6 sm:mb-8",children:[d.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-gray-900 dark:text-white",children:"ChurchTrack"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1 sm:mt-2 text-xs sm:text-sm md:text-base",children:"Church financial management system"})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-4 sm:p-6 md:p-8 transition-colors duration-200",children:[d.jsxs("div",{className:"text-center mb-4 sm:mb-6",children:[d.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-900 dark:text-white",children:r?"Create Account":"Welcome Back"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1 text-xs sm:text-sm md:text-base",children:r?"Start tracking your finances today":"Sign in to your account"})]}),u&&d.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 text-red-700 dark:text-red-400 px-3 sm:px-4 py-2 sm:py-3 rounded-lg mb-3 sm:mb-4 text-xs sm:text-sm",children:u}),d.jsxs("form",{onSubmit:x,className:"space-y-3 sm:space-y-4",children:[r&&d.jsxs("div",{children:[d.jsx("label",{htmlFor:"fullName",className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Full Name"}),d.jsx("input",{id:"fullName",type:"text",value:a,onChange:v=>o(v.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-sm sm:text-base placeholder-gray-400 dark:placeholder-gray-500",placeholder:"Enter your full name",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"email",className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email Address"}),d.jsx("input",{id:"email",type:"email",value:t,onChange:v=>n(v.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-sm sm:text-base placeholder-gray-400 dark:placeholder-gray-500",placeholder:"Enter your email",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{id:"password",type:l?"text":"password",value:s,onChange:v=>i(v.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 pr-10 sm:pr-12 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-sm sm:text-base placeholder-gray-400 dark:placeholder-gray-500",placeholder:"Enter your password",required:!0,minLength:6}),d.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute right-2 sm:right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 transition-colors",children:l?d.jsx(Tu,{className:"w-4 h-4 sm:w-5 sm:h-5"}):d.jsx(th,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]}),d.jsx("button",{type:"submit",disabled:h,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 dark:from-blue-500 dark:to-indigo-500 dark:hover:from-blue-600 dark:hover:to-indigo-600 text-white px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-gray-900 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm sm:text-base shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95",children:h?d.jsx("div",{className:"w-4 h-4 sm:w-5 sm:h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):d.jsxs(d.Fragment,{children:[r?d.jsx(Eu,{className:"w-4 h-4 sm:w-5 sm:h-5"}):d.jsx(Au,{className:"w-4 h-4 sm:w-5 sm:h-5"}),r?"Create Account":"Sign In"]})})]}),d.jsx("div",{className:"text-center mt-4 sm:mt-6",children:d.jsx("button",{onClick:()=>e(!r),className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium transition-colors text-xs sm:text-sm md:text-base",children:r?"Already have an account? Sign in":"Don't have an account? Sign up"})}),d.jsx("div",{className:"text-center mt-4 sm:mt-6 pt-3 sm:pt-4 border-t border-gray-200 dark:border-gray-700",children:d.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ChurchTrack ver. 1.2.0 by"," ",d.jsx("a",{href:"https://elxis.com.ng",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors",children:"eLxis"})]})})]})]})})}function Ux({activeTab:r,onTabChange:e,isAdmin:t}){const{signOut:n}=dr(),s=[{id:"dashboard",name:"Dashboard",icon:rh},{id:"accounts",name:"Accounts",icon:an,adminOnly:!0},{id:"transactions",name:"Transactions",icon:Ni},{id:"settings",name:"Settings",icon:Cu}].filter(i=>!i.adminOnly||t);return d.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 transition-colors duration-200",children:[d.jsxs("div",{className:"flex items-center gap-3 p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-blue-700 dark:from-blue-500 dark:to-blue-600 rounded-lg flex items-center justify-center shadow-sm",children:d.jsx(Nu,{className:"w-5 h-5 text-white"})}),d.jsx("span",{className:"font-bold text-lg sm:text-xl text-gray-900 dark:text-white",children:"ChurchTrack"})]}),d.jsx("nav",{className:"flex-1 p-3 sm:p-4",children:d.jsx("ul",{className:"space-y-1 sm:space-y-2",children:s.map(i=>{const a=i.icon,o=r===i.id;return d.jsx("li",{children:d.jsxs("button",{onClick:()=>e(i.id),className:`w-full flex items-center gap-3 px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-left transition-all duration-200 group ${o?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-700 shadow-sm":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white"}`,children:[d.jsx(a,{className:`w-5 h-5 flex-shrink-0 transition-transform duration-200 ${o?"scale-110":"group-hover:scale-105"}`}),d.jsx("span",{className:"font-medium text-sm sm:text-base",children:i.name})]})},i.id)})})}),d.jsxs("div",{className:"px-3 sm:px-4 py-2 border-t border-gray-200 dark:border-gray-700",children:[d.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:["CoCK ver. 1.2.0 by"," ",d.jsx("a",{href:"https://elxis.com.ng",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors",children:"eLxis"})]}),t&&d.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 text-center mt-1 font-medium",children:"Administrator Access"})]}),d.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-200 dark:border-gray-700",children:d.jsxs("button",{onClick:n,className:"w-full flex items-center gap-3 px-3 sm:px-4 py-2.5 sm:py-3 text-gray-700 dark:text-gray-300 hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-700 dark:hover:text-red-400 rounded-lg transition-all duration-200 group",children:[d.jsx(nh,{className:"w-5 h-5 flex-shrink-0 group-hover:scale-105 transition-transform duration-200"}),d.jsx("span",{className:"font-medium text-sm sm:text-base",children:"Sign Out"})]})})]})}function $x({title:r,onMenuClick:e}){const{isOnline:t,syncInProgress:n}=Ht(),{isDark:s,toggleTheme:i}=Lh();return d.jsx("header",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 px-4 sm:px-6 py-3 sm:py-4 transition-colors duration-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[d.jsx("button",{onClick:e,className:"lg:hidden p-2 -ml-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:d.jsx(Ou,{className:"w-5 h-5"})}),d.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 dark:text-white truncate",children:r})]}),d.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[d.jsx("button",{onClick:i,className:"p-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-all duration-200 hover:scale-105 active:scale-95",title:s?"Switch to Light theme":"Switch to Dark theme",children:s?d.jsx(Fu,{className:"w-4 h-4 sm:w-5 sm:h-5"}):d.jsx(Du,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),d.jsxs("div",{className:`flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1.5 rounded-full text-xs sm:text-sm font-medium transition-colors ${t?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300"}`,children:[t?d.jsx(Iu,{className:"w-3 h-3 sm:w-4 sm:h-4"}):d.jsx(Pu,{className:"w-3 h-3 sm:w-4 sm:h-4"}),d.jsx("span",{className:"hidden sm:inline",children:t?"Online":"Offline"})]}),n&&d.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1.5 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 text-xs sm:text-sm font-medium",children:[d.jsx(Oi,{className:"w-3 h-3 sm:w-4 sm:h-4 animate-spin"}),d.jsx("span",{className:"hidden sm:inline",children:"Syncing..."})]})]})]})})}function Wx({activeTab:r,onTabChange:e,onAddTransaction:t,isAdmin:n}){const{signOut:s}=dr(),i=[{id:"dashboard",icon:rh,label:"Home"},...n?[{id:"accounts",icon:an,label:"Accounts"}]:[],...n?[{id:"add",icon:Bn,label:"Add",isSpecial:!0}]:[],{id:"transactions",icon:Ni,label:"History"},{id:"logout",icon:nh,label:"Logout",isLogout:!0}],a=o=>{o.isSpecial?t():o.isLogout?s():e(o.id)};return d.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 z-40 lg:hidden transition-colors duration-200",children:d.jsx("div",{className:"flex items-center justify-around py-2 px-2 pb-6 safe-area-pb",children:i.map(o=>{const l=o.icon,c=r===o.id&&!o.isSpecial&&!o.isLogout;return o.isSpecial?d.jsx("button",{onClick:()=>a(o),className:"flex flex-col items-center justify-center w-12 h-12 bg-gradient-to-br from-blue-600 to-blue-700 dark:from-blue-500 dark:to-blue-600 text-white rounded-full shadow-lg hover:from-blue-700 hover:to-blue-800 dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all duration-200 transform hover:scale-105 active:scale-95",children:d.jsx(l,{className:"w-5 h-5"})},o.id):d.jsxs("button",{onClick:()=>a(o),className:`flex flex-col items-center justify-center py-2 px-2 min-w-0 flex-1 transition-all duration-200 ${c?"text-blue-600 dark:text-blue-400":o.isLogout?"text-red-500 dark:text-red-400 hover:text-red-600 dark:hover:text-red-300":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[d.jsx(l,{className:`w-4 h-4 mb-0.5 ${c?"scale-110":""} transition-transform duration-200`}),d.jsx("span",{className:`text-[10px] font-medium truncate ${c?"font-semibold":""}`,children:o.label})]},o.id)})})})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function zs(r){return r+.5|0}const Dr=(r,e,t)=>Math.max(Math.min(r,t),e);function os(r){return Dr(zs(r*2.55),0,255)}function Mr(r){return Dr(zs(r*255),0,255)}function vr(r){return Dr(zs(r/2.55)/100,0,1)}function nc(r){return Dr(zs(r*100),0,100)}const Lt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},bo=[..."0123456789ABCDEF"],Hx=r=>bo[r&15],zx=r=>bo[(r&240)>>4]+bo[r&15],ai=r=>(r&240)>>4===(r&15),Vx=r=>ai(r.r)&&ai(r.g)&&ai(r.b)&&ai(r.a);function Gx(r){var e=r.length,t;return r[0]==="#"&&(e===4||e===5?t={r:255&Lt[r[1]]*17,g:255&Lt[r[2]]*17,b:255&Lt[r[3]]*17,a:e===5?Lt[r[4]]*17:255}:(e===7||e===9)&&(t={r:Lt[r[1]]<<4|Lt[r[2]],g:Lt[r[3]]<<4|Lt[r[4]],b:Lt[r[5]]<<4|Lt[r[6]],a:e===9?Lt[r[7]]<<4|Lt[r[8]]:255})),t}const Xx=(r,e)=>r<255?e(r):"";function Kx(r){var e=Vx(r)?Hx:zx;return r?"#"+e(r.r)+e(r.g)+e(r.b)+Xx(r.a,e):void 0}const Yx=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Bh(r,e,t){const n=e*Math.min(t,1-t),s=(i,a=(i+r/30)%12)=>t-n*Math.max(Math.min(a-3,9-a,1),-1);return[s(0),s(8),s(4)]}function qx(r,e,t){const n=(s,i=(s+r/60)%6)=>t-t*e*Math.max(Math.min(i,4-i,1),0);return[n(5),n(3),n(1)]}function Jx(r,e,t){const n=Bh(r,1,.5);let s;for(e+t>1&&(s=1/(e+t),e*=s,t*=s),s=0;s<3;s++)n[s]*=1-e-t,n[s]+=e;return n}function Zx(r,e,t,n,s){return r===s?(e-t)/n+(e<t?6:0):e===s?(t-r)/n+2:(r-e)/n+4}function $o(r){const t=r.r/255,n=r.g/255,s=r.b/255,i=Math.max(t,n,s),a=Math.min(t,n,s),o=(i+a)/2;let l,c,h;return i!==a&&(h=i-a,c=o>.5?h/(2-i-a):h/(i+a),l=Zx(t,n,s,h,i),l=l*60+.5),[l|0,c||0,o]}function Wo(r,e,t,n){return(Array.isArray(e)?r(e[0],e[1],e[2]):r(e,t,n)).map(Mr)}function Ho(r,e,t){return Wo(Bh,r,e,t)}function Qx(r,e,t){return Wo(Jx,r,e,t)}function ep(r,e,t){return Wo(qx,r,e,t)}function Uh(r){return(r%360+360)%360}function tp(r){const e=Yx.exec(r);let t=255,n;if(!e)return;e[5]!==n&&(t=e[6]?os(+e[5]):Mr(+e[5]));const s=Uh(+e[2]),i=+e[3]/100,a=+e[4]/100;return e[1]==="hwb"?n=Qx(s,i,a):e[1]==="hsv"?n=ep(s,i,a):n=Ho(s,i,a),{r:n[0],g:n[1],b:n[2],a:t}}function rp(r,e){var t=$o(r);t[0]=Uh(t[0]+e),t=Ho(t),r.r=t[0],r.g=t[1],r.b=t[2]}function np(r){if(!r)return;const e=$o(r),t=e[0],n=nc(e[1]),s=nc(e[2]);return r.a<255?`hsla(${t}, ${n}%, ${s}%, ${vr(r.a)})`:`hsl(${t}, ${n}%, ${s}%)`}const sc={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},ic={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function sp(){const r={},e=Object.keys(ic),t=Object.keys(sc);let n,s,i,a,o;for(n=0;n<e.length;n++){for(a=o=e[n],s=0;s<t.length;s++)i=t[s],o=o.replace(i,sc[i]);i=parseInt(ic[a],16),r[o]=[i>>16&255,i>>8&255,i&255]}return r}let oi;function ip(r){oi||(oi=sp(),oi.transparent=[0,0,0,0]);const e=oi[r.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const ap=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function op(r){const e=ap.exec(r);let t=255,n,s,i;if(e){if(e[7]!==n){const a=+e[7];t=e[8]?os(a):Dr(a*255,0,255)}return n=+e[1],s=+e[3],i=+e[5],n=255&(e[2]?os(n):Dr(n,0,255)),s=255&(e[4]?os(s):Dr(s,0,255)),i=255&(e[6]?os(i):Dr(i,0,255)),{r:n,g:s,b:i,a:t}}}function lp(r){return r&&(r.a<255?`rgba(${r.r}, ${r.g}, ${r.b}, ${vr(r.a)})`:`rgb(${r.r}, ${r.g}, ${r.b})`)}const Va=r=>r<=.0031308?r*12.92:Math.pow(r,1/2.4)*1.055-.055,Tn=r=>r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4);function cp(r,e,t){const n=Tn(vr(r.r)),s=Tn(vr(r.g)),i=Tn(vr(r.b));return{r:Mr(Va(n+t*(Tn(vr(e.r))-n))),g:Mr(Va(s+t*(Tn(vr(e.g))-s))),b:Mr(Va(i+t*(Tn(vr(e.b))-i))),a:r.a+t*(e.a-r.a)}}function li(r,e,t){if(r){let n=$o(r);n[e]=Math.max(0,Math.min(n[e]+n[e]*t,e===0?360:1)),n=Ho(n),r.r=n[0],r.g=n[1],r.b=n[2]}}function $h(r,e){return r&&Object.assign(e||{},r)}function ac(r){var e={r:0,g:0,b:0,a:255};return Array.isArray(r)?r.length>=3&&(e={r:r[0],g:r[1],b:r[2],a:255},r.length>3&&(e.a=Mr(r[3]))):(e=$h(r,{r:0,g:0,b:0,a:1}),e.a=Mr(e.a)),e}function hp(r){return r.charAt(0)==="r"?op(r):tp(r)}class Os{constructor(e){if(e instanceof Os)return e;const t=typeof e;let n;t==="object"?n=ac(e):t==="string"&&(n=Gx(e)||ip(e)||hp(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=$h(this._rgb);return e&&(e.a=vr(e.a)),e}set rgb(e){this._rgb=ac(e)}rgbString(){return this._valid?lp(this._rgb):void 0}hexString(){return this._valid?Kx(this._rgb):void 0}hslString(){return this._valid?np(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,s=e.rgb;let i;const a=t===i?.5:t,o=2*a-1,l=n.a-s.a,c=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;i=1-c,n.r=255&c*n.r+i*s.r+.5,n.g=255&c*n.g+i*s.g+.5,n.b=255&c*n.b+i*s.b+.5,n.a=a*n.a+(1-a)*s.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=cp(this._rgb,e._rgb,t)),this}clone(){return new Os(this.rgb)}alpha(e){return this._rgb.a=Mr(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=zs(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return li(this._rgb,2,e),this}darken(e){return li(this._rgb,2,-e),this}saturate(e){return li(this._rgb,1,e),this}desaturate(e){return li(this._rgb,1,-e),this}rotate(e){return rp(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function ur(){}const dp=(()=>{let r=0;return()=>r++})();function xt(r){return r==null}function ct(r){if(Array.isArray&&Array.isArray(r))return!0;const e=Object.prototype.toString.call(r);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Te(r){return r!==null&&Object.prototype.toString.call(r)==="[object Object]"}function kr(r){return(typeof r=="number"||r instanceof Number)&&isFinite(+r)}function nr(r,e){return kr(r)?r:e}function De(r,e){return typeof r>"u"?e:r}const fp=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100:+r/e,Wh=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100*e:+r;function Be(r,e,t){if(r&&typeof r.call=="function")return r.apply(t,e)}function Fe(r,e,t,n){let s,i,a;if(ct(r))for(i=r.length,s=0;s<i;s++)e.call(t,r[s],s);else if(Te(r))for(a=Object.keys(r),i=a.length,s=0;s<i;s++)e.call(t,r[a[s]],a[s])}function Mi(r,e){let t,n,s,i;if(!r||!e||r.length!==e.length)return!1;for(t=0,n=r.length;t<n;++t)if(s=r[t],i=e[t],s.datasetIndex!==i.datasetIndex||s.index!==i.index)return!1;return!0}function Li(r){if(ct(r))return r.map(Li);if(Te(r)){const e=Object.create(null),t=Object.keys(r),n=t.length;let s=0;for(;s<n;++s)e[t[s]]=Li(r[t[s]]);return e}return r}function Hh(r){return["__proto__","prototype","constructor"].indexOf(r)===-1}function up(r,e,t,n){if(!Hh(r))return;const s=e[r],i=t[r];Te(s)&&Te(i)?Fs(s,i,n):e[r]=Li(i)}function Fs(r,e,t){const n=ct(e)?e:[e],s=n.length;if(!Te(r))return r;t=t||{};const i=t.merger||up;let a;for(let o=0;o<s;++o){if(a=n[o],!Te(a))continue;const l=Object.keys(a);for(let c=0,h=l.length;c<h;++c)i(l[c],r,a,t)}return r}function vs(r,e){return Fs(r,e,{merger:gp})}function gp(r,e,t){if(!Hh(r))return;const n=e[r],s=t[r];Te(n)&&Te(s)?vs(n,s):Object.prototype.hasOwnProperty.call(e,r)||(e[r]=Li(s))}const oc={"":r=>r,x:r=>r.x,y:r=>r.y};function mp(r){const e=r.split("."),t=[];let n="";for(const s of e)n+=s,n.endsWith("\\")?n=n.slice(0,-1)+".":(t.push(n),n="");return t}function xp(r){const e=mp(r);return t=>{for(const n of e){if(n==="")break;t=t&&t[n]}return t}}function Ds(r,e){return(oc[e]||(oc[e]=xp(e)))(r)}function zo(r){return r.charAt(0).toUpperCase()+r.slice(1)}const Bi=r=>typeof r<"u",Lr=r=>typeof r=="function",lc=(r,e)=>{if(r.size!==e.size)return!1;for(const t of r)if(!e.has(t))return!1;return!0};function pp(r){return r.type==="mouseup"||r.type==="click"||r.type==="contextmenu"}const Ue=Math.PI,qe=2*Ue,Ui=Number.POSITIVE_INFINITY,vp=Ue/180,et=Ue/2,Kr=Ue/4,cc=Ue*2/3,hc=Math.log10,dc=Math.sign;function yp(r){const e=[],t=Math.sqrt(r);let n;for(n=1;n<t;n++)r%n===0&&(e.push(n),e.push(r/n));return t===(t|0)&&e.push(t),e.sort((s,i)=>s-i).pop(),e}function _p(r){return typeof r=="symbol"||typeof r=="object"&&r!==null&&!(Symbol.toPrimitive in r||"toString"in r||"valueOf"in r)}function $i(r){return!_p(r)&&!isNaN(parseFloat(r))&&isFinite(r)}function sn(r){return r*(Ue/180)}function bp(r){return r*(180/Ue)}function zh(r,e){const t=e.x-r.x,n=e.y-r.y,s=Math.sqrt(t*t+n*n);let i=Math.atan2(n,t);return i<-.5*Ue&&(i+=qe),{angle:i,distance:s}}function wp(r,e){return Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))}function cr(r){return(r%qe+qe)%qe}function Wi(r,e,t,n){const s=cr(r),i=cr(e),a=cr(t),o=cr(i-s),l=cr(a-s),c=cr(s-i),h=cr(s-a);return s===i||s===a||n&&i===a||o>l&&c<h}function $t(r,e,t){return Math.max(e,Math.min(t,r))}function kp(r){return $t(r,-32768,32767)}function ls(r,e,t,n=1e-6){return r>=Math.min(e,t)-n&&r<=Math.max(e,t)+n}function Vo(r,e,t){t=t||(a=>r[a]<e);let n=r.length-1,s=0,i;for(;n-s>1;)i=s+n>>1,t(i)?s=i:n=i;return{lo:s,hi:n}}const wo=(r,e,t,n)=>Vo(r,t,n?s=>{const i=r[s][e];return i<t||i===t&&r[s+1][e]===t}:s=>r[s][e]<t),Sp=(r,e,t)=>Vo(r,t,n=>r[n][e]>=t);function Tp(r,e,t){let n=0,s=r.length;for(;n<s&&r[n]<e;)n++;for(;s>n&&r[s-1]>t;)s--;return n>0||s<r.length?r.slice(n,s):r}const Vh=["push","pop","shift","splice","unshift"];function Ep(r,e){if(r._chartjs){r._chartjs.listeners.push(e);return}Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Vh.forEach(t=>{const n="_onData"+zo(t),s=r[t];Object.defineProperty(r,t,{configurable:!0,enumerable:!1,value(...i){const a=s.apply(this,i);return r._chartjs.listeners.forEach(o=>{typeof o[n]=="function"&&o[n](...i)}),a}})})}function fc(r,e){const t=r._chartjs;if(!t)return;const n=t.listeners,s=n.indexOf(e);s!==-1&&n.splice(s,1),!(n.length>0)&&(Vh.forEach(i=>{delete r[i]}),delete r._chartjs)}function Ap(r){const e=new Set(r);return e.size===r.length?r:Array.from(e)}const Gh=function(){return typeof window>"u"?function(r){return r()}:window.requestAnimationFrame}();function Xh(r,e){let t=[],n=!1;return function(...s){t=s,n||(n=!0,Gh.call(window,()=>{n=!1,r.apply(e,t)}))}}function Cp(r,e){let t;return function(...n){return e?(clearTimeout(t),t=setTimeout(r,e,n)):r.apply(this,n),e}}const Kh=r=>r==="start"?"left":r==="end"?"right":"center",Ft=(r,e,t)=>r==="start"?e:r==="end"?t:(e+t)/2,Np=(r,e,t,n)=>r===(n?"left":"right")?t:r==="center"?(e+t)/2:e,ci=r=>r===0||r===1,uc=(r,e,t)=>-(Math.pow(2,10*(r-=1))*Math.sin((r-e)*qe/t)),gc=(r,e,t)=>Math.pow(2,-10*r)*Math.sin((r-e)*qe/t)+1,ys={linear:r=>r,easeInQuad:r=>r*r,easeOutQuad:r=>-r*(r-2),easeInOutQuad:r=>(r/=.5)<1?.5*r*r:-.5*(--r*(r-2)-1),easeInCubic:r=>r*r*r,easeOutCubic:r=>(r-=1)*r*r+1,easeInOutCubic:r=>(r/=.5)<1?.5*r*r*r:.5*((r-=2)*r*r+2),easeInQuart:r=>r*r*r*r,easeOutQuart:r=>-((r-=1)*r*r*r-1),easeInOutQuart:r=>(r/=.5)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2),easeInQuint:r=>r*r*r*r*r,easeOutQuint:r=>(r-=1)*r*r*r*r+1,easeInOutQuint:r=>(r/=.5)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2),easeInSine:r=>-Math.cos(r*et)+1,easeOutSine:r=>Math.sin(r*et),easeInOutSine:r=>-.5*(Math.cos(Ue*r)-1),easeInExpo:r=>r===0?0:Math.pow(2,10*(r-1)),easeOutExpo:r=>r===1?1:-Math.pow(2,-10*r)+1,easeInOutExpo:r=>ci(r)?r:r<.5?.5*Math.pow(2,10*(r*2-1)):.5*(-Math.pow(2,-10*(r*2-1))+2),easeInCirc:r=>r>=1?r:-(Math.sqrt(1-r*r)-1),easeOutCirc:r=>Math.sqrt(1-(r-=1)*r),easeInOutCirc:r=>(r/=.5)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1),easeInElastic:r=>ci(r)?r:uc(r,.075,.3),easeOutElastic:r=>ci(r)?r:gc(r,.075,.3),easeInOutElastic(r){return ci(r)?r:r<.5?.5*uc(r*2,.1125,.45):.5+.5*gc(r*2-1,.1125,.45)},easeInBack(r){return r*r*((1.70158+1)*r-1.70158)},easeOutBack(r){return(r-=1)*r*((1.70158+1)*r+1.70158)+1},easeInOutBack(r){let e=1.70158;return(r/=.5)<1?.5*(r*r*(((e*=1.525)+1)*r-e)):.5*((r-=2)*r*(((e*=1.525)+1)*r+e)+2)},easeInBounce:r=>1-ys.easeOutBounce(1-r),easeOutBounce(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},easeInOutBounce:r=>r<.5?ys.easeInBounce(r*2)*.5:ys.easeOutBounce(r*2-1)*.5+.5};function Yh(r){if(r&&typeof r=="object"){const e=r.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function mc(r){return Yh(r)?r:new Os(r)}function Ga(r){return Yh(r)?r:new Os(r).saturate(.5).darken(.1).hexString()}const Op=["x","y","borderWidth","radius","tension"],Fp=["color","borderColor","backgroundColor"];function Dp(r){r.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),r.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),r.set("animations",{colors:{type:"color",properties:Fp},numbers:{type:"number",properties:Op}}),r.describe("animations",{_fallback:"animation"}),r.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Ip(r){r.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const xc=new Map;function Pp(r,e){e=e||{};const t=r+JSON.stringify(e);let n=xc.get(t);return n||(n=new Intl.NumberFormat(r,e),xc.set(t,n)),n}function qh(r,e,t){return Pp(e,t).format(r)}const Jh={values(r){return ct(r)?r:""+r},numeric(r,e,t){if(r===0)return"0";const n=this.chart.options.locale;let s,i=r;if(t.length>1){const c=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(c<1e-4||c>1e15)&&(s="scientific"),i=Rp(r,t)}const a=hc(Math.abs(i)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:s,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),qh(r,n,l)},logarithmic(r,e,t){if(r===0)return"0";const n=t[e].significand||r/Math.pow(10,Math.floor(hc(r)));return[1,2,3,5,10,15].includes(n)||e>.8*t.length?Jh.numeric.call(this,r,e,t):""}};function Rp(r,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&r!==Math.floor(r)&&(t=r-Math.floor(r)),t}var jp={formatters:Jh};function Mp(r){r.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:jp.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),r.route("scale.ticks","color","","color"),r.route("scale.grid","color","","borderColor"),r.route("scale.border","color","","borderColor"),r.route("scale.title","color","","color"),r.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),r.describe("scales",{_fallback:"scale"}),r.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const cn=Object.create(null),ko=Object.create(null);function _s(r,e){if(!e)return r;const t=e.split(".");for(let n=0,s=t.length;n<s;++n){const i=t[n];r=r[i]||(r[i]=Object.create(null))}return r}function Xa(r,e,t){return typeof e=="string"?Fs(_s(r,e),t):Fs(_s(r,""),e)}class Lp{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,s)=>Ga(s.backgroundColor),this.hoverBorderColor=(n,s)=>Ga(s.borderColor),this.hoverColor=(n,s)=>Ga(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Xa(this,e,t)}get(e){return _s(this,e)}describe(e,t){return Xa(ko,e,t)}override(e,t){return Xa(cn,e,t)}route(e,t,n,s){const i=_s(this,e),a=_s(this,n),o="_"+t;Object.defineProperties(i,{[o]:{value:i[t],writable:!0},[t]:{enumerable:!0,get(){const l=this[o],c=a[s];return Te(l)?Object.assign({},c,l):De(l,c)},set(l){this[o]=l}}})}apply(e){e.forEach(t=>t(this))}}var Xe=new Lp({_scriptable:r=>!r.startsWith("on"),_indexable:r=>r!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Dp,Ip,Mp]);function Bp(r){return!r||xt(r.size)||xt(r.family)?null:(r.style?r.style+" ":"")+(r.weight?r.weight+" ":"")+r.size+"px "+r.family}function pc(r,e,t,n,s){let i=e[s];return i||(i=e[s]=r.measureText(s).width,t.push(s)),i>n&&(n=i),n}function Yr(r,e,t){const n=r.currentDevicePixelRatio,s=t!==0?Math.max(t/2,.5):0;return Math.round((e-s)*n)/n+s}function vc(r,e){!e&&!r||(e=e||r.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,r.width,r.height),e.restore())}function yc(r,e,t,n){Zh(r,e,t,n,null)}function Zh(r,e,t,n,s){let i,a,o,l,c,h,f,u;const g=e.pointStyle,p=e.rotation,m=e.radius;let x=(p||0)*vp;if(g&&typeof g=="object"&&(i=g.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){r.save(),r.translate(t,n),r.rotate(x),r.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),r.restore();return}if(!(isNaN(m)||m<=0)){switch(r.beginPath(),g){default:s?r.ellipse(t,n,s/2,m,0,0,qe):r.arc(t,n,m,0,qe),r.closePath();break;case"triangle":h=s?s/2:m,r.moveTo(t+Math.sin(x)*h,n-Math.cos(x)*m),x+=cc,r.lineTo(t+Math.sin(x)*h,n-Math.cos(x)*m),x+=cc,r.lineTo(t+Math.sin(x)*h,n-Math.cos(x)*m),r.closePath();break;case"rectRounded":c=m*.516,l=m-c,a=Math.cos(x+Kr)*l,f=Math.cos(x+Kr)*(s?s/2-c:l),o=Math.sin(x+Kr)*l,u=Math.sin(x+Kr)*(s?s/2-c:l),r.arc(t-f,n-o,c,x-Ue,x-et),r.arc(t+u,n-a,c,x-et,x),r.arc(t+f,n+o,c,x,x+et),r.arc(t-u,n+a,c,x+et,x+Ue),r.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*m,h=s?s/2:l,r.rect(t-h,n-l,2*h,2*l);break}x+=Kr;case"rectRot":f=Math.cos(x)*(s?s/2:m),a=Math.cos(x)*m,o=Math.sin(x)*m,u=Math.sin(x)*(s?s/2:m),r.moveTo(t-f,n-o),r.lineTo(t+u,n-a),r.lineTo(t+f,n+o),r.lineTo(t-u,n+a),r.closePath();break;case"crossRot":x+=Kr;case"cross":f=Math.cos(x)*(s?s/2:m),a=Math.cos(x)*m,o=Math.sin(x)*m,u=Math.sin(x)*(s?s/2:m),r.moveTo(t-f,n-o),r.lineTo(t+f,n+o),r.moveTo(t+u,n-a),r.lineTo(t-u,n+a);break;case"star":f=Math.cos(x)*(s?s/2:m),a=Math.cos(x)*m,o=Math.sin(x)*m,u=Math.sin(x)*(s?s/2:m),r.moveTo(t-f,n-o),r.lineTo(t+f,n+o),r.moveTo(t+u,n-a),r.lineTo(t-u,n+a),x+=Kr,f=Math.cos(x)*(s?s/2:m),a=Math.cos(x)*m,o=Math.sin(x)*m,u=Math.sin(x)*(s?s/2:m),r.moveTo(t-f,n-o),r.lineTo(t+f,n+o),r.moveTo(t+u,n-a),r.lineTo(t-u,n+a);break;case"line":a=s?s/2:Math.cos(x)*m,o=Math.sin(x)*m,r.moveTo(t-a,n-o),r.lineTo(t+a,n+o);break;case"dash":r.moveTo(t,n),r.lineTo(t+Math.cos(x)*(s?s/2:m),n+Math.sin(x)*m);break;case!1:r.closePath();break}r.fill(),e.borderWidth>0&&r.stroke()}}function Qh(r,e,t){return t=t||.5,!e||r&&r.x>e.left-t&&r.x<e.right+t&&r.y>e.top-t&&r.y<e.bottom+t}function Go(r,e){r.save(),r.beginPath(),r.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),r.clip()}function Xo(r){r.restore()}function Up(r,e){e.translation&&r.translate(e.translation[0],e.translation[1]),xt(e.rotation)||r.rotate(e.rotation),e.color&&(r.fillStyle=e.color),e.textAlign&&(r.textAlign=e.textAlign),e.textBaseline&&(r.textBaseline=e.textBaseline)}function $p(r,e,t,n,s){if(s.strikethrough||s.underline){const i=r.measureText(n),a=e-i.actualBoundingBoxLeft,o=e+i.actualBoundingBoxRight,l=t-i.actualBoundingBoxAscent,c=t+i.actualBoundingBoxDescent,h=s.strikethrough?(l+c)/2:c;r.strokeStyle=r.fillStyle,r.beginPath(),r.lineWidth=s.decorationWidth||2,r.moveTo(a,h),r.lineTo(o,h),r.stroke()}}function Wp(r,e){const t=r.fillStyle;r.fillStyle=e.color,r.fillRect(e.left,e.top,e.width,e.height),r.fillStyle=t}function Hi(r,e,t,n,s,i={}){const a=ct(e)?e:[e],o=i.strokeWidth>0&&i.strokeColor!=="";let l,c;for(r.save(),r.font=s.string,Up(r,i),l=0;l<a.length;++l)c=a[l],i.backdrop&&Wp(r,i.backdrop),o&&(i.strokeColor&&(r.strokeStyle=i.strokeColor),xt(i.strokeWidth)||(r.lineWidth=i.strokeWidth),r.strokeText(c,t,n,i.maxWidth)),r.fillText(c,t,n,i.maxWidth),$p(r,t,n,c,i),n+=Number(s.lineHeight);r.restore()}function So(r,e){const{x:t,y:n,w:s,h:i,radius:a}=e;r.arc(t+a.topLeft,n+a.topLeft,a.topLeft,1.5*Ue,Ue,!0),r.lineTo(t,n+i-a.bottomLeft),r.arc(t+a.bottomLeft,n+i-a.bottomLeft,a.bottomLeft,Ue,et,!0),r.lineTo(t+s-a.bottomRight,n+i),r.arc(t+s-a.bottomRight,n+i-a.bottomRight,a.bottomRight,et,0,!0),r.lineTo(t+s,n+a.topRight),r.arc(t+s-a.topRight,n+a.topRight,a.topRight,0,-et,!0),r.lineTo(t+a.topLeft,n)}const Hp=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,zp=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Vp(r,e){const t=(""+r).match(Hp);if(!t||t[1]==="normal")return e*1.2;switch(r=+t[2],t[3]){case"px":return r;case"%":r/=100;break}return e*r}const Gp=r=>+r||0;function Ko(r,e){const t={},n=Te(e),s=n?Object.keys(e):e,i=Te(r)?n?a=>De(r[a],r[e[a]]):a=>r[a]:()=>r;for(const a of s)t[a]=Gp(i(a));return t}function Xp(r){return Ko(r,{top:"y",right:"x",bottom:"y",left:"x"})}function bs(r){return Ko(r,["topLeft","topRight","bottomLeft","bottomRight"])}function er(r){const e=Xp(r);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Et(r,e){r=r||{},e=e||Xe.font;let t=De(r.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let n=De(r.style,e.style);n&&!(""+n).match(zp)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const s={family:De(r.family,e.family),lineHeight:Vp(De(r.lineHeight,e.lineHeight),t),size:t,style:n,weight:De(r.weight,e.weight),string:""};return s.string=Bp(s),s}function hi(r,e,t,n){let s,i,a;for(s=0,i=r.length;s<i;++s)if(a=r[s],a!==void 0&&a!==void 0)return a}function Kp(r,e,t){const{min:n,max:s}=r,i=Wh(e,(s-n)/2),a=(o,l)=>t&&o===0?0:o+l;return{min:a(n,-Math.abs(i)),max:a(s,i)}}function Vn(r,e){return Object.assign(Object.create(r),e)}function Yo(r,e=[""],t,n,s=()=>r[0]){const i=t||r;typeof n>"u"&&(n=nd("_fallback",r));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:r,_rootScopes:i,_fallback:n,_getTarget:s,override:o=>Yo([o,...r],e,i,n)};return new Proxy(a,{deleteProperty(o,l){return delete o[l],delete o._keys,delete r[0][l],!0},get(o,l){return td(o,l,()=>r1(l,e,r,o))},getOwnPropertyDescriptor(o,l){return Reflect.getOwnPropertyDescriptor(o._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(r[0])},has(o,l){return bc(o).includes(l)},ownKeys(o){return bc(o)},set(o,l,c){const h=o._storage||(o._storage=s());return o[l]=h[l]=c,delete o._keys,!0}})}function $n(r,e,t,n){const s={_cacheable:!1,_proxy:r,_context:e,_subProxy:t,_stack:new Set,_descriptors:ed(r,n),setContext:i=>$n(r,i,t,n),override:i=>$n(r.override(i),e,t,n)};return new Proxy(s,{deleteProperty(i,a){return delete i[a],delete r[a],!0},get(i,a,o){return td(i,a,()=>qp(i,a,o))},getOwnPropertyDescriptor(i,a){return i._descriptors.allKeys?Reflect.has(r,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(r,a)},getPrototypeOf(){return Reflect.getPrototypeOf(r)},has(i,a){return Reflect.has(r,a)},ownKeys(){return Reflect.ownKeys(r)},set(i,a,o){return r[a]=o,delete i[a],!0}})}function ed(r,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:n=e.indexable,_allKeys:s=e.allKeys}=r;return{allKeys:s,scriptable:t,indexable:n,isScriptable:Lr(t)?t:()=>t,isIndexable:Lr(n)?n:()=>n}}const Yp=(r,e)=>r?r+zo(e):e,qo=(r,e)=>Te(e)&&r!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function td(r,e,t){if(Object.prototype.hasOwnProperty.call(r,e)||e==="constructor")return r[e];const n=t();return r[e]=n,n}function qp(r,e,t){const{_proxy:n,_context:s,_subProxy:i,_descriptors:a}=r;let o=n[e];return Lr(o)&&a.isScriptable(e)&&(o=Jp(e,o,r,t)),ct(o)&&o.length&&(o=Zp(e,o,r,a.isIndexable)),qo(e,o)&&(o=$n(o,s,i&&i[e],a)),o}function Jp(r,e,t,n){const{_proxy:s,_context:i,_subProxy:a,_stack:o}=t;if(o.has(r))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+r);o.add(r);let l=e(i,a||n);return o.delete(r),qo(r,l)&&(l=Jo(s._scopes,s,r,l)),l}function Zp(r,e,t,n){const{_proxy:s,_context:i,_subProxy:a,_descriptors:o}=t;if(typeof i.index<"u"&&n(r))return e[i.index%e.length];if(Te(e[0])){const l=e,c=s._scopes.filter(h=>h!==l);e=[];for(const h of l){const f=Jo(c,s,r,h);e.push($n(f,i,a&&a[r],o))}}return e}function rd(r,e,t){return Lr(r)?r(e,t):r}const Qp=(r,e)=>r===!0?e:typeof r=="string"?Ds(e,r):void 0;function e1(r,e,t,n,s){for(const i of e){const a=Qp(t,i);if(a){r.add(a);const o=rd(a._fallback,t,s);if(typeof o<"u"&&o!==t&&o!==n)return o}else if(a===!1&&typeof n<"u"&&t!==n)return null}return!1}function Jo(r,e,t,n){const s=e._rootScopes,i=rd(e._fallback,t,n),a=[...r,...s],o=new Set;o.add(n);let l=_c(o,a,t,i||t,n);return l===null||typeof i<"u"&&i!==t&&(l=_c(o,a,i,l,n),l===null)?!1:Yo(Array.from(o),[""],s,i,()=>t1(e,t,n))}function _c(r,e,t,n,s){for(;t;)t=e1(r,e,t,n,s);return t}function t1(r,e,t){const n=r._getTarget();e in n||(n[e]={});const s=n[e];return ct(s)&&Te(t)?t:s||{}}function r1(r,e,t,n){let s;for(const i of e)if(s=nd(Yp(i,r),t),typeof s<"u")return qo(r,s)?Jo(t,n,r,s):s}function nd(r,e){for(const t of e){if(!t)continue;const n=t[r];if(typeof n<"u")return n}}function bc(r){let e=r._keys;return e||(e=r._keys=n1(r._scopes)),e}function n1(r){const e=new Set;for(const t of r)for(const n of Object.keys(t).filter(s=>!s.startsWith("_")))e.add(n);return Array.from(e)}function Zo(){return typeof window<"u"&&typeof document<"u"}function Qo(r){let e=r.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function zi(r,e,t){let n;return typeof r=="string"?(n=parseInt(r,10),r.indexOf("%")!==-1&&(n=n/100*e.parentNode[t])):n=r,n}const pa=r=>r.ownerDocument.defaultView.getComputedStyle(r,null);function s1(r,e){return pa(r).getPropertyValue(e)}const i1=["top","right","bottom","left"];function on(r,e,t){const n={};t=t?"-"+t:"";for(let s=0;s<4;s++){const i=i1[s];n[i]=parseFloat(r[e+"-"+i+t])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const a1=(r,e,t)=>(r>0||e>0)&&(!t||!t.shadowRoot);function o1(r,e){const t=r.touches,n=t&&t.length?t[0]:r,{offsetX:s,offsetY:i}=n;let a=!1,o,l;if(a1(s,i,r.target))o=s,l=i;else{const c=e.getBoundingClientRect();o=n.clientX-c.left,l=n.clientY-c.top,a=!0}return{x:o,y:l,box:a}}function Qr(r,e){if("native"in r)return r;const{canvas:t,currentDevicePixelRatio:n}=e,s=pa(t),i=s.boxSizing==="border-box",a=on(s,"padding"),o=on(s,"border","width"),{x:l,y:c,box:h}=o1(r,t),f=a.left+(h&&o.left),u=a.top+(h&&o.top);let{width:g,height:p}=e;return i&&(g-=a.width+o.width,p-=a.height+o.height),{x:Math.round((l-f)/g*t.width/n),y:Math.round((c-u)/p*t.height/n)}}function l1(r,e,t){let n,s;if(e===void 0||t===void 0){const i=r&&Qo(r);if(!i)e=r.clientWidth,t=r.clientHeight;else{const a=i.getBoundingClientRect(),o=pa(i),l=on(o,"border","width"),c=on(o,"padding");e=a.width-c.width-l.width,t=a.height-c.height-l.height,n=zi(o.maxWidth,i,"clientWidth"),s=zi(o.maxHeight,i,"clientHeight")}}return{width:e,height:t,maxWidth:n||Ui,maxHeight:s||Ui}}const di=r=>Math.round(r*10)/10;function c1(r,e,t,n){const s=pa(r),i=on(s,"margin"),a=zi(s.maxWidth,r,"clientWidth")||Ui,o=zi(s.maxHeight,r,"clientHeight")||Ui,l=l1(r,e,t);let{width:c,height:h}=l;if(s.boxSizing==="content-box"){const u=on(s,"border","width"),g=on(s,"padding");c-=g.width+u.width,h-=g.height+u.height}return c=Math.max(0,c-i.width),h=Math.max(0,n?c/n:h-i.height),c=di(Math.min(c,a,l.maxWidth)),h=di(Math.min(h,o,l.maxHeight)),c&&!h&&(h=di(c/2)),(e!==void 0||t!==void 0)&&n&&l.height&&h>l.height&&(h=l.height,c=di(Math.floor(h*n))),{width:c,height:h}}function wc(r,e,t){const n=e||1,s=Math.floor(r.height*n),i=Math.floor(r.width*n);r.height=Math.floor(r.height),r.width=Math.floor(r.width);const a=r.canvas;return a.style&&(t||!a.style.height&&!a.style.width)&&(a.style.height=`${r.height}px`,a.style.width=`${r.width}px`),r.currentDevicePixelRatio!==n||a.height!==s||a.width!==i?(r.currentDevicePixelRatio=n,a.height=s,a.width=i,r.ctx.setTransform(n,0,0,n,0,0),!0):!1}const h1=function(){let r=!1;try{const e={get passive(){return r=!0,!1}};Zo()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return r}();function kc(r,e){const t=s1(r,e),n=t&&t.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}const d1=function(r,e){return{x(t){return r+r+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,n){return t-n},leftForLtr(t,n){return t-n}}},f1=function(){return{x(r){return r},setWidth(r){},textAlign(r){return r},xPlus(r,e){return r+e},leftForLtr(r,e){return r}}};function Pn(r,e,t){return r?d1(e,t):f1()}function sd(r,e){let t,n;(e==="ltr"||e==="rtl")&&(t=r.canvas.style,n=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),r.prevTextDirection=n)}function id(r,e){e!==void 0&&(delete r.prevTextDirection,r.canvas.style.setProperty("direction",e[0],e[1]))}function fi(r,e,t){return r.options.clip?r[t]:e[t]}function u1(r,e){const{xScale:t,yScale:n}=r;return t&&n?{left:fi(t,e,"left"),right:fi(t,e,"right"),top:fi(n,e,"top"),bottom:fi(n,e,"bottom")}:e}function g1(r,e){const t=e._clip;if(t.disabled)return!1;const n=u1(e,r.chartArea);return{left:t.left===!1?0:n.left-(t.left===!0?0:t.left),right:t.right===!1?r.width:n.right+(t.right===!0?0:t.right),top:t.top===!1?0:n.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?r.height:n.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class m1{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,s){const i=t.listeners[s],a=t.duration;i.forEach(o=>o({chart:e,initial:t.initial,numSteps:a,currentStep:Math.min(n-t.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=Gh.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((n,s)=>{if(!n.running||!n.items.length)return;const i=n.items;let a=i.length-1,o=!1,l;for(;a>=0;--a)l=i[a],l._active?(l._total>n.duration&&(n.duration=l._total),l.tick(e),o=!0):(i[a]=i[i.length-1],i.pop());o&&(s.draw(),this._notify(s,n,e,"progress")),i.length||(n.running=!1,this._notify(s,n,e,"complete"),n.initial=!1),t+=i.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((n,s)=>Math.max(n,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let s=n.length-1;for(;s>=0;--s)n[s].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var mr=new m1;const Sc="transparent",x1={boolean(r,e,t){return t>.5?e:r},color(r,e,t){const n=mc(r||Sc),s=n.valid&&mc(e||Sc);return s&&s.valid?s.mix(n,t).hexString():e},number(r,e,t){return r+(e-r)*t}};class p1{constructor(e,t,n,s){const i=t[n];s=hi([e.to,s,i,e.from]);const a=hi([e.from,i,s]);this._active=!0,this._fn=e.fn||x1[e.type||typeof a],this._easing=ys[e.easing]||ys.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=a,this._to=s,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const s=this._target[this._prop],i=n-this._start,a=this._duration-i;this._start=n,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=hi([e.to,t,s,e.from]),this._from=hi([e.from,s,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,s=this._prop,i=this._from,a=this._loop,o=this._to;let l;if(this._active=i!==o&&(a||t<n),!this._active){this._target[s]=o,this._notify(!0);return}if(t<0){this._target[s]=i;return}l=t/n%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[s]=this._fn(i,o,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let s=0;s<n.length;s++)n[s][t]()}}class ad{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Te(e))return;const t=Object.keys(Xe.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const i=e[s];if(!Te(i))return;const a={};for(const o of t)a[o]=i[o];(ct(i.properties)&&i.properties||[s]).forEach(o=>{(o===s||!n.has(o))&&n.set(o,a)})})}_animateOptions(e,t){const n=t.options,s=y1(e,n);if(!s)return[];const i=this._createAnimations(s,n);return n.$shared&&v1(e.options.$animations,n).then(()=>{e.options=n},()=>{}),i}_createAnimations(e,t){const n=this._properties,s=[],i=e.$animations||(e.$animations={}),a=Object.keys(t),o=Date.now();let l;for(l=a.length-1;l>=0;--l){const c=a[l];if(c.charAt(0)==="$")continue;if(c==="options"){s.push(...this._animateOptions(e,t));continue}const h=t[c];let f=i[c];const u=n.get(c);if(f)if(u&&f.active()){f.update(u,h,o);continue}else f.cancel();if(!u||!u.duration){e[c]=h;continue}i[c]=f=new p1(u,e,c,h),s.push(f)}return s}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const n=this._createAnimations(e,t);if(n.length)return mr.add(this._chart,n),!0}}function v1(r,e){const t=[],n=Object.keys(e);for(let s=0;s<n.length;s++){const i=r[n[s]];i&&i.active()&&t.push(i.wait())}return Promise.all(t)}function y1(r,e){if(!e)return;let t=r.options;if(!t){r.options=e;return}return t.$shared&&(r.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function Tc(r,e){const t=r&&r.options||{},n=t.reverse,s=t.min===void 0?e:0,i=t.max===void 0?e:0;return{start:n?i:s,end:n?s:i}}function _1(r,e,t){if(t===!1)return!1;const n=Tc(r,t),s=Tc(e,t);return{top:s.end,right:n.end,bottom:s.start,left:n.start}}function b1(r){let e,t,n,s;return Te(r)?(e=r.top,t=r.right,n=r.bottom,s=r.left):e=t=n=s=r,{top:e,right:t,bottom:n,left:s,disabled:r===!1}}function od(r,e){const t=[],n=r._getSortedDatasetMetas(e);let s,i;for(s=0,i=n.length;s<i;++s)t.push(n[s].index);return t}function Ec(r,e,t,n={}){const s=r.keys,i=n.mode==="single";let a,o,l,c;if(e===null)return;let h=!1;for(a=0,o=s.length;a<o;++a){if(l=+s[a],l===t){if(h=!0,n.all)continue;break}c=r.values[l],kr(c)&&(i||e===0||dc(e)===dc(c))&&(e+=c)}return!h&&!n.all?0:e}function w1(r,e){const{iScale:t,vScale:n}=e,s=t.axis==="x"?"x":"y",i=n.axis==="x"?"x":"y",a=Object.keys(r),o=new Array(a.length);let l,c,h;for(l=0,c=a.length;l<c;++l)h=a[l],o[l]={[s]:h,[i]:r[h]};return o}function Ka(r,e){const t=r&&r.options.stacked;return t||t===void 0&&e.stack!==void 0}function k1(r,e,t){return`${r.id}.${e.id}.${t.stack||t.type}`}function S1(r){const{min:e,max:t,minDefined:n,maxDefined:s}=r.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:s?t:Number.POSITIVE_INFINITY}}function T1(r,e,t){const n=r[e]||(r[e]={});return n[t]||(n[t]={})}function Ac(r,e,t,n){for(const s of e.getMatchingVisibleMetas(n).reverse()){const i=r[s.index];if(t&&i>0||!t&&i<0)return s.index}return null}function Cc(r,e){const{chart:t,_cachedMeta:n}=r,s=t._stacks||(t._stacks={}),{iScale:i,vScale:a,index:o}=n,l=i.axis,c=a.axis,h=k1(i,a,n),f=e.length;let u;for(let g=0;g<f;++g){const p=e[g],{[l]:m,[c]:x}=p,v=p._stacks||(p._stacks={});u=v[c]=T1(s,h,m),u[o]=x,u._top=Ac(u,a,!0,n.type),u._bottom=Ac(u,a,!1,n.type);const b=u._visualValues||(u._visualValues={});b[o]=x}}function Ya(r,e){const t=r.scales;return Object.keys(t).filter(n=>t[n].axis===e).shift()}function E1(r,e){return Vn(r,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function A1(r,e,t){return Vn(r,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function es(r,e){const t=r.controller.index,n=r.vScale&&r.vScale.axis;if(n){e=e||r._parsed;for(const s of e){const i=s._stacks;if(!i||i[n]===void 0||i[n][t]===void 0)return;delete i[n][t],i[n]._visualValues!==void 0&&i[n]._visualValues[t]!==void 0&&delete i[n]._visualValues[t]}}}const qa=r=>r==="reset"||r==="none",Nc=(r,e)=>e?r:Object.assign({},r),C1=(r,e,t)=>r&&!e.hidden&&e._stacked&&{keys:od(t,!0),values:null};class ws{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Ka(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&es(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),s=(f,u,g,p)=>f==="x"?u:f==="r"?p:g,i=t.xAxisID=De(n.xAxisID,Ya(e,"x")),a=t.yAxisID=De(n.yAxisID,Ya(e,"y")),o=t.rAxisID=De(n.rAxisID,Ya(e,"r")),l=t.indexAxis,c=t.iAxisID=s(l,i,a,o),h=t.vAxisID=s(l,a,i,o);t.xScale=this.getScaleForId(i),t.yScale=this.getScaleForId(a),t.rScale=this.getScaleForId(o),t.iScale=this.getScaleForId(c),t.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&fc(this._data,this),e._stacked&&es(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(Te(t)){const s=this._cachedMeta;this._data=w1(t,s)}else if(n!==t){if(n){fc(n,this);const s=this._cachedMeta;es(s),s._parsed=[]}t&&Object.isExtensible(t)&&Ep(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let s=!1;this._dataCheck();const i=t._stacked;t._stacked=Ka(t.vScale,t),t.stack!==n.stack&&(s=!0,es(t),t.stack=n.stack),this._resyncElements(e),(s||i!==t._stacked)&&(Cc(this,t._parsed),t._stacked=Ka(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:s}=this,{iScale:i,_stacked:a}=n,o=i.axis;let l=e===0&&t===s.length?!0:n._sorted,c=e>0&&n._parsed[e-1],h,f,u;if(this._parsing===!1)n._parsed=s,n._sorted=!0,u=s;else{ct(s[e])?u=this.parseArrayData(n,s,e,t):Te(s[e])?u=this.parseObjectData(n,s,e,t):u=this.parsePrimitiveData(n,s,e,t);const g=()=>f[o]===null||c&&f[o]<c[o];for(h=0;h<t;++h)n._parsed[h+e]=f=u[h],l&&(g()&&(l=!1),c=f);n._sorted=l}a&&Cc(this,u)}parsePrimitiveData(e,t,n,s){const{iScale:i,vScale:a}=e,o=i.axis,l=a.axis,c=i.getLabels(),h=i===a,f=new Array(s);let u,g,p;for(u=0,g=s;u<g;++u)p=u+n,f[u]={[o]:h||i.parse(c[p],p),[l]:a.parse(t[p],p)};return f}parseArrayData(e,t,n,s){const{xScale:i,yScale:a}=e,o=new Array(s);let l,c,h,f;for(l=0,c=s;l<c;++l)h=l+n,f=t[h],o[l]={x:i.parse(f[0],h),y:a.parse(f[1],h)};return o}parseObjectData(e,t,n,s){const{xScale:i,yScale:a}=e,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=new Array(s);let h,f,u,g;for(h=0,f=s;h<f;++h)u=h+n,g=t[u],c[h]={x:i.parse(Ds(g,o),u),y:a.parse(Ds(g,l),u)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const s=this.chart,i=this._cachedMeta,a=t[e.axis],o={keys:od(s,!0),values:t._stacks[e.axis]._visualValues};return Ec(o,a,i.index,{mode:n})}updateRangeFromParsed(e,t,n,s){const i=n[t.axis];let a=i===null?NaN:i;const o=s&&n._stacks[t.axis];s&&o&&(s.values=o,a=Ec(s,i,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,t){const n=this._cachedMeta,s=n._parsed,i=n._sorted&&e===n.iScale,a=s.length,o=this._getOtherScale(e),l=C1(t,n,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:f}=S1(o);let u,g;function p(){g=s[u];const m=g[o.axis];return!kr(g[e.axis])||h>m||f<m}for(u=0;u<a&&!(!p()&&(this.updateRangeFromParsed(c,e,g,l),i));++u);if(i){for(u=a-1;u>=0;--u)if(!p()){this.updateRangeFromParsed(c,e,g,l);break}}return c}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let s,i,a;for(s=0,i=t.length;s<i;++s)a=t[s][e.axis],kr(a)&&n.push(a);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,s=t.vScale,i=this.getParsed(e);return{label:n?""+n.getLabelForValue(i[n.axis]):"",value:s?""+s.getLabelForValue(i[s.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=b1(De(this.options.clip,_1(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,s=n.data||[],i=t.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||s.length-o,c=this.options.drawActiveElementsOnTop;let h;for(n.dataset&&n.dataset.draw(e,i,o,l),h=o;h<o+l;++h){const f=s[h];f.hidden||(f.active&&c?a.push(f):f.draw(e,i))}for(h=0;h<a.length;++h)a[h].draw(e,i)}getStyle(e,t){const n=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const s=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];i=a.$context||(a.$context=A1(this.getContext(),e,a)),i.parsed=this.getParsed(e),i.raw=s.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=E1(this.chart.getContext(),this.index)),i.dataset=s,i.index=i.datasetIndex=this.index;return i.active=!!t,i.mode=n,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",n){const s=t==="active",i=this._cachedDataOpts,a=e+"-"+t,o=i[a],l=this.enableOptionSharing&&Bi(n);if(o)return Nc(o,l);const c=this.chart.config,h=c.datasetElementScopeKeys(this._type,e),f=s?[`${e}Hover`,"hover",e,""]:[e,""],u=c.getOptionScopes(this.getDataset(),h),g=Object.keys(Xe.elements[e]),p=()=>this.getContext(n,s,t),m=c.resolveNamedOptions(u,g,p,f);return m.$shared&&(m.$shared=l,i[a]=Object.freeze(Nc(m,l))),m}_resolveAnimations(e,t,n){const s=this.chart,i=this._cachedDataOpts,a=`animation-${t}`,o=i[a];if(o)return o;let l;if(s.options.animation!==!1){const h=this.chart.config,f=h.datasetAnimationScopeKeys(this._type,t),u=h.getOptionScopes(this.getDataset(),f);l=h.createResolver(u,this.getContext(e,n,t))}const c=new ad(s,l&&l.animations);return l&&l._cacheable&&(i[a]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||qa(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),s=this._sharedOptions,i=this.getSharedOptions(n),a=this.includeOptions(t,i)||i!==s;return this.updateSharedOptions(i,t,n),{sharedOptions:i,includeOptions:a}}updateElement(e,t,n,s){qa(s)?Object.assign(e,n):this._resolveAnimations(t,s).update(e,n)}updateSharedOptions(e,t,n){e&&!qa(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,s){e.active=s;const i=this.getStyle(t,s);this._resolveAnimations(t,n,s).update(e,{options:!s&&this.getSharedOptions(i)||i})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[o,l,c]of this._syncList)this[o](l,c);this._syncList=[];const s=n.length,i=t.length,a=Math.min(i,s);a&&this.parse(0,a),i>s?this._insertElements(s,i-s,e):i<s&&this._removeElements(i,s-i)}_insertElements(e,t,n=!0){const s=this._cachedMeta,i=s.data,a=e+t;let o;const l=c=>{for(c.length+=t,o=c.length-1;o>=a;o--)c[o]=c[o-t]};for(l(i),o=e;o<a;++o)i[o]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(e,t),n&&this.updateElements(i,e,t,"reset")}updateElements(e,t,n,s){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const s=n._parsed.splice(e,t);n._stacked&&es(n,s)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,s]=e;this[t](n,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ye(ws,"defaults",{}),ye(ws,"datasetElementType",null),ye(ws,"dataElementType",null);function N1(r,e,t){let n=1,s=1,i=0,a=0;if(e<qe){const o=r,l=o+e,c=Math.cos(o),h=Math.sin(o),f=Math.cos(l),u=Math.sin(l),g=(_,k,O)=>Wi(_,o,l,!0)?1:Math.max(k,k*t,O,O*t),p=(_,k,O)=>Wi(_,o,l,!0)?-1:Math.min(k,k*t,O,O*t),m=g(0,c,f),x=g(et,h,u),v=p(Ue,c,f),b=p(Ue+et,h,u);n=(m-v)/2,s=(x-b)/2,i=-(m+v)/2,a=-(x+b)/2}return{ratioX:n,ratioY:s,offsetX:i,offsetY:a}}class cs extends ws{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=n;else{let i=l=>+n[l];if(Te(n[e])){const{key:l="value"}=this._parsing;i=c=>+Ds(n[c],l)}let a,o;for(a=e,o=e+t;a<o;++a)s._parsed[a]=i(a)}}_getRotation(){return sn(this.options.rotation-90)}_getCircumference(){return sn(this.options.circumference)}_getRotationExtents(){let e=qe,t=-qe;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const s=this.chart.getDatasetMeta(n).controller,i=s._getRotation(),a=s._getCircumference();e=Math.min(e,i),t=Math.max(t,i+a)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,s=this._cachedMeta,i=s.data,a=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,o=Math.max((Math.min(n.width,n.height)-a)/2,0),l=Math.min(fp(this.options.cutout,o),1),c=this._getRingWeight(this.index),{circumference:h,rotation:f}=this._getRotationExtents(),{ratioX:u,ratioY:g,offsetX:p,offsetY:m}=N1(f,h,l),x=(n.width-a)/u,v=(n.height-a)/g,b=Math.max(Math.min(x,v)/2,0),_=Wh(this.options.radius,b),k=Math.max(_*l,0),O=(_-k)/this._getVisibleDatasetWeightTotal();this.offsetX=p*_,this.offsetY=m*_,s.total=this.calculateTotal(),this.outerRadius=_-O*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-O*c,0),this.updateElements(i,0,i.length,e)}_circumference(e,t){const n=this.options,s=this._cachedMeta,i=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*i/qe)}updateElements(e,t,n,s){const i=s==="reset",a=this.chart,o=a.chartArea,c=a.options.animation,h=(o.left+o.right)/2,f=(o.top+o.bottom)/2,u=i&&c.animateScale,g=u?0:this.innerRadius,p=u?0:this.outerRadius,{sharedOptions:m,includeOptions:x}=this._getSharedOptions(t,s);let v=this._getRotation(),b;for(b=0;b<t;++b)v+=this._circumference(b,i);for(b=t;b<t+n;++b){const _=this._circumference(b,i),k=e[b],O={x:h+this.offsetX,y:f+this.offsetY,startAngle:v,endAngle:v+_,circumference:_,outerRadius:p,innerRadius:g};x&&(O.options=m||this.resolveDataElementOptions(b,k.active?"active":s)),v+=_,this.updateElement(k,b,O,s)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n=0,s;for(s=0;s<t.length;s++){const i=e._parsed[s];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(s)&&!t[s].hidden&&(n+=Math.abs(i))}return n}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?qe*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,s=n.data.labels||[],i=qh(t._parsed[e],n.options.locale);return{label:s[e]||"",value:i}}getMaxBorderWidth(e){let t=0;const n=this.chart;let s,i,a,o,l;if(!e){for(s=0,i=n.data.datasets.length;s<i;++s)if(n.isDatasetVisible(s)){a=n.getDatasetMeta(s),e=a.data,o=a.controller;break}}if(!e)return 0;for(s=0,i=e.length;s<i;++s)l=o.resolveDataElementOptions(s),l.borderAlign!=="inner"&&(t=Math.max(t,l.borderWidth||0,l.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,s=e.length;n<s;++n){const i=this.resolveDataElementOptions(n);t=Math.max(t,i.offset||0,i.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(De(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}ye(cs,"id","doughnut"),ye(cs,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),ye(cs,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),ye(cs,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:s}}=e.legend.options;return t.labels.map((i,a)=>{const l=e.getDatasetMeta(0).controller.getStyle(a);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(a),index:a}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});class To extends cs{}ye(To,"id","pie"),ye(To,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function qr(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class el{constructor(e){ye(this,"options");this.options=e||{}}static override(e){Object.assign(el.prototype,e)}init(){}formats(){return qr()}parse(){return qr()}format(){return qr()}add(){return qr()}diff(){return qr()}startOf(){return qr()}endOf(){return qr()}}var O1={_date:el};function F1(r,e,t,n){const{controller:s,data:i,_sorted:a}=r,o=s._cachedMeta.iScale,l=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null;if(o&&e===o.axis&&e!=="r"&&a&&i.length){const c=o._reversePixels?Sp:wo;if(n){if(s._sharedOptions){const h=i[0],f=typeof h.getRange=="function"&&h.getRange(e);if(f){const u=c(i,e,t-f),g=c(i,e,t+f);return{lo:u.lo,hi:g.hi}}}}else{const h=c(i,e,t);if(l){const{vScale:f}=s._cachedMeta,{_parsed:u}=r,g=u.slice(0,h.lo+1).reverse().findIndex(m=>!xt(m[f.axis]));h.lo-=Math.max(0,g);const p=u.slice(h.hi).findIndex(m=>!xt(m[f.axis]));h.hi+=Math.max(0,p)}return h}}return{lo:0,hi:i.length-1}}function Vs(r,e,t,n,s){const i=r.getSortedVisibleDatasetMetas(),a=t[e];for(let o=0,l=i.length;o<l;++o){const{index:c,data:h}=i[o],{lo:f,hi:u}=F1(i[o],e,a,s);for(let g=f;g<=u;++g){const p=h[g];p.skip||n(p,c,g)}}}function D1(r){const e=r.indexOf("x")!==-1,t=r.indexOf("y")!==-1;return function(n,s){const i=e?Math.abs(n.x-s.x):0,a=t?Math.abs(n.y-s.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(a,2))}}function Ja(r,e,t,n,s){const i=[];return!s&&!r.isPointInArea(e)||Vs(r,t,e,function(o,l,c){!s&&!Qh(o,r.chartArea,0)||o.inRange(e.x,e.y,n)&&i.push({element:o,datasetIndex:l,index:c})},!0),i}function I1(r,e,t,n){let s=[];function i(a,o,l){const{startAngle:c,endAngle:h}=a.getProps(["startAngle","endAngle"],n),{angle:f}=zh(a,{x:e.x,y:e.y});Wi(f,c,h)&&s.push({element:a,datasetIndex:o,index:l})}return Vs(r,t,e,i),s}function P1(r,e,t,n,s,i){let a=[];const o=D1(t);let l=Number.POSITIVE_INFINITY;function c(h,f,u){const g=h.inRange(e.x,e.y,s);if(n&&!g)return;const p=h.getCenterPoint(s);if(!(!!i||r.isPointInArea(p))&&!g)return;const x=o(e,p);x<l?(a=[{element:h,datasetIndex:f,index:u}],l=x):x===l&&a.push({element:h,datasetIndex:f,index:u})}return Vs(r,t,e,c),a}function Za(r,e,t,n,s,i){return!i&&!r.isPointInArea(e)?[]:t==="r"&&!n?I1(r,e,t,s):P1(r,e,t,n,s,i)}function Oc(r,e,t,n,s){const i=[],a=t==="x"?"inXRange":"inYRange";let o=!1;return Vs(r,t,e,(l,c,h)=>{l[a]&&l[a](e[t],s)&&(i.push({element:l,datasetIndex:c,index:h}),o=o||l.inRange(e.x,e.y,s))}),n&&!o?[]:i}var R1={evaluateInteractionItems:Vs,modes:{index(r,e,t,n){const s=Qr(e,r),i=t.axis||"x",a=t.includeInvisible||!1,o=t.intersect?Ja(r,s,i,n,a):Za(r,s,i,!1,n,a),l=[];return o.length?(r.getSortedVisibleDatasetMetas().forEach(c=>{const h=o[0].index,f=c.data[h];f&&!f.skip&&l.push({element:f,datasetIndex:c.index,index:h})}),l):[]},dataset(r,e,t,n){const s=Qr(e,r),i=t.axis||"xy",a=t.includeInvisible||!1;let o=t.intersect?Ja(r,s,i,n,a):Za(r,s,i,!1,n,a);if(o.length>0){const l=o[0].datasetIndex,c=r.getDatasetMeta(l).data;o=[];for(let h=0;h<c.length;++h)o.push({element:c[h],datasetIndex:l,index:h})}return o},point(r,e,t,n){const s=Qr(e,r),i=t.axis||"xy",a=t.includeInvisible||!1;return Ja(r,s,i,n,a)},nearest(r,e,t,n){const s=Qr(e,r),i=t.axis||"xy",a=t.includeInvisible||!1;return Za(r,s,i,t.intersect,n,a)},x(r,e,t,n){const s=Qr(e,r);return Oc(r,s,"x",t.intersect,n)},y(r,e,t,n){const s=Qr(e,r);return Oc(r,s,"y",t.intersect,n)}}};const ld=["left","top","right","bottom"];function ts(r,e){return r.filter(t=>t.pos===e)}function Fc(r,e){return r.filter(t=>ld.indexOf(t.pos)===-1&&t.box.axis===e)}function rs(r,e){return r.sort((t,n)=>{const s=e?n:t,i=e?t:n;return s.weight===i.weight?s.index-i.index:s.weight-i.weight})}function j1(r){const e=[];let t,n,s,i,a,o;for(t=0,n=(r||[]).length;t<n;++t)s=r[t],{position:i,options:{stack:a,stackWeight:o=1}}=s,e.push({index:t,box:s,pos:i,horizontal:s.isHorizontal(),weight:s.weight,stack:a&&i+a,stackWeight:o});return e}function M1(r){const e={};for(const t of r){const{stack:n,pos:s,stackWeight:i}=t;if(!n||!ld.includes(s))continue;const a=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=i}return e}function L1(r,e){const t=M1(r),{vBoxMaxWidth:n,hBoxMaxHeight:s}=e;let i,a,o;for(i=0,a=r.length;i<a;++i){o=r[i];const{fullSize:l}=o.box,c=t[o.stack],h=c&&o.stackWeight/c.weight;o.horizontal?(o.width=h?h*n:l&&e.availableWidth,o.height=s):(o.width=n,o.height=h?h*s:l&&e.availableHeight)}return t}function B1(r){const e=j1(r),t=rs(e.filter(c=>c.box.fullSize),!0),n=rs(ts(e,"left"),!0),s=rs(ts(e,"right")),i=rs(ts(e,"top"),!0),a=rs(ts(e,"bottom")),o=Fc(e,"x"),l=Fc(e,"y");return{fullSize:t,leftAndTop:n.concat(i),rightAndBottom:s.concat(l).concat(a).concat(o),chartArea:ts(e,"chartArea"),vertical:n.concat(s).concat(l),horizontal:i.concat(a).concat(o)}}function Dc(r,e,t,n){return Math.max(r[t],e[t])+Math.max(r[n],e[n])}function cd(r,e){r.top=Math.max(r.top,e.top),r.left=Math.max(r.left,e.left),r.bottom=Math.max(r.bottom,e.bottom),r.right=Math.max(r.right,e.right)}function U1(r,e,t,n){const{pos:s,box:i}=t,a=r.maxPadding;if(!Te(s)){t.size&&(r[s]-=t.size);const f=n[t.stack]||{size:0,count:1};f.size=Math.max(f.size,t.horizontal?i.height:i.width),t.size=f.size/f.count,r[s]+=t.size}i.getPadding&&cd(a,i.getPadding());const o=Math.max(0,e.outerWidth-Dc(a,r,"left","right")),l=Math.max(0,e.outerHeight-Dc(a,r,"top","bottom")),c=o!==r.w,h=l!==r.h;return r.w=o,r.h=l,t.horizontal?{same:c,other:h}:{same:h,other:c}}function $1(r){const e=r.maxPadding;function t(n){const s=Math.max(e[n]-r[n],0);return r[n]+=s,s}r.y+=t("top"),r.x+=t("left"),t("right"),t("bottom")}function W1(r,e){const t=e.maxPadding;function n(s){const i={left:0,top:0,right:0,bottom:0};return s.forEach(a=>{i[a]=Math.max(e[a],t[a])}),i}return n(r?["left","right"]:["top","bottom"])}function hs(r,e,t,n){const s=[];let i,a,o,l,c,h;for(i=0,a=r.length,c=0;i<a;++i){o=r[i],l=o.box,l.update(o.width||e.w,o.height||e.h,W1(o.horizontal,e));const{same:f,other:u}=U1(e,t,o,n);c|=f&&s.length,h=h||u,l.fullSize||s.push(o)}return c&&hs(s,e,t,n)||h}function ui(r,e,t,n,s){r.top=t,r.left=e,r.right=e+n,r.bottom=t+s,r.width=n,r.height=s}function Ic(r,e,t,n){const s=t.padding;let{x:i,y:a}=e;for(const o of r){const l=o.box,c=n[o.stack]||{count:1,placed:0,weight:1},h=o.stackWeight/c.weight||1;if(o.horizontal){const f=e.w*h,u=c.size||l.height;Bi(c.start)&&(a=c.start),l.fullSize?ui(l,s.left,a,t.outerWidth-s.right-s.left,u):ui(l,e.left+c.placed,a,f,u),c.start=a,c.placed+=f,a=l.bottom}else{const f=e.h*h,u=c.size||l.width;Bi(c.start)&&(i=c.start),l.fullSize?ui(l,i,s.top,u,t.outerHeight-s.bottom-s.top):ui(l,i,e.top+c.placed,u,f),c.start=i,c.placed+=f,i=l.right}}e.x=i,e.y=a}var Ir={addBox(r,e){r.boxes||(r.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},r.boxes.push(e)},removeBox(r,e){const t=r.boxes?r.boxes.indexOf(e):-1;t!==-1&&r.boxes.splice(t,1)},configure(r,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(r,e,t,n){if(!r)return;const s=er(r.options.layout.padding),i=Math.max(e-s.width,0),a=Math.max(t-s.height,0),o=B1(r.boxes),l=o.vertical,c=o.horizontal;Fe(r.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const h=l.reduce((m,x)=>x.box.options&&x.box.options.display===!1?m:m+1,0)||1,f=Object.freeze({outerWidth:e,outerHeight:t,padding:s,availableWidth:i,availableHeight:a,vBoxMaxWidth:i/2/h,hBoxMaxHeight:a/2}),u=Object.assign({},s);cd(u,er(n));const g=Object.assign({maxPadding:u,w:i,h:a,x:s.left,y:s.top},s),p=L1(l.concat(c),f);hs(o.fullSize,g,f,p),hs(l,g,f,p),hs(c,g,f,p)&&hs(l,g,f,p),$1(g),Ic(o.leftAndTop,g,f,p),g.x+=g.w,g.y+=g.h,Ic(o.rightAndBottom,g,f,p),r.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},Fe(o.chartArea,m=>{const x=m.box;Object.assign(x,r.chartArea),x.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}};class hd{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,s){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,s?Math.floor(t/s):n)}}isAttached(e){return!0}updateConfig(e){}}class H1 extends hd{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Ai="$chartjs",z1={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Pc=r=>r===null||r==="";function V1(r,e){const t=r.style,n=r.getAttribute("height"),s=r.getAttribute("width");if(r[Ai]={initial:{height:n,width:s,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",Pc(s)){const i=kc(r,"width");i!==void 0&&(r.width=i)}if(Pc(n))if(r.style.height==="")r.height=r.width/(e||2);else{const i=kc(r,"height");i!==void 0&&(r.height=i)}return r}const dd=h1?{passive:!0}:!1;function G1(r,e,t){r&&r.addEventListener(e,t,dd)}function X1(r,e,t){r&&r.canvas&&r.canvas.removeEventListener(e,t,dd)}function K1(r,e){const t=z1[r.type]||r.type,{x:n,y:s}=Qr(r,e);return{type:t,chart:e,native:r,x:n!==void 0?n:null,y:s!==void 0?s:null}}function Vi(r,e){for(const t of r)if(t===e||t.contains(e))return!0}function Y1(r,e,t){const n=r.canvas,s=new MutationObserver(i=>{let a=!1;for(const o of i)a=a||Vi(o.addedNodes,n),a=a&&!Vi(o.removedNodes,n);a&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}function q1(r,e,t){const n=r.canvas,s=new MutationObserver(i=>{let a=!1;for(const o of i)a=a||Vi(o.removedNodes,n),a=a&&!Vi(o.addedNodes,n);a&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}const Is=new Map;let Rc=0;function fd(){const r=window.devicePixelRatio;r!==Rc&&(Rc=r,Is.forEach((e,t)=>{t.currentDevicePixelRatio!==r&&e()}))}function J1(r,e){Is.size||window.addEventListener("resize",fd),Is.set(r,e)}function Z1(r){Is.delete(r),Is.size||window.removeEventListener("resize",fd)}function Q1(r,e,t){const n=r.canvas,s=n&&Qo(n);if(!s)return;const i=Xh((o,l)=>{const c=s.clientWidth;t(o,l),c<s.clientWidth&&t()},window),a=new ResizeObserver(o=>{const l=o[0],c=l.contentRect.width,h=l.contentRect.height;c===0&&h===0||i(c,h)});return a.observe(s),J1(r,i),a}function Qa(r,e,t){t&&t.disconnect(),e==="resize"&&Z1(r)}function ev(r,e,t){const n=r.canvas,s=Xh(i=>{r.ctx!==null&&t(K1(i,r))},r);return G1(n,e,s),s}class tv extends hd{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(V1(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[Ai])return!1;const n=t[Ai].initial;["height","width"].forEach(i=>{const a=n[i];xt(a)?t.removeAttribute(i):t.setAttribute(i,a)});const s=n.style||{};return Object.keys(s).forEach(i=>{t.style[i]=s[i]}),t.width=t.width,delete t[Ai],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const s=e.$proxies||(e.$proxies={}),a={attach:Y1,detach:q1,resize:Q1}[t]||ev;s[t]=a(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),s=n[t];if(!s)return;({attach:Qa,detach:Qa,resize:Qa}[t]||X1)(e,t,s),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,s){return c1(e,t,n,s)}isAttached(e){const t=e&&Qo(e);return!!(t&&t.isConnected)}}function rv(r){return!Zo()||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas?H1:tv}class hn{constructor(){ye(this,"x");ye(this,"y");ye(this,"active",!1);ye(this,"options");ye(this,"$animations")}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return $i(this.x)&&$i(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const s={};return e.forEach(i=>{s[i]=n[i]&&n[i].active()?n[i]._to:this[i]}),s}}ye(hn,"defaults",{}),ye(hn,"defaultRoutes");function nv(r,e){const t=r.options.ticks,n=sv(r),s=Math.min(t.maxTicksLimit||n,n),i=t.major.enabled?av(e):[],a=i.length,o=i[0],l=i[a-1],c=[];if(a>s)return ov(e,c,i,a/s),c;const h=iv(i,e,s);if(a>0){let f,u;const g=a>1?Math.round((l-o)/(a-1)):null;for(gi(e,c,h,xt(g)?0:o-g,o),f=0,u=a-1;f<u;f++)gi(e,c,h,i[f],i[f+1]);return gi(e,c,h,l,xt(g)?e.length:l+g),c}return gi(e,c,h),c}function sv(r){const e=r.options.offset,t=r._tickSize(),n=r._length/t+(e?0:1),s=r._maxLength/t;return Math.floor(Math.min(n,s))}function iv(r,e,t){const n=lv(r),s=e.length/t;if(!n)return Math.max(s,1);const i=yp(n);for(let a=0,o=i.length-1;a<o;a++){const l=i[a];if(l>s)return l}return Math.max(s,1)}function av(r){const e=[];let t,n;for(t=0,n=r.length;t<n;t++)r[t].major&&e.push(t);return e}function ov(r,e,t,n){let s=0,i=t[0],a;for(n=Math.ceil(n),a=0;a<r.length;a++)a===i&&(e.push(r[a]),s++,i=t[s*n])}function gi(r,e,t,n,s){const i=De(n,0),a=Math.min(De(s,r.length),r.length);let o=0,l,c,h;for(t=Math.ceil(t),s&&(l=s-n,t=l/Math.floor(l/t)),h=i;h<0;)o++,h=Math.round(i+o*t);for(c=Math.max(i,0);c<a;c++)c===h&&(e.push(r[c]),o++,h=Math.round(i+o*t))}function lv(r){const e=r.length;let t,n;if(e<2)return!1;for(n=r[0],t=1;t<e;++t)if(r[t]-r[t-1]!==n)return!1;return n}const cv=r=>r==="left"?"right":r==="right"?"left":r,jc=(r,e,t)=>e==="top"||e==="left"?r[e]+t:r[e]-t,Mc=(r,e)=>Math.min(e||r,r);function Lc(r,e){const t=[],n=r.length/e,s=r.length;let i=0;for(;i<s;i+=n)t.push(r[Math.floor(i)]);return t}function hv(r,e,t){const n=r.ticks.length,s=Math.min(e,n-1),i=r._startPixel,a=r._endPixel,o=1e-6;let l=r.getPixelForTick(s),c;if(!(t&&(n===1?c=Math.max(l-i,a-l):e===0?c=(r.getPixelForTick(1)-l)/2:c=(l-r.getPixelForTick(s-1))/2,l+=s<e?c:-c,l<i-o||l>a+o)))return l}function dv(r,e){Fe(r,t=>{const n=t.gc,s=n.length/2;let i;if(s>e){for(i=0;i<s;++i)delete t.data[n[i]];n.splice(0,s)}})}function ns(r){return r.drawTicks?r.tickLength:0}function Bc(r,e){if(!r.display)return 0;const t=Et(r.font,e),n=er(r.padding);return(ct(r.text)?r.text.length:1)*t.lineHeight+n.height}function fv(r,e){return Vn(r,{scale:e,type:"scale"})}function uv(r,e,t){return Vn(r,{tick:t,index:e,type:"tick"})}function gv(r,e,t){let n=Kh(r);return(t&&e!=="right"||!t&&e==="right")&&(n=cv(n)),n}function mv(r,e,t,n){const{top:s,left:i,bottom:a,right:o,chart:l}=r,{chartArea:c,scales:h}=l;let f=0,u,g,p;const m=a-s,x=o-i;if(r.isHorizontal()){if(g=Ft(n,i,o),Te(t)){const v=Object.keys(t)[0],b=t[v];p=h[v].getPixelForValue(b)+m-e}else t==="center"?p=(c.bottom+c.top)/2+m-e:p=jc(r,t,e);u=o-i}else{if(Te(t)){const v=Object.keys(t)[0],b=t[v];g=h[v].getPixelForValue(b)-x+e}else t==="center"?g=(c.left+c.right)/2-x+e:g=jc(r,t,e);p=Ft(n,a,s),f=t==="left"?-et:et}return{titleX:g,titleY:p,maxWidth:u,rotation:f}}class va extends hn{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:s}=this;return e=nr(e,Number.POSITIVE_INFINITY),t=nr(t,Number.NEGATIVE_INFINITY),n=nr(n,Number.POSITIVE_INFINITY),s=nr(s,Number.NEGATIVE_INFINITY),{min:nr(e,n),max:nr(t,s),minDefined:kr(e),maxDefined:kr(t)}}getMinMax(e){let{min:t,max:n,minDefined:s,maxDefined:i}=this.getUserBounds(),a;if(s&&i)return{min:t,max:n};const o=this.getMatchingVisibleMetas();for(let l=0,c=o.length;l<c;++l)a=o[l].controller.getMinMax(this,e),s||(t=Math.min(t,a.min)),i||(n=Math.max(n,a.max));return t=i&&t>n?n:t,n=s&&t>n?t:n,{min:nr(t,nr(n,t)),max:nr(n,nr(t,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Be(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:s,grace:i,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Kp(this,i,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=o<this.ticks.length;this._convertTicksToLabels(l?Lc(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=nv(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,n;this.isHorizontal()?(t=this.left,n=this.right):(t=this.top,n=this.bottom,e=!e),this._startPixel=t,this._endPixel=n,this._reversePixels=e,this._length=n-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Be(this.options.afterUpdate,[this])}beforeSetDimensions(){Be(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Be(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Be(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Be(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,s,i;for(n=0,s=e.length;n<s;n++)i=e[n],i.label=Be(t.callback,[i.value,n,e],this)}afterTickToLabelConversion(){Be(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Be(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=Mc(this.ticks.length,e.ticks.maxTicksLimit),s=t.minRotation||0,i=t.maxRotation;let a=s,o,l,c;if(!this._isVisible()||!t.display||s>=i||n<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),f=h.widest.width,u=h.highest.height,g=$t(this.chart.width-f,0,this.maxWidth);o=e.offset?this.maxWidth/n:g/(n-1),f+6>o&&(o=g/(n-(e.offset?.5:1)),l=this.maxHeight-ns(e.grid)-t.padding-Bc(e.title,this.chart.options.font),c=Math.sqrt(f*f+u*u),a=bp(Math.min(Math.asin($t((h.highest.height+6)/o,-1,1)),Math.asin($t(l/c,-1,1))-Math.asin($t(u/c,-1,1)))),a=Math.max(s,Math.min(i,a))),this.labelRotation=a}afterCalculateLabelRotation(){Be(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Be(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:s,grid:i}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const l=Bc(s,t.options.font);if(o?(e.width=this.maxWidth,e.height=ns(i)+l):(e.height=this.maxHeight,e.width=ns(i)+l),n.display&&this.ticks.length){const{first:c,last:h,widest:f,highest:u}=this._getLabelSizes(),g=n.padding*2,p=sn(this.labelRotation),m=Math.cos(p),x=Math.sin(p);if(o){const v=n.mirror?0:x*f.width+m*u.height;e.height=Math.min(this.maxHeight,e.height+v+g)}else{const v=n.mirror?0:m*f.width+x*u.height;e.width=Math.min(this.maxWidth,e.width+v+g)}this._calculatePadding(c,h,x,m)}}this._handleMargins(),o?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,s){const{ticks:{align:i,padding:a},position:o}=this.options,l=this.labelRotation!==0,c=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1);let u=0,g=0;l?c?(u=s*e.width,g=n*t.height):(u=n*e.height,g=s*t.width):i==="start"?g=t.width:i==="end"?u=e.width:i!=="inner"&&(u=e.width/2,g=t.width/2),this.paddingLeft=Math.max((u-h+a)*this.width/(this.width-h),0),this.paddingRight=Math.max((g-f+a)*this.width/(this.width-f),0)}else{let h=t.height/2,f=e.height/2;i==="start"?(h=0,f=e.height):i==="end"&&(h=t.height,f=0),this.paddingTop=h+a,this.paddingBottom=f+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Be(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,n;for(t=0,n=e.length;t<n;t++)xt(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=Lc(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:s,_longestTextCache:i}=this,a=[],o=[],l=Math.floor(t/Mc(t,n));let c=0,h=0,f,u,g,p,m,x,v,b,_,k,O;for(f=0;f<t;f+=l){if(p=e[f].label,m=this._resolveTickFontOptions(f),s.font=x=m.string,v=i[x]=i[x]||{data:{},gc:[]},b=m.lineHeight,_=k=0,!xt(p)&&!ct(p))_=pc(s,v.data,v.gc,_,p),k=b;else if(ct(p))for(u=0,g=p.length;u<g;++u)O=p[u],!xt(O)&&!ct(O)&&(_=pc(s,v.data,v.gc,_,O),k+=b);a.push(_),o.push(k),c=Math.max(_,c),h=Math.max(k,h)}dv(i,t);const P=a.indexOf(c),C=o.indexOf(h),R=D=>({width:a[D]||0,height:o[D]||0});return{first:R(0),last:R(t-1),widest:R(P),highest:R(C),widths:a,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return kp(this._alignToPixels?Yr(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=uv(this.getContext(),e,n))}return this.$context||(this.$context=fv(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=sn(this.labelRotation),n=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),i=this._getLabelSizes(),a=e.autoSkipPadding||0,o=i?i.widest.width+a:0,l=i?i.highest.height+a:0;return this.isHorizontal()?l*n>o*s?o/n:l/s:l*s<o*n?l/n:o/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,s=this.options,{grid:i,position:a,border:o}=s,l=i.offset,c=this.isHorizontal(),f=this.ticks.length+(l?1:0),u=ns(i),g=[],p=o.setContext(this.getContext()),m=p.display?p.width:0,x=m/2,v=function(me){return Yr(n,me,m)};let b,_,k,O,P,C,R,D,M,z,G,Z;if(a==="top")b=v(this.bottom),C=this.bottom-u,D=b-x,z=v(e.top)+x,Z=e.bottom;else if(a==="bottom")b=v(this.top),z=e.top,Z=v(e.bottom)-x,C=b+x,D=this.top+u;else if(a==="left")b=v(this.right),P=this.right-u,R=b-x,M=v(e.left)+x,G=e.right;else if(a==="right")b=v(this.left),M=e.left,G=v(e.right)-x,P=b+x,R=this.left+u;else if(t==="x"){if(a==="center")b=v((e.top+e.bottom)/2+.5);else if(Te(a)){const me=Object.keys(a)[0],ee=a[me];b=v(this.chart.scales[me].getPixelForValue(ee))}z=e.top,Z=e.bottom,C=b+x,D=C+u}else if(t==="y"){if(a==="center")b=v((e.left+e.right)/2);else if(Te(a)){const me=Object.keys(a)[0],ee=a[me];b=v(this.chart.scales[me].getPixelForValue(ee))}P=b-x,R=P-u,M=e.left,G=e.right}const Q=De(s.ticks.maxTicksLimit,f),V=Math.max(1,Math.ceil(f/Q));for(_=0;_<f;_+=V){const me=this.getContext(_),ee=i.setContext(me),B=o.setContext(me),le=ee.lineWidth,Ee=ee.color,Me=B.dash||[],N=B.dashOffset,U=ee.tickWidth,I=ee.tickColor,F=ee.tickBorderDash||[],Y=ee.tickBorderDashOffset;k=hv(this,_,l),k!==void 0&&(O=Yr(n,k,le),c?P=R=M=G=O:C=D=z=Z=O,g.push({tx1:P,ty1:C,tx2:R,ty2:D,x1:M,y1:z,x2:G,y2:Z,width:le,color:Ee,borderDash:Me,borderDashOffset:N,tickWidth:U,tickColor:I,tickBorderDash:F,tickBorderDashOffset:Y}))}return this._ticksLength=f,this._borderValue=b,g}_computeLabelItems(e){const t=this.axis,n=this.options,{position:s,ticks:i}=n,a=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:c,padding:h,mirror:f}=i,u=ns(n.grid),g=u+h,p=f?-h:g,m=-sn(this.labelRotation),x=[];let v,b,_,k,O,P,C,R,D,M,z,G,Z="middle";if(s==="top")P=this.bottom-p,C=this._getXAxisLabelAlignment();else if(s==="bottom")P=this.top+p,C=this._getXAxisLabelAlignment();else if(s==="left"){const V=this._getYAxisLabelAlignment(u);C=V.textAlign,O=V.x}else if(s==="right"){const V=this._getYAxisLabelAlignment(u);C=V.textAlign,O=V.x}else if(t==="x"){if(s==="center")P=(e.top+e.bottom)/2+g;else if(Te(s)){const V=Object.keys(s)[0],me=s[V];P=this.chart.scales[V].getPixelForValue(me)+g}C=this._getXAxisLabelAlignment()}else if(t==="y"){if(s==="center")O=(e.left+e.right)/2-g;else if(Te(s)){const V=Object.keys(s)[0],me=s[V];O=this.chart.scales[V].getPixelForValue(me)}C=this._getYAxisLabelAlignment(u).textAlign}t==="y"&&(l==="start"?Z="top":l==="end"&&(Z="bottom"));const Q=this._getLabelSizes();for(v=0,b=o.length;v<b;++v){_=o[v],k=_.label;const V=i.setContext(this.getContext(v));R=this.getPixelForTick(v)+i.labelOffset,D=this._resolveTickFontOptions(v),M=D.lineHeight,z=ct(k)?k.length:1;const me=z/2,ee=V.color,B=V.textStrokeColor,le=V.textStrokeWidth;let Ee=C;a?(O=R,C==="inner"&&(v===b-1?Ee=this.options.reverse?"left":"right":v===0?Ee=this.options.reverse?"right":"left":Ee="center"),s==="top"?c==="near"||m!==0?G=-z*M+M/2:c==="center"?G=-Q.highest.height/2-me*M+M:G=-Q.highest.height+M/2:c==="near"||m!==0?G=M/2:c==="center"?G=Q.highest.height/2-me*M:G=Q.highest.height-z*M,f&&(G*=-1),m!==0&&!V.showLabelBackdrop&&(O+=M/2*Math.sin(m))):(P=R,G=(1-z)*M/2);let Me;if(V.showLabelBackdrop){const N=er(V.backdropPadding),U=Q.heights[v],I=Q.widths[v];let F=G-N.top,Y=0-N.left;switch(Z){case"middle":F-=U/2;break;case"bottom":F-=U;break}switch(C){case"center":Y-=I/2;break;case"right":Y-=I;break;case"inner":v===b-1?Y-=I:v>0&&(Y-=I/2);break}Me={left:Y,top:F,width:I+N.width,height:U+N.height,color:V.backdropColor}}x.push({label:k,font:D,textOffset:G,options:{rotation:m,color:ee,strokeColor:B,strokeWidth:le,textAlign:Ee,textBaseline:Z,translation:[O,P],backdrop:Me}})}return x}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-sn(this.labelRotation))return e==="top"?"left":"right";let s="center";return t.align==="start"?s="left":t.align==="end"?s="right":t.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:s,padding:i}}=this.options,a=this._getLabelSizes(),o=e+i,l=a.widest.width;let c,h;return t==="left"?s?(h=this.right+i,n==="near"?c="left":n==="center"?(c="center",h+=l/2):(c="right",h+=l)):(h=this.right-o,n==="near"?c="right":n==="center"?(c="center",h-=l/2):(c="left",h=this.left)):t==="right"?s?(h=this.left+i,n==="near"?c="right":n==="center"?(c="center",h-=l/2):(c="left",h-=l)):(h=this.left+o,n==="near"?c="left":n==="center"?(c="center",h+=l/2):(c="right",h=this.right)):c="right",{textAlign:c,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:s,width:i,height:a}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,s,i,a),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex(i=>i.value===e);return s>=0?t.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const t=this.options.grid,n=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,a;const o=(l,c,h)=>{!h.width||!h.color||(n.save(),n.lineWidth=h.width,n.strokeStyle=h.color,n.setLineDash(h.borderDash||[]),n.lineDashOffset=h.borderDashOffset,n.beginPath(),n.moveTo(l.x,l.y),n.lineTo(c.x,c.y),n.stroke(),n.restore())};if(t.display)for(i=0,a=s.length;i<a;++i){const l=s[i];t.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),t.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:s}}=this,i=n.setContext(this.getContext()),a=n.display?i.width:0;if(!a)return;const o=s.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,h,f,u;this.isHorizontal()?(c=Yr(e,this.left,a)-a/2,h=Yr(e,this.right,o)+o/2,f=u=l):(f=Yr(e,this.top,a)-a/2,u=Yr(e,this.bottom,o)+o/2,c=h=l),t.save(),t.lineWidth=i.width,t.strokeStyle=i.color,t.beginPath(),t.moveTo(c,f),t.lineTo(h,u),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,s=this._computeLabelArea();s&&Go(n,s);const i=this.getLabelItems(e);for(const a of i){const o=a.options,l=a.font,c=a.label,h=a.textOffset;Hi(n,c,0,h,l,o)}s&&Xo(n)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:s}}=this;if(!n.display)return;const i=Et(n.font),a=er(n.padding),o=n.align;let l=i.lineHeight/2;t==="bottom"||t==="center"||Te(t)?(l+=a.bottom,ct(n.text)&&(l+=i.lineHeight*(n.text.length-1))):l+=a.top;const{titleX:c,titleY:h,maxWidth:f,rotation:u}=mv(this,l,t,o);Hi(e,n.text,0,0,i,{color:n.color,maxWidth:f,rotation:u,textAlign:gv(o,t,s),textBaseline:"middle",translation:[c,h]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=De(e.grid&&e.grid.z,-1),s=De(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==va.prototype.draw?[{z:t,draw:i=>{this.draw(i)}}]:[{z:n,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:t,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",s=[];let i,a;for(i=0,a=t.length;i<a;++i){const o=t[i];o[n]===this.id&&(!e||o.type===e)&&s.push(o)}return s}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Et(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class mi{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;vv(t)&&(n=this.register(t));const s=this.items,i=e.id,a=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in s||(s[i]=e,xv(e,a,n),this.override&&Xe.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,s=this.scope;n in t&&delete t[n],s&&n in Xe[s]&&(delete Xe[s][n],this.override&&delete cn[n])}}function xv(r,e,t){const n=Fs(Object.create(null),[t?Xe.get(t):{},Xe.get(e),r.defaults]);Xe.set(e,n),r.defaultRoutes&&pv(e,r.defaultRoutes),r.descriptors&&Xe.describe(e,r.descriptors)}function pv(r,e){Object.keys(e).forEach(t=>{const n=t.split("."),s=n.pop(),i=[r].concat(n).join("."),a=e[t].split("."),o=a.pop(),l=a.join(".");Xe.route(i,s,l,o)})}function vv(r){return"id"in r&&"defaults"in r}class yv{constructor(){this.controllers=new mi(ws,"datasets",!0),this.elements=new mi(hn,"elements"),this.plugins=new mi(Object,"plugins"),this.scales=new mi(va,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,n){[...t].forEach(s=>{const i=n||this._getRegistryForType(s);n||i.isForType(s)||i===this.plugins&&s.id?this._exec(e,i,s):Fe(s,a=>{const o=n||this._getRegistryForType(a);this._exec(e,o,a)})})}_exec(e,t,n){const s=zo(e);Be(n["before"+s],[],n),t[e](n),Be(n["after"+s],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const s=t.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return s}}var lr=new yv;class _v{constructor(){this._init=[]}notify(e,t,n,s){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const i=s?this._descriptors(e).filter(s):this._descriptors(e),a=this._notify(i,e,t,n);return t==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),a}_notify(e,t,n,s){s=s||{};for(const i of e){const a=i.plugin,o=a[n],l=[t,s,i.options];if(Be(o,l,a)===!1&&s.cancelable)return!1}return!0}invalidate(){xt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,s=De(n.options&&n.options.plugins,{}),i=bv(n);return s===!1&&!t?[]:kv(e,i,s,t)}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,s=(i,a)=>i.filter(o=>!a.some(l=>o.plugin.id===l.plugin.id));this._notify(s(t,n),e,"stop"),this._notify(s(n,t),e,"start")}}function bv(r){const e={},t=[],n=Object.keys(lr.plugins.items);for(let i=0;i<n.length;i++)t.push(lr.getPlugin(n[i]));const s=r.plugins||[];for(let i=0;i<s.length;i++){const a=s[i];t.indexOf(a)===-1&&(t.push(a),e[a.id]=!0)}return{plugins:t,localIds:e}}function wv(r,e){return!e&&r===!1?null:r===!0?{}:r}function kv(r,{plugins:e,localIds:t},n,s){const i=[],a=r.getContext();for(const o of e){const l=o.id,c=wv(n[l],s);c!==null&&i.push({plugin:o,options:Sv(r.config,{plugin:o,local:t[l]},c,a)})}return i}function Sv(r,{plugin:e,local:t},n,s){const i=r.pluginScopeKeys(e),a=r.getOptionScopes(n,i);return t&&e.defaults&&a.push(e.defaults),r.createResolver(a,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Eo(r,e){const t=Xe.datasets[r]||{};return((e.datasets||{})[r]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function Tv(r,e){let t=r;return r==="_index_"?t=e:r==="_value_"&&(t=e==="x"?"y":"x"),t}function Ev(r,e){return r===e?"_index_":"_value_"}function Uc(r){if(r==="x"||r==="y"||r==="r")return r}function Av(r){if(r==="top"||r==="bottom")return"x";if(r==="left"||r==="right")return"y"}function Ao(r,...e){if(Uc(r))return r;for(const t of e){const n=t.axis||Av(t.position)||r.length>1&&Uc(r[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${r}' axis. Please provide 'axis' or 'position' option.`)}function $c(r,e,t){if(t[e+"AxisID"]===r)return{axis:e}}function Cv(r,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(n=>n.xAxisID===r||n.yAxisID===r);if(t.length)return $c(r,"x",t[0])||$c(r,"y",t[0])}return{}}function Nv(r,e){const t=cn[r.type]||{scales:{}},n=e.scales||{},s=Eo(r.type,e),i=Object.create(null);return Object.keys(n).forEach(a=>{const o=n[a];if(!Te(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const l=Ao(a,o,Cv(a,r),Xe.scales[o.type]),c=Ev(l,s),h=t.scales||{};i[a]=vs(Object.create(null),[{axis:l},o,h[l],h[c]])}),r.data.datasets.forEach(a=>{const o=a.type||r.type,l=a.indexAxis||Eo(o,e),h=(cn[o]||{}).scales||{};Object.keys(h).forEach(f=>{const u=Tv(f,l),g=a[u+"AxisID"]||u;i[g]=i[g]||Object.create(null),vs(i[g],[{axis:u},n[g],h[f]])})}),Object.keys(i).forEach(a=>{const o=i[a];vs(o,[Xe.scales[o.type],Xe.scale])}),i}function ud(r){const e=r.options||(r.options={});e.plugins=De(e.plugins,{}),e.scales=Nv(r,e)}function gd(r){return r=r||{},r.datasets=r.datasets||[],r.labels=r.labels||[],r}function Ov(r){return r=r||{},r.data=gd(r.data),ud(r),r}const Wc=new Map,md=new Set;function xi(r,e){let t=Wc.get(r);return t||(t=e(),Wc.set(r,t),md.add(t)),t}const ss=(r,e,t)=>{const n=Ds(e,t);n!==void 0&&r.add(n)};class Fv{constructor(e){this._config=Ov(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=gd(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),ud(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return xi(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return xi(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return xi(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,n=this.type;return xi(`${n}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const n=this._scopeCache;let s=n.get(e);return(!s||t)&&(s=new Map,n.set(e,s)),s}getOptionScopes(e,t,n){const{options:s,type:i}=this,a=this._cachedScopes(e,n),o=a.get(t);if(o)return o;const l=new Set;t.forEach(h=>{e&&(l.add(e),h.forEach(f=>ss(l,e,f))),h.forEach(f=>ss(l,s,f)),h.forEach(f=>ss(l,cn[i]||{},f)),h.forEach(f=>ss(l,Xe,f)),h.forEach(f=>ss(l,ko,f))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),md.has(t)&&a.set(t,c),c}chartOptionScopes(){const{options:e,type:t}=this;return[e,cn[t]||{},Xe.datasets[t]||{},{type:t},Xe,ko]}resolveNamedOptions(e,t,n,s=[""]){const i={$shared:!0},{resolver:a,subPrefixes:o}=Hc(this._resolverCache,e,s);let l=a;if(Iv(a,t)){i.$shared=!1,n=Lr(n)?n():n;const c=this.createResolver(e,n,o);l=$n(a,n,c)}for(const c of t)i[c]=l[c];return i}createResolver(e,t,n=[""],s){const{resolver:i}=Hc(this._resolverCache,e,n);return Te(t)?$n(i,t,void 0,s):i}}function Hc(r,e,t){let n=r.get(e);n||(n=new Map,r.set(e,n));const s=t.join();let i=n.get(s);return i||(i={resolver:Yo(e,t),subPrefixes:t.filter(o=>!o.toLowerCase().includes("hover"))},n.set(s,i)),i}const Dv=r=>Te(r)&&Object.getOwnPropertyNames(r).some(e=>Lr(r[e]));function Iv(r,e){const{isScriptable:t,isIndexable:n}=ed(r);for(const s of e){const i=t(s),a=n(s),o=(a||i)&&r[s];if(i&&(Lr(o)||Dv(o))||a&&ct(o))return!0}return!1}var Pv="4.5.0";const Rv=["top","bottom","left","right","chartArea"];function zc(r,e){return r==="top"||r==="bottom"||Rv.indexOf(r)===-1&&e==="x"}function Vc(r,e){return function(t,n){return t[r]===n[r]?t[e]-n[e]:t[r]-n[r]}}function Gc(r){const e=r.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Be(t&&t.onComplete,[r],e)}function jv(r){const e=r.chart,t=e.options.animation;Be(t&&t.onProgress,[r],e)}function xd(r){return Zo()&&typeof r=="string"?r=document.getElementById(r):r&&r.length&&(r=r[0]),r&&r.canvas&&(r=r.canvas),r}const Ci={},Xc=r=>{const e=xd(r);return Object.values(Ci).filter(t=>t.canvas===e).pop()};function Mv(r,e,t){const n=Object.keys(r);for(const s of n){const i=+s;if(i>=e){const a=r[s];delete r[s],(t>0||i>e)&&(r[i+t]=a)}}}function Lv(r,e,t,n){return!t||r.type==="mouseout"?null:n?e:r}var Cr;let ya=(Cr=class{static register(...e){lr.add(...e),Kc()}static unregister(...e){lr.remove(...e),Kc()}constructor(e,t){const n=this.config=new Fv(t),s=xd(e),i=Xc(s);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const a=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||rv(s)),this.platform.updateConfig(n);const o=this.platform.acquireContext(s,a.aspectRatio),l=o&&o.canvas,c=l&&l.height,h=l&&l.width;if(this.id=dp(),this.ctx=o,this.canvas=l,this.width=h,this.height=c,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new _v,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Cp(f=>this.update(f),a.resizeDelay||0),this._dataChanges=[],Ci[this.id]=this,!o||!l){console.error("Failed to create chart: can't acquire context from the given item");return}mr.listen(this,"complete",Gc),mr.listen(this,"progress",jv),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:s,_aspectRatio:i}=this;return xt(e)?t&&i?i:s?n/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return lr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():wc(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return vc(this.canvas,this.ctx),this}stop(){return mr.stop(this),this}resize(e,t){mr.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,s=this.canvas,i=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(s,e,t,i),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,wc(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),Be(n.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};Fe(t,(n,s)=>{n.id=s})}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,s=Object.keys(n).reduce((a,o)=>(a[o]=!1,a),{});let i=[];t&&(i=i.concat(Object.keys(t).map(a=>{const o=t[a],l=Ao(a,o),c=l==="r",h=l==="x";return{options:o,dposition:c?"chartArea":h?"bottom":"left",dtype:c?"radialLinear":h?"category":"linear"}}))),Fe(i,a=>{const o=a.options,l=o.id,c=Ao(l,o),h=De(o.type,a.dtype);(o.position===void 0||zc(o.position,c)!==zc(a.dposition))&&(o.position=a.dposition),s[l]=!0;let f=null;if(l in n&&n[l].type===h)f=n[l];else{const u=lr.getScale(h);f=new u({id:l,type:h,ctx:this.ctx,chart:this}),n[f.id]=f}f.init(o,e)}),Fe(s,(a,o)=>{a||delete n[o]}),Fe(n,a=>{Ir.configure(this,a,a.options),Ir.addBox(this,a)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((s,i)=>s.index-i.index),n>t){for(let s=t;s<n;++s)this._destroyDatasetMeta(s);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(Vc("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((n,s)=>{t.filter(i=>i===n._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,s;for(this._removeUnreferencedMetasets(),n=0,s=t.length;n<s;n++){const i=t[n];let a=this.getDatasetMeta(n);const o=i.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=o,a.indexAxis=i.indexAxis||Eo(o,this.options),a.order=i.order||0,a.index=n,a.label=""+i.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{const l=lr.getController(o),{datasetElementType:c,dataElementType:h}=Xe.datasets[o];Object.assign(l,{dataElementType:lr.getElement(h),datasetElementType:c&&lr.getElement(c)}),a.controller=new l(this,n),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){Fe(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let c=0,h=this.data.datasets.length;c<h;c++){const{controller:f}=this.getDatasetMeta(c),u=!s&&i.indexOf(f)===-1;f.buildOrUpdateElements(u),a=Math.max(+f.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),s||Fe(i,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Vc("z","_idx"));const{_active:o,_lastEvent:l}=this;l?this._eventHandler(l,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Fe(this.scales,e=>{Ir.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!lc(t,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:s,count:i}of t){const a=n==="_removeElements"?-i:i;Mv(e,s,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=i=>new Set(e.filter(a=>a[0]===i).map((a,o)=>o+","+a.splice(1).join(","))),s=n(0);for(let i=1;i<t;i++)if(!lc(s,n(i)))return;return Array.from(s).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ir.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],Fe(this.boxes,s=>{n&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,i)=>{s._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,Lr(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),s={meta:n,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(n.controller._update(t),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(mr.has(this)?this.attached&&!mr.running(this)&&mr.start(this):(this.draw(),Gc({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let s,i;for(s=0,i=t.length;s<i;++s){const a=t[s];(!e||a.visible)&&n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n={meta:e,index:e.index,cancelable:!0},s=g1(this,e);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(s&&Go(t,s),e.controller.draw(),s&&Xo(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return Qh(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,s){const i=R1.modes[t];return typeof i=="function"?i(this,e,n,s):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let s=n.filter(i=>i&&i._dataset===t).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(s)),s}getContext(){return this.$context||(this.$context=Vn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!t.hidden}setDatasetVisibility(e,t){const n=this.getDatasetMeta(e);n.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const s=n?"show":"hide",i=this.getDatasetMeta(e),a=i.controller._resolveAnimations(void 0,s);Bi(t)?(i.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),a.update(i,{visible:n}),this.update(o=>o.datasetIndex===e?s:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),mr.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),vc(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Ci[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(i,a)=>{t.addEventListener(this,i,a),e[i]=a},s=(i,a,o)=>{i.offsetX=a,i.offsetY=o,this._eventHandler(i)};Fe(this.options.events,i=>n(i,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(l,c)=>{t.addEventListener(this,l,c),e[l]=c},s=(l,c)=>{e[l]&&(t.removeEventListener(this,l,c),delete e[l])},i=(l,c)=>{this.canvas&&this.resize(l,c)};let a;const o=()=>{s("attach",o),this.attached=!0,this.resize(),n("resize",i),n("detach",a)};a=()=>{this.attached=!1,s("resize",i),this._stop(),this._resize(0,0),n("attach",o)},t.isAttached(this.canvas)?o():a()}unbindEvents(){Fe(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},Fe(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const s=n?"set":"remove";let i,a,o,l;for(t==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+s+"DatasetHoverStyle"]()),o=0,l=e.length;o<l;++o){a=e[o];const c=a&&this.getDatasetMeta(a.datasetIndex).controller;c&&c[s+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map(({datasetIndex:i,index:a})=>{const o=this.getDatasetMeta(i);if(!o)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:o.data[a],index:a}});!Mi(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,n){const s=this.options.hover,i=(l,c)=>l.filter(h=>!c.some(f=>h.datasetIndex===f.datasetIndex&&h.index===f.index)),a=i(t,e),o=n?e:i(e,t);a.length&&this.updateHoverStyle(a,s.mode,!1),o.length&&s.mode&&this.updateHoverStyle(o,s.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,s)===!1)return;const i=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,s),(i||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:s=[],options:i}=this,a=t,o=this._getActiveElements(e,s,n,a),l=pp(e),c=Lv(e,this._lastEvent,n,l);n&&(this._lastEvent=null,Be(i.onHover,[e,o,this],this),l&&Be(i.onClick,[e,o,this],this));const h=!Mi(o,s);return(h||t)&&(this._active=o,this._updateHoverStyles(o,s,t)),this._lastEvent=c,h}_getActiveElements(e,t,n,s){if(e.type==="mouseout")return[];if(!n)return t;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,s)}},ye(Cr,"defaults",Xe),ye(Cr,"instances",Ci),ye(Cr,"overrides",cn),ye(Cr,"registry",lr),ye(Cr,"version",Pv),ye(Cr,"getChart",Xc),Cr);function Kc(){return Fe(ya.instances,r=>r._plugins.invalidate())}function Bv(r,e,t){const{startAngle:n,x:s,y:i,outerRadius:a,innerRadius:o,options:l}=e,{borderWidth:c,borderJoinStyle:h}=l,f=Math.min(c/a,cr(n-t));if(r.beginPath(),r.arc(s,i,a-c/2,n+f/2,t-f/2),o>0){const u=Math.min(c/o,cr(n-t));r.arc(s,i,o+c/2,t-u/2,n+u/2,!0)}else{const u=Math.min(c/2,a*cr(n-t));if(h==="round")r.arc(s,i,u,t-Ue/2,n+Ue/2,!0);else if(h==="bevel"){const g=2*u*u,p=-g*Math.cos(t+Ue/2)+s,m=-g*Math.sin(t+Ue/2)+i,x=g*Math.cos(n+Ue/2)+s,v=g*Math.sin(n+Ue/2)+i;r.lineTo(p,m),r.lineTo(x,v)}}r.closePath(),r.moveTo(0,0),r.rect(0,0,r.canvas.width,r.canvas.height),r.clip("evenodd")}function Uv(r,e,t){const{startAngle:n,pixelMargin:s,x:i,y:a,outerRadius:o,innerRadius:l}=e;let c=s/o;r.beginPath(),r.arc(i,a,o,n-c,t+c),l>s?(c=s/l,r.arc(i,a,l,t+c,n-c,!0)):r.arc(i,a,s,t+et,n-et),r.closePath(),r.clip()}function $v(r){return Ko(r,["outerStart","outerEnd","innerStart","innerEnd"])}function Wv(r,e,t,n){const s=$v(r.options.borderRadius),i=(t-e)/2,a=Math.min(i,n*e/2),o=l=>{const c=(t-Math.min(i,l))*n/2;return $t(l,0,Math.min(i,c))};return{outerStart:o(s.outerStart),outerEnd:o(s.outerEnd),innerStart:$t(s.innerStart,0,a),innerEnd:$t(s.innerEnd,0,a)}}function En(r,e,t,n){return{x:t+r*Math.cos(e),y:n+r*Math.sin(e)}}function Gi(r,e,t,n,s,i){const{x:a,y:o,startAngle:l,pixelMargin:c,innerRadius:h}=e,f=Math.max(e.outerRadius+n+t-c,0),u=h>0?h+n+t+c:0;let g=0;const p=s-l;if(n){const V=h>0?h-n:0,me=f>0?f-n:0,ee=(V+me)/2,B=ee!==0?p*ee/(ee+n):p;g=(p-B)/2}const m=Math.max(.001,p*f-t/Ue)/f,x=(p-m)/2,v=l+x+g,b=s-x-g,{outerStart:_,outerEnd:k,innerStart:O,innerEnd:P}=Wv(e,u,f,b-v),C=f-_,R=f-k,D=v+_/C,M=b-k/R,z=u+O,G=u+P,Z=v+O/z,Q=b-P/G;if(r.beginPath(),i){const V=(D+M)/2;if(r.arc(a,o,f,D,V),r.arc(a,o,f,V,M),k>0){const le=En(R,M,a,o);r.arc(le.x,le.y,k,M,b+et)}const me=En(G,b,a,o);if(r.lineTo(me.x,me.y),P>0){const le=En(G,Q,a,o);r.arc(le.x,le.y,P,b+et,Q+Math.PI)}const ee=(b-P/u+(v+O/u))/2;if(r.arc(a,o,u,b-P/u,ee,!0),r.arc(a,o,u,ee,v+O/u,!0),O>0){const le=En(z,Z,a,o);r.arc(le.x,le.y,O,Z+Math.PI,v-et)}const B=En(C,v,a,o);if(r.lineTo(B.x,B.y),_>0){const le=En(C,D,a,o);r.arc(le.x,le.y,_,v-et,D)}}else{r.moveTo(a,o);const V=Math.cos(D)*f+a,me=Math.sin(D)*f+o;r.lineTo(V,me);const ee=Math.cos(M)*f+a,B=Math.sin(M)*f+o;r.lineTo(ee,B)}r.closePath()}function Hv(r,e,t,n,s){const{fullCircles:i,startAngle:a,circumference:o}=e;let l=e.endAngle;if(i){Gi(r,e,t,n,l,s);for(let c=0;c<i;++c)r.fill();isNaN(o)||(l=a+(o%qe||qe))}return Gi(r,e,t,n,l,s),r.fill(),l}function zv(r,e,t,n,s){const{fullCircles:i,startAngle:a,circumference:o,options:l}=e,{borderWidth:c,borderJoinStyle:h,borderDash:f,borderDashOffset:u,borderRadius:g}=l,p=l.borderAlign==="inner";if(!c)return;r.setLineDash(f||[]),r.lineDashOffset=u,p?(r.lineWidth=c*2,r.lineJoin=h||"round"):(r.lineWidth=c,r.lineJoin=h||"bevel");let m=e.endAngle;if(i){Gi(r,e,t,n,m,s);for(let x=0;x<i;++x)r.stroke();isNaN(o)||(m=a+(o%qe||qe))}p&&Uv(r,e,m),l.selfJoin&&m-a>=Ue&&g===0&&h!=="miter"&&Bv(r,e,m),i||(Gi(r,e,t,n,m,s),r.stroke())}class ds extends hn{constructor(t){super();ye(this,"circumference");ye(this,"endAngle");ye(this,"fullCircles");ye(this,"innerRadius");ye(this,"outerRadius");ye(this,"pixelMargin");ye(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,s){const i=this.getProps(["x","y"],s),{angle:a,distance:o}=zh(i,{x:t,y:n}),{startAngle:l,endAngle:c,innerRadius:h,outerRadius:f,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),g=(this.options.spacing+this.options.borderWidth)/2,p=De(u,c-l),m=Wi(a,l,c)&&l!==c,x=p>=qe||m,v=ls(o,h+g,f+g);return x&&v}getCenterPoint(t){const{x:n,y:s,startAngle:i,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:c,spacing:h}=this.options,f=(i+a)/2,u=(o+l+h+c)/2;return{x:n+Math.cos(f)*u,y:s+Math.sin(f)*u}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:s}=this,i=(n.offset||0)/4,a=(n.spacing||0)/2,o=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>qe?Math.floor(s/qe):0,s===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const l=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(l)*i,Math.sin(l)*i);const c=1-Math.sin(Math.min(Ue,s||0)),h=i*c;t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,Hv(t,this,h,a,o),zv(t,this,h,a,o),t.restore()}}ye(ds,"id","arc"),ye(ds,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),ye(ds,"defaultRoutes",{backgroundColor:"backgroundColor"}),ye(ds,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});const Yc=(r,e)=>{let{boxHeight:t=e,boxWidth:n=e}=r;return r.usePointStyle&&(t=Math.min(t,e),n=r.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:t,itemHeight:Math.max(e,t)}},Vv=(r,e)=>r!==null&&e!==null&&r.datasetIndex===e.datasetIndex&&r.index===e.index;class qc extends hn{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Be(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(n=>e.filter(n,this.chart.data))),e.sort&&(t=t.sort((n,s)=>e.sort(n,s,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,s=Et(n.font),i=s.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=Yc(n,i);let c,h;t.font=s.string,this.isHorizontal()?(c=this.maxWidth,h=this._fitRows(a,i,o,l)+10):(h=this.maxHeight,c=this._fitCols(a,s,o,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(h,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,s){const{ctx:i,maxWidth:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],h=s+o;let f=e;i.textAlign="left",i.textBaseline="middle";let u=-1,g=-h;return this.legendItems.forEach((p,m)=>{const x=n+t/2+i.measureText(p.text).width;(m===0||c[c.length-1]+x+2*o>a)&&(f+=h,c[c.length-(m>0?0:1)]=0,g+=h,u++),l[m]={left:0,top:g,row:u,width:x,height:s},c[c.length-1]+=x+o}),f}_fitCols(e,t,n,s){const{ctx:i,maxHeight:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],h=a-e;let f=o,u=0,g=0,p=0,m=0;return this.legendItems.forEach((x,v)=>{const{itemWidth:b,itemHeight:_}=Gv(n,t,i,x,s);v>0&&g+_+2*o>h&&(f+=u+o,c.push({width:u,height:g}),p+=u+o,m++,u=g=0),l[v]={left:p,top:g,col:m,width:b,height:_},u=Math.max(u,b),g+=_+o}),f+=u,c.push({width:u,height:g}),f}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:s},rtl:i}}=this,a=Pn(i,this.left,this.width);if(this.isHorizontal()){let o=0,l=Ft(n,this.left+s,this.right-this.lineWidths[o]);for(const c of t)o!==c.row&&(o=c.row,l=Ft(n,this.left+s,this.right-this.lineWidths[o])),c.top+=this.top+e+s,c.left=a.leftForLtr(a.x(l),c.width),l+=c.width+s}else{let o=0,l=Ft(n,this.top+e+s,this.bottom-this.columnSizes[o].height);for(const c of t)c.col!==o&&(o=c.col,l=Ft(n,this.top+e+s,this.bottom-this.columnSizes[o].height)),c.top=l,c.left+=this.left+s,c.left=a.leftForLtr(a.x(c.left),c.width),l+=c.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Go(e,this),this._draw(),Xo(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:s}=this,{align:i,labels:a}=e,o=Xe.color,l=Pn(e.rtl,this.left,this.width),c=Et(a.font),{padding:h}=a,f=c.size,u=f/2;let g;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=c.string;const{boxWidth:p,boxHeight:m,itemHeight:x}=Yc(a,f),v=function(P,C,R){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;s.save();const D=De(R.lineWidth,1);if(s.fillStyle=De(R.fillStyle,o),s.lineCap=De(R.lineCap,"butt"),s.lineDashOffset=De(R.lineDashOffset,0),s.lineJoin=De(R.lineJoin,"miter"),s.lineWidth=D,s.strokeStyle=De(R.strokeStyle,o),s.setLineDash(De(R.lineDash,[])),a.usePointStyle){const M={radius:m*Math.SQRT2/2,pointStyle:R.pointStyle,rotation:R.rotation,borderWidth:D},z=l.xPlus(P,p/2),G=C+u;Zh(s,M,z,G,a.pointStyleWidth&&p)}else{const M=C+Math.max((f-m)/2,0),z=l.leftForLtr(P,p),G=bs(R.borderRadius);s.beginPath(),Object.values(G).some(Z=>Z!==0)?So(s,{x:z,y:M,w:p,h:m,radius:G}):s.rect(z,M,p,m),s.fill(),D!==0&&s.stroke()}s.restore()},b=function(P,C,R){Hi(s,R.text,P,C+x/2,c,{strikethrough:R.hidden,textAlign:l.textAlign(R.textAlign)})},_=this.isHorizontal(),k=this._computeTitleHeight();_?g={x:Ft(i,this.left+h,this.right-n[0]),y:this.top+h+k,line:0}:g={x:this.left+h,y:Ft(i,this.top+k+h,this.bottom-t[0].height),line:0},sd(this.ctx,e.textDirection);const O=x+h;this.legendItems.forEach((P,C)=>{s.strokeStyle=P.fontColor,s.fillStyle=P.fontColor;const R=s.measureText(P.text).width,D=l.textAlign(P.textAlign||(P.textAlign=a.textAlign)),M=p+u+R;let z=g.x,G=g.y;l.setWidth(this.width),_?C>0&&z+M+h>this.right&&(G=g.y+=O,g.line++,z=g.x=Ft(i,this.left+h,this.right-n[g.line])):C>0&&G+O>this.bottom&&(z=g.x=z+t[g.line].width+h,g.line++,G=g.y=Ft(i,this.top+k+h,this.bottom-t[g.line].height));const Z=l.x(z);if(v(Z,G,P),z=Np(D,z+p+u,_?z+M:this.right,e.rtl),b(l.x(z),G,P),_)g.x+=M+h;else if(typeof P.text!="string"){const Q=c.lineHeight;g.y+=pd(P,Q)+h}else g.y+=O}),id(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=Et(t.font),s=er(t.padding);if(!t.display)return;const i=Pn(e.rtl,this.left,this.width),a=this.ctx,o=t.position,l=n.size/2,c=s.top+l;let h,f=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),h=this.top+c,f=Ft(e.align,f,this.right-u);else{const p=this.columnSizes.reduce((m,x)=>Math.max(m,x.height),0);h=c+Ft(e.align,this.top,this.bottom-p-e.labels.padding-this._computeTitleHeight())}const g=Ft(o,f,f+u);a.textAlign=i.textAlign(Kh(o)),a.textBaseline="middle",a.strokeStyle=t.color,a.fillStyle=t.color,a.font=n.string,Hi(a,t.text,g,h,n)}_computeTitleHeight(){const e=this.options.title,t=Et(e.font),n=er(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,s,i;if(ls(e,this.left,this.right)&&ls(t,this.top,this.bottom)){for(i=this.legendHitBoxes,n=0;n<i.length;++n)if(s=i[n],ls(e,s.left,s.left+s.width)&&ls(t,s.top,s.top+s.height))return this.legendItems[n]}return null}handleEvent(e){const t=this.options;if(!Yv(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,i=Vv(s,n);s&&!i&&Be(t.onLeave,[e,s,this],this),this._hoveredItem=n,n&&!i&&Be(t.onHover,[e,n,this],this)}else n&&Be(t.onClick,[e,n,this],this)}}function Gv(r,e,t,n,s){const i=Xv(n,r,e,t),a=Kv(s,n,e.lineHeight);return{itemWidth:i,itemHeight:a}}function Xv(r,e,t,n){let s=r.text;return s&&typeof s!="string"&&(s=s.reduce((i,a)=>i.length>a.length?i:a)),e+t.size/2+n.measureText(s).width}function Kv(r,e,t){let n=r;return typeof e.text!="string"&&(n=pd(e,t)),n}function pd(r,e){const t=r.text?r.text.length:0;return e*t}function Yv(r,e){return!!((r==="mousemove"||r==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(r==="click"||r==="mouseup"))}var qv={id:"legend",_element:qc,start(r,e,t){const n=r.legend=new qc({ctx:r.ctx,options:t,chart:r});Ir.configure(r,n,t),Ir.addBox(r,n)},stop(r){Ir.removeBox(r,r.legend),delete r.legend},beforeUpdate(r,e,t){const n=r.legend;Ir.configure(r,n,t),n.options=t},afterUpdate(r){const e=r.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(r,e){e.replay||r.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(r,e,t){const n=e.datasetIndex,s=t.chart;s.isDatasetVisible(n)?(s.hide(n),e.hidden=!0):(s.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:r=>r.chart.options.color,boxWidth:40,padding:10,generateLabels(r){const e=r.data.datasets,{labels:{usePointStyle:t,pointStyle:n,textAlign:s,color:i,useBorderRadius:a,borderRadius:o}}=r.legend.options;return r._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(t?0:void 0),h=er(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:c.borderColor,pointStyle:n||c.pointStyle,rotation:c.rotation,textAlign:s||c.textAlign,borderRadius:a&&(o||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:r=>r.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:r=>!r.startsWith("on"),labels:{_scriptable:r=>!["generateLabels","filter","sort"].includes(r)}}};const fs={average(r){if(!r.length)return!1;let e,t,n=new Set,s=0,i=0;for(e=0,t=r.length;e<t;++e){const o=r[e].element;if(o&&o.hasValue()){const l=o.tooltipPosition();n.add(l.x),s+=l.y,++i}}return i===0||n.size===0?!1:{x:[...n].reduce((o,l)=>o+l)/n.size,y:s/i}},nearest(r,e){if(!r.length)return!1;let t=e.x,n=e.y,s=Number.POSITIVE_INFINITY,i,a,o;for(i=0,a=r.length;i<a;++i){const l=r[i].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),h=wp(e,c);h<s&&(s=h,o=l)}}if(o){const l=o.tooltipPosition();t=l.x,n=l.y}return{x:t,y:n}}};function sr(r,e){return e&&(ct(e)?Array.prototype.push.apply(r,e):r.push(e)),r}function xr(r){return(typeof r=="string"||r instanceof String)&&r.indexOf(`
`)>-1?r.split(`
`):r}function Jv(r,e){const{element:t,datasetIndex:n,index:s}=e,i=r.getDatasetMeta(n).controller,{label:a,value:o}=i.getLabelAndValue(s);return{chart:r,label:a,parsed:i.getParsed(s),raw:r.data.datasets[n].data[s],formattedValue:o,dataset:i.getDataset(),dataIndex:s,datasetIndex:n,element:t}}function Jc(r,e){const t=r.chart.ctx,{body:n,footer:s,title:i}=r,{boxWidth:a,boxHeight:o}=e,l=Et(e.bodyFont),c=Et(e.titleFont),h=Et(e.footerFont),f=i.length,u=s.length,g=n.length,p=er(e.padding);let m=p.height,x=0,v=n.reduce((k,O)=>k+O.before.length+O.lines.length+O.after.length,0);if(v+=r.beforeBody.length+r.afterBody.length,f&&(m+=f*c.lineHeight+(f-1)*e.titleSpacing+e.titleMarginBottom),v){const k=e.displayColors?Math.max(o,l.lineHeight):l.lineHeight;m+=g*k+(v-g)*l.lineHeight+(v-1)*e.bodySpacing}u&&(m+=e.footerMarginTop+u*h.lineHeight+(u-1)*e.footerSpacing);let b=0;const _=function(k){x=Math.max(x,t.measureText(k).width+b)};return t.save(),t.font=c.string,Fe(r.title,_),t.font=l.string,Fe(r.beforeBody.concat(r.afterBody),_),b=e.displayColors?a+2+e.boxPadding:0,Fe(n,k=>{Fe(k.before,_),Fe(k.lines,_),Fe(k.after,_)}),b=0,t.font=h.string,Fe(r.footer,_),t.restore(),x+=p.width,{width:x,height:m}}function Zv(r,e){const{y:t,height:n}=e;return t<n/2?"top":t>r.height-n/2?"bottom":"center"}function Qv(r,e,t,n){const{x:s,width:i}=n,a=t.caretSize+t.caretPadding;if(r==="left"&&s+i+a>e.width||r==="right"&&s-i-a<0)return!0}function ey(r,e,t,n){const{x:s,width:i}=t,{width:a,chartArea:{left:o,right:l}}=r;let c="center";return n==="center"?c=s<=(o+l)/2?"left":"right":s<=i/2?c="left":s>=a-i/2&&(c="right"),Qv(c,r,e,t)&&(c="center"),c}function Zc(r,e,t){const n=t.yAlign||e.yAlign||Zv(r,t);return{xAlign:t.xAlign||e.xAlign||ey(r,e,t,n),yAlign:n}}function ty(r,e){let{x:t,width:n}=r;return e==="right"?t-=n:e==="center"&&(t-=n/2),t}function ry(r,e,t){let{y:n,height:s}=r;return e==="top"?n+=t:e==="bottom"?n-=s+t:n-=s/2,n}function Qc(r,e,t,n){const{caretSize:s,caretPadding:i,cornerRadius:a}=r,{xAlign:o,yAlign:l}=t,c=s+i,{topLeft:h,topRight:f,bottomLeft:u,bottomRight:g}=bs(a);let p=ty(e,o);const m=ry(e,l,c);return l==="center"?o==="left"?p+=c:o==="right"&&(p-=c):o==="left"?p-=Math.max(h,u)+s:o==="right"&&(p+=Math.max(f,g)+s),{x:$t(p,0,n.width-e.width),y:$t(m,0,n.height-e.height)}}function pi(r,e,t){const n=er(t.padding);return e==="center"?r.x+r.width/2:e==="right"?r.x+r.width-n.right:r.x+n.left}function e0(r){return sr([],xr(r))}function ny(r,e,t){return Vn(r,{tooltip:e,tooltipItems:t,type:"tooltip"})}function t0(r,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?r.override(t):r}const vd={beforeTitle:ur,title(r){if(r.length>0){const e=r[0],t=e.chart.data.labels,n=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return t[e.dataIndex]}return""},afterTitle:ur,beforeBody:ur,beforeLabel:ur,label(r){if(this&&this.options&&this.options.mode==="dataset")return r.label+": "+r.formattedValue||r.formattedValue;let e=r.dataset.label||"";e&&(e+=": ");const t=r.formattedValue;return xt(t)||(e+=t),e},labelColor(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:ur,afterBody:ur,beforeFooter:ur,footer:ur,afterFooter:ur};function kt(r,e,t,n){const s=r[e].call(t,n);return typeof s>"u"?vd[e].call(t,n):s}class Co extends hn{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),s=n.enabled&&t.options.animation&&n.animations,i=new ad(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=ny(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:n}=t,s=kt(n,"beforeTitle",this,e),i=kt(n,"title",this,e),a=kt(n,"afterTitle",this,e);let o=[];return o=sr(o,xr(s)),o=sr(o,xr(i)),o=sr(o,xr(a)),o}getBeforeBody(e,t){return e0(kt(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,s=[];return Fe(e,i=>{const a={before:[],lines:[],after:[]},o=t0(n,i);sr(a.before,xr(kt(o,"beforeLabel",this,i))),sr(a.lines,kt(o,"label",this,i)),sr(a.after,xr(kt(o,"afterLabel",this,i))),s.push(a)}),s}getAfterBody(e,t){return e0(kt(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,s=kt(n,"beforeFooter",this,e),i=kt(n,"footer",this,e),a=kt(n,"afterFooter",this,e);let o=[];return o=sr(o,xr(s)),o=sr(o,xr(i)),o=sr(o,xr(a)),o}_createItems(e){const t=this._active,n=this.chart.data,s=[],i=[],a=[];let o=[],l,c;for(l=0,c=t.length;l<c;++l)o.push(Jv(this.chart,t[l]));return e.filter&&(o=o.filter((h,f,u)=>e.filter(h,f,u,n))),e.itemSort&&(o=o.sort((h,f)=>e.itemSort(h,f,n))),Fe(o,h=>{const f=t0(e.callbacks,h);s.push(kt(f,"labelColor",this,h)),i.push(kt(f,"labelPointStyle",this,h)),a.push(kt(f,"labelTextColor",this,h))}),this.labelColors=s,this.labelPointStyles=i,this.labelTextColors=a,this.dataPoints=o,o}update(e,t){const n=this.options.setContext(this.getContext()),s=this._active;let i,a=[];if(!s.length)this.opacity!==0&&(i={opacity:0});else{const o=fs[n.position].call(this,s,this._eventPosition);a=this._createItems(n),this.title=this.getTitle(a,n),this.beforeBody=this.getBeforeBody(a,n),this.body=this.getBody(a,n),this.afterBody=this.getAfterBody(a,n),this.footer=this.getFooter(a,n);const l=this._size=Jc(this,n),c=Object.assign({},o,l),h=Zc(this.chart,n,c),f=Qc(n,c,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,i={opacity:1,x:f.x,y:f.y,width:l.width,height:l.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,s){const i=this.getCaretPosition(e,n,s);t.lineTo(i.x1,i.y1),t.lineTo(i.x2,i.y2),t.lineTo(i.x3,i.y3)}getCaretPosition(e,t,n){const{xAlign:s,yAlign:i}=this,{caretSize:a,cornerRadius:o}=n,{topLeft:l,topRight:c,bottomLeft:h,bottomRight:f}=bs(o),{x:u,y:g}=e,{width:p,height:m}=t;let x,v,b,_,k,O;return i==="center"?(k=g+m/2,s==="left"?(x=u,v=x-a,_=k+a,O=k-a):(x=u+p,v=x+a,_=k-a,O=k+a),b=x):(s==="left"?v=u+Math.max(l,h)+a:s==="right"?v=u+p-Math.max(c,f)-a:v=this.caretX,i==="top"?(_=g,k=_-a,x=v-a,b=v+a):(_=g+m,k=_+a,x=v+a,b=v-a),O=_),{x1:x,x2:v,x3:b,y1:_,y2:k,y3:O}}drawTitle(e,t,n){const s=this.title,i=s.length;let a,o,l;if(i){const c=Pn(n.rtl,this.x,this.width);for(e.x=pi(this,n.titleAlign,n),t.textAlign=c.textAlign(n.titleAlign),t.textBaseline="middle",a=Et(n.titleFont),o=n.titleSpacing,t.fillStyle=n.titleColor,t.font=a.string,l=0;l<i;++l)t.fillText(s[l],c.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+o,l+1===i&&(e.y+=n.titleMarginBottom-o)}}_drawColorBox(e,t,n,s,i){const a=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:l,boxWidth:c}=i,h=Et(i.bodyFont),f=pi(this,"left",i),u=s.x(f),g=l<h.lineHeight?(h.lineHeight-l)/2:0,p=t.y+g;if(i.usePointStyle){const m={radius:Math.min(c,l)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},x=s.leftForLtr(u,c)+c/2,v=p+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,yc(e,m,x,v),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,yc(e,m,x,v)}else{e.lineWidth=Te(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const m=s.leftForLtr(u,c),x=s.leftForLtr(s.xPlus(u,1),c-2),v=bs(a.borderRadius);Object.values(v).some(b=>b!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,So(e,{x:m,y:p,w:c,h:l,radius:v}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),So(e,{x,y:p+1,w:c-2,h:l-2,radius:v}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(m,p,c,l),e.strokeRect(m,p,c,l),e.fillStyle=a.backgroundColor,e.fillRect(x,p+1,c-2,l-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:s}=this,{bodySpacing:i,bodyAlign:a,displayColors:o,boxHeight:l,boxWidth:c,boxPadding:h}=n,f=Et(n.bodyFont);let u=f.lineHeight,g=0;const p=Pn(n.rtl,this.x,this.width),m=function(R){t.fillText(R,p.x(e.x+g),e.y+u/2),e.y+=u+i},x=p.textAlign(a);let v,b,_,k,O,P,C;for(t.textAlign=a,t.textBaseline="middle",t.font=f.string,e.x=pi(this,x,n),t.fillStyle=n.bodyColor,Fe(this.beforeBody,m),g=o&&x!=="right"?a==="center"?c/2+h:c+2+h:0,k=0,P=s.length;k<P;++k){for(v=s[k],b=this.labelTextColors[k],t.fillStyle=b,Fe(v.before,m),_=v.lines,o&&_.length&&(this._drawColorBox(t,e,k,p,n),u=Math.max(f.lineHeight,l)),O=0,C=_.length;O<C;++O)m(_[O]),u=f.lineHeight;Fe(v.after,m)}g=0,u=f.lineHeight,Fe(this.afterBody,m),e.y-=i}drawFooter(e,t,n){const s=this.footer,i=s.length;let a,o;if(i){const l=Pn(n.rtl,this.x,this.width);for(e.x=pi(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=l.textAlign(n.footerAlign),t.textBaseline="middle",a=Et(n.footerFont),t.fillStyle=n.footerColor,t.font=a.string,o=0;o<i;++o)t.fillText(s[o],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+n.footerSpacing}}drawBackground(e,t,n,s){const{xAlign:i,yAlign:a}=this,{x:o,y:l}=e,{width:c,height:h}=n,{topLeft:f,topRight:u,bottomLeft:g,bottomRight:p}=bs(s.cornerRadius);t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.beginPath(),t.moveTo(o+f,l),a==="top"&&this.drawCaret(e,t,n,s),t.lineTo(o+c-u,l),t.quadraticCurveTo(o+c,l,o+c,l+u),a==="center"&&i==="right"&&this.drawCaret(e,t,n,s),t.lineTo(o+c,l+h-p),t.quadraticCurveTo(o+c,l+h,o+c-p,l+h),a==="bottom"&&this.drawCaret(e,t,n,s),t.lineTo(o+g,l+h),t.quadraticCurveTo(o,l+h,o,l+h-g),a==="center"&&i==="left"&&this.drawCaret(e,t,n,s),t.lineTo(o,l+f),t.quadraticCurveTo(o,l,o+f,l),t.closePath(),t.fill(),s.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,s=n&&n.x,i=n&&n.y;if(s||i){const a=fs[e.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=Jc(this,e),l=Object.assign({},a,this._size),c=Zc(t,e,l),h=Qc(e,l,c,t);(s._to!==h.x||i._to!==h.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const s={width:this.width,height:this.height},i={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const a=er(t.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&o&&(e.save(),e.globalAlpha=n,this.drawBackground(i,e,s,t),sd(e,t.textDirection),i.y+=a.top,this.drawTitle(i,e,t),this.drawBody(i,e,t),this.drawFooter(i,e,t),id(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,s=e.map(({datasetIndex:o,index:l})=>{const c=this.chart.getDatasetMeta(o);if(!c)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:c.data[l],index:l}}),i=!Mi(n,s),a=this._positionChanged(s,t);(i||a)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,n=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,i=this._active||[],a=this._getActiveElements(e,i,t,n),o=this._positionChanged(a,e),l=t||!Mi(a,i)||o;return l&&(this._active=a,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),l}_getActiveElements(e,t,n,s){const i=this.options;if(e.type==="mouseout")return[];if(!s)return t.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const a=this.chart.getElementsAtEventForMode(e,i.mode,i,n);return i.reverse&&a.reverse(),a}_positionChanged(e,t){const{caretX:n,caretY:s,options:i}=this,a=fs[i.position].call(this,e,t);return a!==!1&&(n!==a.x||s!==a.y)}}ye(Co,"positioners",fs);var sy={id:"tooltip",_element:Co,positioners:fs,afterInit(r,e,t){t&&(r.tooltip=new Co({chart:r,options:t}))},beforeUpdate(r,e,t){r.tooltip&&r.tooltip.initialize(t)},reset(r,e,t){r.tooltip&&r.tooltip.initialize(t)},afterDraw(r){const e=r.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(r.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(r.ctx),r.notifyPlugins("afterTooltipDraw",t)}},afterEvent(r,e){if(r.tooltip){const t=e.replay;r.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(r,e)=>e.bodyFont.size,boxWidth:(r,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:vd},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:r=>r!=="filter"&&r!=="itemSort"&&r!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const _a={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Tt=Object.keys(_a);function r0(r,e){return r-e}function n0(r,e){if(xt(e))return null;const t=r._adapter,{parser:n,round:s,isoWeekday:i}=r._parseOpts;let a=e;return typeof n=="function"&&(a=n(a)),kr(a)||(a=typeof n=="string"?t.parse(a,n):t.parse(a)),a===null?null:(s&&(a=s==="week"&&($i(i)||i===!0)?t.startOf(a,"isoWeek",i):t.startOf(a,s)),+a)}function s0(r,e,t,n){const s=Tt.length;for(let i=Tt.indexOf(r);i<s-1;++i){const a=_a[Tt[i]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((t-e)/(o*a.size))<=n)return Tt[i]}return Tt[s-1]}function iy(r,e,t,n,s){for(let i=Tt.length-1;i>=Tt.indexOf(t);i--){const a=Tt[i];if(_a[a].common&&r._adapter.diff(s,n,a)>=e-1)return a}return Tt[t?Tt.indexOf(t):0]}function ay(r){for(let e=Tt.indexOf(r)+1,t=Tt.length;e<t;++e)if(_a[Tt[e]].common)return Tt[e]}function i0(r,e,t){if(!t)r[e]=!0;else if(t.length){const{lo:n,hi:s}=Vo(t,e),i=t[n]>=e?t[n]:t[s];r[i]=!0}}function oy(r,e,t,n){const s=r._adapter,i=+s.startOf(e[0].value,n),a=e[e.length-1].value;let o,l;for(o=i;o<=a;o=+s.add(o,1,n))l=t[o],l>=0&&(e[l].major=!0);return e}function a0(r,e,t){const n=[],s={},i=e.length;let a,o;for(a=0;a<i;++a)o=e[a],s[o]=a,n.push({value:o,major:!1});return i===0||!t?n:oy(r,n,s,t)}class Xi extends va{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const n=e.time||(e.time={}),s=this._adapter=new O1._date(e.adapters.date);s.init(t),vs(n.displayFormats,s.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:n0(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:s,max:i,minDefined:a,maxDefined:o}=this.getUserBounds();function l(c){!a&&!isNaN(c.min)&&(s=Math.min(s,c.min)),!o&&!isNaN(c.max)&&(i=Math.max(i,c.max))}(!a||!o)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=kr(s)&&!isNaN(s)?s:+t.startOf(Date.now(),n),i=kr(i)&&!isNaN(i)?i:+t.endOf(Date.now(),n)+1,this.min=Math.min(s,i-1),this.max=Math.max(s+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,s=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const i=this.min,a=this.max,o=Tp(s,i,a);return this._unit=t.unit||(n.autoSkip?s0(t.minUnit,this.min,this.max,this._getLabelCapacity(i)):iy(this,o.length,t.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:ay(this._unit),this.initOffsets(s),e.reverse&&o.reverse(),a0(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,n=0,s,i;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?t=1-s:t=(this.getDecimalForValue(e[1])-s)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?n=i:n=(i-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;t=$t(t,0,a),n=$t(n,0,a),this._offsets={start:t,end:n,factor:1/(t+1+n)}}_generate(){const e=this._adapter,t=this.min,n=this.max,s=this.options,i=s.time,a=i.unit||s0(i.minUnit,t,n,this._getLabelCapacity(t)),o=De(s.ticks.stepSize,1),l=a==="week"?i.isoWeekday:!1,c=$i(l)||l===!0,h={};let f=t,u,g;if(c&&(f=+e.startOf(f,"isoWeek",l)),f=+e.startOf(f,c?"day":a),e.diff(n,t,a)>1e5*o)throw new Error(t+" and "+n+" are too far apart with stepSize of "+o+" "+a);const p=s.ticks.source==="data"&&this.getDataTimestamps();for(u=f,g=0;u<n;u=+e.add(u,o,a),g++)i0(h,u,p);return(u===n||s.bounds==="ticks"||g===1)&&i0(h,u,p),Object.keys(h).sort(r0).map(m=>+m)}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,i=this._unit,a=t||s[i];return this._adapter.format(e,a)}_tickFormatFunction(e,t,n,s){const i=this.options,a=i.ticks.callback;if(a)return Be(a,[e,t,n],this);const o=i.time.displayFormats,l=this._unit,c=this._majorUnit,h=l&&o[l],f=c&&o[c],u=n[t],g=c&&f&&u&&u.major;return this._adapter.format(e,s||(g?f:h))}generateTickLabels(e){let t,n,s;for(t=0,n=e.length;t<n;++t)s=e[t],s.label=this._tickFormatFunction(s.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,s=sn(this.isHorizontal()?t.maxRotation:t.minRotation),i=Math.cos(s),a=Math.sin(s),o=this._resolveTickFontOptions(0).size;return{w:n*i+o*a,h:n*a+o*i}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,s=n[t.unit]||n.millisecond,i=this._tickFormatFunction(e,0,a0(this,[e],this._majorUnit),s),a=this._getLabelSize(i),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],t,n;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,n=s.length;t<n;++t)e=e.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const s=this.getLabels();for(t=0,n=s.length;t<n;++t)e.push(n0(this,s[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Ap(e.sort(r0))}}ye(Xi,"id","time"),ye(Xi,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function vi(r,e,t){let n=0,s=r.length-1,i,a,o,l;t?(e>=r[n].pos&&e<=r[s].pos&&({lo:n,hi:s}=wo(r,"pos",e)),{pos:i,time:o}=r[n],{pos:a,time:l}=r[s]):(e>=r[n].time&&e<=r[s].time&&({lo:n,hi:s}=wo(r,"time",e)),{time:i,pos:o}=r[n],{time:a,pos:l}=r[s]);const c=a-i;return c?o+(l-o)*(e-i)/c:o}class o0 extends Xi{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=vi(t,this.min),this._tableRange=vi(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,s=[],i=[];let a,o,l,c,h;for(a=0,o=e.length;a<o;++a)c=e[a],c>=t&&c<=n&&s.push(c);if(s.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(a=0,o=s.length;a<o;++a)h=s[a+1],l=s[a-1],c=s[a],Math.round((h+l)/2)!==c&&i.push({time:c,pos:a/(o-1)});return i}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(t)||n.length===1)&&n.push(t),n.sort((s,i)=>s-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return t.length&&n.length?e=this.normalize(t.concat(n)):e=t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(vi(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return vi(this._table,n*this._tableRange+this._minPos,!0)}}ye(o0,"id","timeseries"),ye(o0,"defaults",Xi.defaults);const yd="label";function l0(r,e){typeof r=="function"?r(e):r&&(r.current=e)}function ly(r,e){const t=r.options;t&&e&&Object.assign(t,e)}function _d(r,e){r.labels=e}function bd(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:yd;const n=[];r.datasets=e.map(s=>{const i=r.datasets.find(a=>a[t]===s[t]);return!i||!s.data||n.includes(i)?{...s}:(n.push(i),Object.assign(i,s),i)})}function cy(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yd;const t={labels:[],datasets:[]};return _d(t,r.labels),bd(t,r.datasets,e),t}function hy(r,e){const{height:t=150,width:n=300,redraw:s=!1,datasetIdKey:i,type:a,data:o,options:l,plugins:c=[],fallbackContent:h,updateMode:f,...u}=r,g=J.useRef(null),p=J.useRef(null),m=()=>{g.current&&(p.current=new ya(g.current,{type:a,data:cy(o,i),options:l&&{...l},plugins:c}),l0(e,p.current))},x=()=>{l0(e,null),p.current&&(p.current.destroy(),p.current=null)};return J.useEffect(()=>{!s&&p.current&&l&&ly(p.current,l)},[s,l]),J.useEffect(()=>{!s&&p.current&&_d(p.current.config.data,o.labels)},[s,o.labels]),J.useEffect(()=>{!s&&p.current&&o.datasets&&bd(p.current.config.data,o.datasets,i)},[s,o.datasets]),J.useEffect(()=>{p.current&&(s?(x(),setTimeout(m)):p.current.update(f))},[s,l,o.labels,o.datasets,f]),J.useEffect(()=>{p.current&&(x(),setTimeout(m))},[a]),J.useEffect(()=>(m(),()=>x()),[]),Q0.createElement("canvas",{ref:g,role:"img",height:t,width:n,...u},h)}const dy=J.forwardRef(hy);function fy(r,e){return ya.register(e),J.forwardRef((t,n)=>Q0.createElement(dy,{...t,ref:n,type:r}))}const uy=fy("pie",To);ya.register(ds,sy,qv);function gy({data:r,title:e="Expenses by Category",className:t=""}){const n=r.filter(l=>l.amount>0);if(n.length===0)return d.jsxs("div",{className:`bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700 p-4 sm:p-6 ${t}`,children:[d.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[d.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center",children:d.jsx(Pa,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e})]}),d.jsxs("div",{className:"text-center py-8",children:[d.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:d.jsx(Pa,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),d.jsx("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-2",children:"No data to display"}),d.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Start adding transactions to see your spending breakdown"})]})]});const s={labels:n.map(l=>l.name),datasets:[{data:n.map(l=>l.amount),backgroundColor:n.map(l=>l.color),borderColor:n.map(l=>l.color),borderWidth:2,hoverBorderWidth:3,hoverOffset:8}]},i={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,pointStyle:"circle",font:{size:12},color:"rgb(107, 114, 128)"}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"white",bodyColor:"white",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(l){const c=l.label||"",h=l.parsed,f=l.dataset.data.reduce((p,m)=>p+m,0),u=(h/f*100).toFixed(1),g=n[l.dataIndex];return[`${c}: ₦${new Intl.NumberFormat("en-NG").format(h)}`,`${u}% of total`,`${g.transactionCount} transaction${g.transactionCount!==1?"s":""}`]}}}},animation:{animateRotate:!0,animateScale:!0,duration:1e3}},a=n.reduce((l,c)=>l+c.amount,0),o=n.reduce((l,c)=>l+c.transactionCount,0);return d.jsxs("div",{className:`bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700 p-4 sm:p-6 transition-colors duration-200 ${t}`,children:[d.jsx("div",{className:"flex items-center justify-between mb-6",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center",children:d.jsx(Pa,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e}),d.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[o," transaction",o!==1?"s":""," • ₦",new Intl.NumberFormat("en-NG").format(a)]})]})]})}),d.jsx("div",{className:"relative h-64 sm:h-80 mb-6",children:d.jsx(uy,{data:s,options:i})}),d.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n.length}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Categories"})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:o}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Transactions"})]}),d.jsxs("div",{className:"text-center col-span-2 sm:col-span-1",children:[d.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["₦",new Intl.NumberFormat("en-NG",{notation:"compact"}).format(a)]}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total Amount"})]})]})]})}const c0=({addToast:r})=>{const e=dr(),{user:t}=e,{accounts:n,transactions:s,categories:i,loadData:a,isOnline:o,syncInProgress:l}=Ht(),[c,h]=J.useState(null),[f,u]=J.useState(!1),[g,p]=J.useState("thisMonth"),[m,x]=J.useState([]);J.useEffect(()=>{t&&(a(t.id),v())},[t,a]);const v=async()=>{if(t)try{const{data:B,error:le}=await Le.from("user_profiles").select("full_name").eq("id",t.id).single();if(le){console.error("Error loading user profile:",le);return}h(B)}catch(B){console.error("Error loading user profile:",B)}},b=async()=>{if(!(!o||l||f)){u(!0);try{await or.sync(),t&&await a(t.id),r({type:"success",title:"Sync complete"})}catch(B){console.error("Manual sync failed:",B),r({type:"error",title:"Sync failed"})}finally{u(!1)}}},k=(()=>{const B=new Date;switch(g){case"thisMonth":return{start:nn(B),end:yr(B),label:Ge(B,"MMMM yyyy")};case"last3Months":return{start:nn(lh(B,2)),end:yr(B),label:"Last 3 months"};case"thisYear":return{start:Yu(B),end:yr(B),label:Ge(B,"yyyy")};case"allTime":return{start:new Date(0),end:yr(B),label:"All time"};default:return{start:nn(B),end:yr(B),label:Ge(B,"MMMM yyyy")}}})(),O=s.filter(B=>{const le=new Date(B.date);return le>=k.start&&le<=k.end}),P=O.filter(B=>B.type==="income").reduce((B,le)=>B+le.amount,0),C=O.filter(B=>B.type==="expense").reduce((B,le)=>B+le.amount,0),R=n.reduce((B,le)=>B+le.current_balance,0),D=P-C,M=i.filter(B=>B.type==="expense"),z=M.map(B=>{const le=O.filter(Me=>Me.type==="expense"&&Me.category_id===B.id&&(m.length===0||m.includes(B.id))),Ee=le.reduce((Me,N)=>Me+N.amount,0);return{id:B.id,name:B.name,amount:Ee,color:B.color,transactionCount:le.length}}).filter(B=>B.amount>0),G=[{title:"Total Balance",value:R,icon:la,color:"blue",bgColor:"bg-blue-50 dark:bg-blue-900/20",iconColor:"text-blue-600 dark:text-blue-400",borderColor:"border-blue-200 dark:border-blue-700"},{title:`Income (${k.label})`,value:P,icon:Ni,color:"green",bgColor:"bg-green-50 dark:bg-green-900/20",iconColor:"text-green-600 dark:text-green-400",borderColor:"border-green-200 dark:border-green-700"},{title:`Expenses (${k.label})`,value:C,icon:Dl,color:"red",bgColor:"bg-red-50 dark:bg-red-900/20",iconColor:"text-red-600 dark:text-red-400",borderColor:"border-red-200 dark:border-red-700"},{title:"Net Income",value:D,icon:D>=0?Ru:Dl,color:D>=0?"green":"red",bgColor:D>=0?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20",iconColor:D>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",borderColor:D>=0?"border-green-200 dark:border-green-700":"border-red-200 dark:border-red-700"}],Z=B=>`₦${new Intl.NumberFormat("en-NG").format(B)}`,Q=()=>{var le;const B=(le=c==null?void 0:c.full_name)==null?void 0:le.split(" ")[0];return B?`Hi, ${B}!`:"Welcome to ChurchTrack!"},V=n.some(B=>!B.is_synced)||s.some(B=>B.sync_status==="pending"),me=[{value:"thisMonth",label:"This Month"},{value:"last3Months",label:"Last 3 Months"},{value:"thisYear",label:"This Year"},{value:"allTime",label:"All Time"}],ee=B=>{x(le=>le.includes(B)?le.filter(Ee=>Ee!==B):[...le,B])};return d.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-4 sm:space-y-6 bg-gray-50 dark:bg-gray-950 transition-colors duration-200",children:[d.jsx("div",{className:"bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-700 dark:from-blue-500 dark:via-blue-600 dark:to-indigo-600 rounded-xl sm:rounded-2xl p-4 sm:p-6 text-white shadow-lg",children:d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-2",children:Q()}),d.jsxs("p",{className:"text-blue-100 text-sm sm:text-base opacity-90",children:["Here's the church financial overview for ",k.label]})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[V&&o&&d.jsxs("div",{className:"flex items-center gap-2 bg-blue-500/30 px-3 py-1.5 rounded-full",children:[d.jsx("div",{className:"w-2 h-2 bg-orange-300 rounded-full animate-pulse"}),d.jsx("span",{className:"text-xs font-medium text-blue-100",children:"Pending sync"})]}),d.jsxs("button",{onClick:b,disabled:!o||l||f,className:`
                flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium text-sm transition-all duration-200
                ${o&&!l&&!f?"bg-white/20 hover:bg-white/30 text-white border border-white/30 hover:border-white/50 hover:scale-105 active:scale-95 shadow-sm":"bg-white/10 text-white/60 border border-white/20 cursor-not-allowed"}
              `,title:o?"Synchronize your data":"You are offline",children:[d.jsx(Oi,{className:`w-4 h-4 ${l||f?"animate-spin":""}`}),d.jsx("span",{className:"hidden sm:inline",children:f?"Syncing...":"Sync Data"})]})]})]})}),d.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:G.map((B,le)=>{const Ee=B.icon;return d.jsxs("div",{className:`bg-white dark:bg-gray-900 rounded-xl border ${B.borderColor} p-3 sm:p-4 lg:p-6 hover:shadow-md dark:hover:shadow-lg transition-all duration-200 hover:scale-105`,children:[d.jsx("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:d.jsx("div",{className:`w-8 h-8 sm:w-10 sm:h-10 lg:w-12 lg:h-12 rounded-lg border ${B.borderColor} ${B.bgColor} flex items-center justify-center`,children:d.jsx(Ee,{className:`w-4 h-4 sm:w-5 sm:h-5 lg:w-6 lg:h-6 ${B.iconColor}`})})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:B.title}),d.jsx("p",{className:"text-sm sm:text-lg lg:text-2xl font-bold text-gray-900 dark:text-white",children:Z(B.value)})]})]},le)})}),d.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 sm:gap-6",children:[d.jsxs("div",{className:"xl:col-span-2",children:[d.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700 p-4 mb-4",children:d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(sh,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),d.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Period:"}),d.jsx("select",{value:g,onChange:B=>p(B.target.value),className:"px-3 py-1.5 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors duration-200",children:me.map(B=>d.jsx("option",{value:B.value,children:B.label},B.value))})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(ih,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),d.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Categories:"}),d.jsxs("div",{className:"flex flex-wrap gap-1",children:[d.jsx("button",{onClick:()=>x([]),className:`px-2 py-1 rounded text-xs font-medium transition-colors ${m.length===0?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:"All"}),M.slice(0,3).map(B=>d.jsx("button",{onClick:()=>ee(B.id),className:`px-2 py-1 rounded text-xs font-medium transition-colors ${m.includes(B.id)?"text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,style:m.includes(B.id)?{backgroundColor:B.color}:{},children:B.name},B.id)),M.length>3&&d.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1",children:["+",M.length-3," more"]})]})]})]})}),d.jsx(gy,{data:z,title:`Expenses by Category (${k.label})`})]}),d.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700 p-4 sm:p-6 transition-colors duration-200",children:[d.jsx("div",{className:"flex items-center justify-between mb-4",children:d.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[d.jsx(ju,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),"Accounts"]})}),d.jsxs("div",{className:"space-y-3",children:[n.slice(0,4).map(B=>d.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:[d.jsxs("div",{className:"min-w-0 flex-1",children:[d.jsx("p",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base truncate",children:B.name}),d.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 capitalize",children:B.type})]}),d.jsxs("div",{className:"text-right ml-3",children:[d.jsx("p",{className:"font-semibold text-gray-900 dark:text-white text-sm sm:text-base",children:Z(B.current_balance)}),!B.is_synced&&d.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full ml-auto mt-1"})]})]},B.id)),n.length===0&&d.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4 text-sm",children:"No accounts yet"})]})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700 p-4 sm:p-6 transition-colors duration-200",children:[d.jsx("div",{className:"flex items-center justify-between mb-4",children:d.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[d.jsx(Ni,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),"Recent Transactions"]})}),d.jsxs("div",{className:"space-y-3",children:[s.sort((B,le)=>new Date(le.created_at).getTime()-new Date(B.created_at).getTime()).slice(0,5).map(B=>{const le=n.find(Ee=>Ee.id===B.account_id);return d.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:[d.jsxs("div",{className:"min-w-0 flex-1",children:[d.jsx("p",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base truncate",children:B.description||"Transaction"}),d.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:[le==null?void 0:le.name," • ",Ge(new Date(B.date),"MMM d")]})]}),d.jsxs("div",{className:"text-right flex items-center gap-2 ml-3",children:[d.jsxs("p",{className:`font-semibold text-sm sm:text-base ${B.type==="income"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[B.type==="income"?"+":"-",Z(Math.abs(B.amount))]}),B.sync_status==="pending"&&d.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full flex-shrink-0"})]})]},B.id)}),s.length===0&&d.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4 text-sm",children:"No transactions yet"})]})]})]})]})]})};function my({onClose:r,onSuccess:e}){const[t,n]=J.useState(""),[s,i]=J.useState("checking"),[a,o]=J.useState(""),[l,c]=J.useState(!1),[h,f]=J.useState(""),{createAccount:u}=Ht(),{user:g}=dr(),p=[{id:"checking",name:"Checking",description:"For everyday spending",icon:Io,color:"blue"},{id:"savings",name:"Savings",description:"For saving money",icon:Po,color:"green"},{id:"credit",name:"Credit Card",description:"For credit spending",icon:an,color:"red"},{id:"cash",name:"Cash",description:"Physical cash",icon:la,color:"gray"}],m=async x=>{if(x.preventDefault(),!!g){c(!0),f("");try{const v=parseFloat(a)||0;await u({user_id:g.id,name:t,type:s,initial_balance:v,current_balance:v}),e()}catch(v){f(v.message||"Failed to create account")}finally{c(!1)}}};return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-3 sm:p-4 z-50",children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-md w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto border border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-900 rounded-t-2xl",children:[d.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white",children:"Create Account"}),d.jsx("button",{onClick:r,className:"w-8 h-8 flex items-center justify-center text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:d.jsx(Qt,{className:"w-5 h-5"})})]}),d.jsxs("form",{onSubmit:m,className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[h&&d.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 text-red-700 dark:text-red-400 px-3 sm:px-4 py-2 sm:py-3 rounded-lg text-sm",children:h}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Account Name"}),d.jsx("input",{id:"name",type:"text",value:t,onChange:x=>n(x.target.value),placeholder:"e.g., Main Checking, Emergency Fund",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Account Type"}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:p.map(x=>{const v=x.icon,b=s===x.id,_={blue:b?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600",green:b?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-300 dark:border-gray-600",red:b?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-gray-300 dark:border-gray-600",gray:b?"border-gray-500 bg-gray-50 dark:bg-gray-800":"border-gray-300 dark:border-gray-600"};return d.jsxs("button",{type:"button",onClick:()=>i(x.id),className:`p-3 sm:p-4 border-2 rounded-lg text-left hover:border-gray-400 dark:hover:border-gray-500 transition-colors ${_[x.color]}`,children:[d.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[d.jsx(v,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600 dark:text-gray-400"}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base",children:x.name})]}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:x.description})]},x.id)})})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"balance",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Initial Balance"}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400",children:"₦"}),d.jsx("input",{id:"balance",type:"number",step:"0.01",value:a,onChange:x=>o(x.target.value),placeholder:"0.00",className:"w-full pl-7 sm:pl-8 pr-3 sm:pr-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200"})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 sticky bottom-0 bg-white dark:bg-gray-900 pb-2",children:[d.jsx("button",{type:"button",onClick:r,className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm sm:text-base",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:l||!t.trim(),className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 bg-blue-600 dark:bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-700 dark:hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm sm:text-base",children:l?"Creating...":"Create Account"})]})]})]})})}function xy({account:r,onClose:e,onSuccess:t}){const[n,s]=J.useState(r.name),[i,a]=J.useState(r.type),[o,l]=J.useState(r.initial_balance.toString()),[c,h]=J.useState(!1),[f,u]=J.useState(""),{updateAccount:g}=Ht(),p=[{id:"checking",name:"Checking",description:"For everyday spending",icon:Io,color:"blue"},{id:"savings",name:"Savings",description:"For saving money",icon:Po,color:"green"},{id:"credit",name:"Credit Card",description:"For credit spending",icon:an,color:"red"},{id:"cash",name:"Cash",description:"Physical cash",icon:la,color:"gray"}],m=async x=>{x.preventDefault(),h(!0),u("");try{const v=parseFloat(o)||0,b=v-r.initial_balance,_={...r,name:n,type:i,initial_balance:v,current_balance:r.current_balance+b,updated_at:new Date().toISOString()};await g(_),t()}catch(v){u(v.message||"Failed to update account")}finally{h(!1)}};return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-3 sm:p-4 z-50",children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-md w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto border border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-900 rounded-t-2xl",children:[d.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white",children:"Edit Account"}),d.jsx("button",{onClick:e,className:"w-8 h-8 flex items-center justify-center text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:d.jsx(Qt,{className:"w-5 h-5"})})]}),d.jsxs("form",{onSubmit:m,className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[f&&d.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 text-red-700 dark:text-red-400 px-3 sm:px-4 py-2 sm:py-3 rounded-lg text-sm",children:f}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Account Name"}),d.jsx("input",{id:"name",type:"text",value:n,onChange:x=>s(x.target.value),placeholder:"e.g., Main Checking, Emergency Fund",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Account Type"}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:p.map(x=>{const v=x.icon,b=i===x.id,_={blue:b?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600",green:b?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-300 dark:border-gray-600",red:b?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-gray-300 dark:border-gray-600",gray:b?"border-gray-500 bg-gray-50 dark:bg-gray-800":"border-gray-300 dark:border-gray-600"};return d.jsxs("button",{type:"button",onClick:()=>a(x.id),className:`p-3 sm:p-4 border-2 rounded-lg text-left hover:border-gray-400 dark:hover:border-gray-500 transition-colors ${_[x.color]}`,children:[d.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[d.jsx(v,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600 dark:text-gray-400"}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base",children:x.name})]}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:x.description})]},x.id)})})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"balance",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Initial Balance"}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400",children:"₦"}),d.jsx("input",{id:"balance",type:"number",step:"0.01",value:o,onChange:x=>l(x.target.value),placeholder:"0.00",className:"w-full pl-7 sm:pl-8 pr-3 sm:pr-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200"})]}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Current balance will be adjusted by the difference"})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 sticky bottom-0 bg-white dark:bg-gray-900 pb-2",children:[d.jsx("button",{type:"button",onClick:e,className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm sm:text-base",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:c||!n.trim(),className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 bg-blue-600 dark:bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-700 dark:hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm sm:text-base",children:c?"Updating...":"Update Account"})]})]})]})})}function wd({isOpen:r,title:e,message:t,confirmText:n="Confirm",cancelText:s="Cancel",onConfirm:i,onCancel:a,type:o="danger"}){if(!r)return null;const c={danger:{icon:"text-red-600 dark:text-red-400",bg:"bg-red-50 dark:bg-red-900/20",border:"border-red-200 dark:border-red-700",button:"bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 focus:ring-red-500"},warning:{icon:"text-yellow-600 dark:text-yellow-400",bg:"bg-yellow-50 dark:bg-yellow-900/20",border:"border-yellow-200 dark:border-yellow-700",button:"bg-yellow-600 hover:bg-yellow-700 dark:bg-yellow-500 dark:hover:bg-yellow-600 focus:ring-yellow-500"},info:{icon:"text-blue-600 dark:text-blue-400",bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-700",button:"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 focus:ring-blue-500"}}[o];return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-md w-full border border-gray-200 dark:border-gray-700 shadow-xl",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${c.bg} ${c.border} border`,children:d.jsx(Mu,{className:`w-5 h-5 ${c.icon}`})}),d.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white",children:e})]}),d.jsx("button",{onClick:a,className:"w-8 h-8 flex items-center justify-center text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:d.jsx(Qt,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"p-4 sm:p-6",children:[d.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm sm:text-base leading-relaxed mb-6",children:t}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[d.jsx("button",{onClick:a,className:"flex-1 px-4 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm sm:text-base",children:s}),d.jsx("button",{onClick:i,className:`flex-1 px-4 py-3 text-white rounded-lg font-medium transition-colors text-sm sm:text-base ${c.button}`,children:n})]})]})]})})}function py({addToast:r}){const[e,t]=J.useState(!1),[n,s]=J.useState(null),[i,a]=J.useState(null),[o,l]=J.useState(null),{accounts:c,deleteAccount:h}=Ht(),f=dr(),u=(f==null?void 0:f.isAdmin)??!1,g=k=>{switch(k){case"checking":return Io;case"savings":return Po;case"credit":return an;case"cash":return la;default:return an}},p=k=>{switch(k){case"checking":return"blue";case"savings":return"green";case"credit":return"red";case"cash":return"gray";default:return"blue"}},m=k=>`₦${new Intl.NumberFormat("en-NG").format(k)}`,x=()=>{t(!1),r({type:"success",title:"Account created"})},v=()=>{s(null),r({type:"success",title:"Account updated"})},b=async()=>{if(i)try{await h(i.id),a(null),r({type:"success",title:"Account deleted"})}catch{r({type:"error",title:"Delete failed"})}},_=k=>{l(o===k?null:k)};return d.jsxs("div",{className:"p-4 sm:p-6 bg-gray-50 dark:bg-gray-950 transition-colors duration-200",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-4",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white",children:"Accounts"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm sm:text-base",children:u?"Manage church financial accounts":"View church financial accounts"})]}),u&&d.jsxs("button",{onClick:()=>t(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 dark:from-blue-500 dark:to-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all duration-200 flex items-center justify-center gap-2 text-sm sm:text-base shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95",children:[d.jsx(Bn,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Add Account"]})]}),c.length>0?d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:c.map(k=>{const O=g(k.type),P=p(k.type),C={blue:"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400 border-blue-200 dark:border-blue-700",green:"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border-green-200 dark:border-green-700",red:"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border-red-200 dark:border-red-700",gray:"bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-400 border-gray-200 dark:border-gray-600"};return d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700 p-4 sm:p-6 hover:shadow-lg dark:hover:shadow-2xl transition-all duration-200 relative group hover:scale-105",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 rounded-lg border flex items-center justify-center ${C[P]}`,children:d.jsx(O,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),d.jsxs("div",{className:"flex items-center gap-2",children:[!k.is_synced&&d.jsx("div",{className:"w-3 h-3 bg-orange-400 rounded-full",title:"Not synced"}),u&&d.jsxs("div",{className:"relative",children:[d.jsx("button",{onClick:()=>_(k.id),className:"p-2 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors opacity-0 group-hover:opacity-100",children:d.jsx(ah,{className:"w-4 h-4"})}),o===k.id&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>l(null)}),d.jsxs("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-20",children:[d.jsxs("button",{onClick:()=>{s(k),l(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-2",children:[d.jsx(Fi,{className:"w-4 h-4"}),"Edit Account"]}),d.jsxs("button",{onClick:()=>{a(k),l(null)},className:"w-full px-4 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2",children:[d.jsx(Di,{className:"w-4 h-4"}),"Delete Account"]})]})]})]})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white mb-1 truncate",children:k.name}),d.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 capitalize mb-3",children:[k.type," Account"]}),d.jsx("p",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white",children:m(k.current_balance)}),d.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Initial: ",m(k.initial_balance)]})]})]},k.id)})}):d.jsxs("div",{className:"text-center py-12",children:[d.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:d.jsx(an,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),d.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No accounts yet"}),d.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 text-sm sm:text-base",children:u?"Create your first account to start tracking church finances":"No church accounts have been created yet"}),u&&d.jsxs("button",{onClick:()=>t(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 dark:from-blue-500 dark:to-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all duration-200 inline-flex items-center gap-2 text-sm sm:text-base shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95",children:[d.jsx(Bn,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Create Account"]})]}),e&&u&&d.jsx(my,{onClose:()=>t(!1),onSuccess:x}),n&&u&&d.jsx(xy,{account:n,onClose:()=>s(null),onSuccess:v}),d.jsx(wd,{isOpen:!!i,title:"Delete Account",message:`Are you sure you want to delete "${i==null?void 0:i.name}"? This will also delete all associated transactions. This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",type:"danger",onConfirm:b,onCancel:()=>a(null)})]})}function kd({onClose:r,onSuccess:e}){var Z,Q;const[t,n]=J.useState("expense"),[s,i]=J.useState(""),[a,o]=J.useState(""),[l,c]=J.useState(""),[h,f]=J.useState(""),[u,g]=J.useState(""),[p,m]=J.useState(Ge(new Date,"yyyy-MM-dd")),[x,v]=J.useState(!1),[b,_]=J.useState(""),{createTransaction:k,accounts:O,categories:P}=Ht(),C=P.filter(V=>V.type===t),R=O.filter(V=>V.id!==s),D=async V=>{if(V.preventDefault(),!(!s||!h)){if(t==="transfer"&&!a){_("Please select a target account for the transfer");return}v(!0),_("");try{await k({account_id:s,target_account_id:t==="transfer"?a:null,category_id:t==="transfer"?null:l||null,amount:parseFloat(h),description:u||(t==="transfer"?"Transfer":""),date:p,type:t}),e()}catch(me){_(me.message||"Failed to create transaction")}finally{v(!1)}}},M=V=>{n(V),V!=="transfer"&&o(""),V==="transfer"&&c("")};return(()=>{switch(t){case"income":return{icon:In,color:"green",description:"Money coming in"};case"expense":return{icon:Ii,color:"red",description:"Money going out"};case"transfer":return{icon:Pi,color:"blue",description:"Move money between accounts"}}})().icon,d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-3 sm:p-4 z-50",children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-md w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto border border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-900 rounded-t-2xl",children:[d.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white",children:"Add Transaction"}),d.jsx("button",{onClick:r,className:"w-8 h-8 flex items-center justify-center text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:d.jsx(Qt,{className:"w-5 h-5"})})]}),d.jsxs("form",{onSubmit:D,className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[b&&d.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 text-red-700 dark:text-red-400 px-3 sm:px-4 py-2 sm:py-3 rounded-lg text-sm",children:b}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Transaction Type"}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3",children:[{id:"income",label:"Income",icon:In,color:"green"},{id:"expense",label:"Expense",icon:Ii,color:"red"},{id:"transfer",label:"Transfer",icon:Pi,color:"blue"}].map(V=>{const me=V.icon,ee=t===V.id,B={green:ee?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-300 dark:border-gray-600",red:ee?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-gray-300 dark:border-gray-600",blue:ee?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600"},le={green:"text-green-600 dark:text-green-400",red:"text-red-600 dark:text-red-400",blue:"text-blue-600 dark:text-blue-400"};return d.jsxs("button",{type:"button",onClick:()=>M(V.id),className:`p-3 sm:p-4 border-2 rounded-lg text-left hover:border-gray-400 dark:hover:border-gray-500 transition-colors ${B[V.color]}`,children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx(me,{className:`w-4 h-4 sm:w-5 sm:h-5 ${le[V.color]}`}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base",children:V.label})]}),d.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[V.id==="income"&&"Money coming in",V.id==="expense"&&"Money going out",V.id==="transfer"&&"Between accounts"]})]},V.id)})})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"account",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t==="transfer"?"From Account":"Account"}),d.jsxs("select",{id:"account",value:s,onChange:V=>i(V.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",required:!0,children:[d.jsx("option",{value:"",children:"Select an account"}),O.map(V=>d.jsxs("option",{value:V.id,children:[V.name," (₦",new Intl.NumberFormat("en-NG").format(V.current_balance),")"]},V.id))]})]}),t==="transfer"&&d.jsxs("div",{children:[d.jsx("label",{htmlFor:"targetAccount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"To Account"}),d.jsxs("select",{id:"targetAccount",value:a,onChange:V=>o(V.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",required:!0,children:[d.jsx("option",{value:"",children:"Select target account"}),R.map(V=>d.jsxs("option",{value:V.id,children:[V.name," (₦",new Intl.NumberFormat("en-NG").format(V.current_balance),")"]},V.id))]})]}),t!=="transfer"&&d.jsxs("div",{children:[d.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),d.jsxs("select",{id:"category",value:l,onChange:V=>c(V.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",children:[d.jsx("option",{value:"",children:"Select a category (optional)"}),C.map(V=>d.jsx("option",{value:V.id,children:V.name},V.id))]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Amount"}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400",children:"₦"}),d.jsx("input",{id:"amount",type:"number",step:"0.01",value:h,onChange:V=>f(V.target.value),placeholder:"0.00",className:"w-full pl-7 sm:pl-8 pr-3 sm:pr-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",required:!0})]}),t==="transfer"&&d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"This amount will be moved from the source to the target account"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),d.jsx("input",{id:"description",type:"text",value:u,onChange:V=>g(V.target.value),placeholder:t==="transfer"?"Transfer description (optional)":"What was this transaction for?",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date"}),d.jsx("input",{id:"date",type:"date",value:p,onChange:V=>m(V.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",required:!0})]}),t==="transfer"&&s&&a&&h&&d.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-4",children:[d.jsx("h4",{className:"text-sm font-medium text-blue-900 dark:text-blue-300 mb-2",children:"Transfer Summary"}),d.jsxs("div",{className:"space-y-2 text-sm text-blue-800 dark:text-blue-400",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{children:"From:"}),d.jsx("span",{className:"font-medium",children:(Z=O.find(V=>V.id===s))==null?void 0:Z.name})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{children:"To:"}),d.jsx("span",{className:"font-medium",children:(Q=O.find(V=>V.id===a))==null?void 0:Q.name})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{children:"Amount:"}),d.jsxs("span",{className:"font-medium",children:["₦",new Intl.NumberFormat("en-NG").format(parseFloat(h)||0)]})]})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 sticky bottom-0 bg-white dark:bg-gray-900 pb-2",children:[d.jsx("button",{type:"button",onClick:r,className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm sm:text-base",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:x||!s||!h||t==="transfer"&&!a,className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 bg-blue-600 dark:bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-700 dark:hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm sm:text-base",children:x?"Adding...":`Add ${t==="transfer"?"Transfer":t==="income"?"Income":"Expense"}`})]})]})]})})}function vy({transaction:r,onClose:e,onSuccess:t}){var G,Z;const[n,s]=J.useState(r.type),[i,a]=J.useState(r.account_id),[o,l]=J.useState(r.target_account_id||""),[c,h]=J.useState(r.category_id||""),[f,u]=J.useState(Math.abs(r.amount).toString()),[g,p]=J.useState(r.description),[m,x]=J.useState(Ge(new Date(r.date),"yyyy-MM-dd")),[v,b]=J.useState(!1),[_,k]=J.useState(""),{updateTransaction:O,accounts:P,categories:C}=Ht(),R=C.filter(Q=>Q.type===n),D=P.filter(Q=>Q.id!==i),M=async Q=>{if(Q.preventDefault(),!(!i||!f)){if(n==="transfer"&&!o){k("Please select a target account for the transfer");return}b(!0),k("");try{const V={...r,account_id:i,target_account_id:n==="transfer"?o:null,category_id:n==="transfer"?null:c||null,amount:parseFloat(f),description:g,date:m,type:n,updated_at:new Date().toISOString()};await O(V),t()}catch(V){k(V.message||"Failed to update transaction")}finally{b(!1)}}},z=Q=>{s(Q),Q!=="transfer"&&l(""),Q==="transfer"&&h("")};return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-3 sm:p-4 z-50",children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-md w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto border border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-900 rounded-t-2xl",children:[d.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white",children:"Edit Transaction"}),d.jsx("button",{onClick:e,className:"w-8 h-8 flex items-center justify-center text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:d.jsx(Qt,{className:"w-5 h-5"})})]}),d.jsxs("form",{onSubmit:M,className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[_&&d.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 text-red-700 dark:text-red-400 px-3 sm:px-4 py-2 sm:py-3 rounded-lg text-sm",children:_}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Transaction Type"}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3",children:[{id:"income",label:"Income",icon:In,color:"green"},{id:"expense",label:"Expense",icon:Ii,color:"red"},{id:"transfer",label:"Transfer",icon:Pi,color:"blue"}].map(Q=>{const V=Q.icon,me=n===Q.id,ee={green:me?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-300 dark:border-gray-600",red:me?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-gray-300 dark:border-gray-600",blue:me?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600"},B={green:"text-green-600 dark:text-green-400",red:"text-red-600 dark:text-red-400",blue:"text-blue-600 dark:text-blue-400"};return d.jsxs("button",{type:"button",onClick:()=>z(Q.id),className:`p-3 sm:p-4 border-2 rounded-lg text-left hover:border-gray-400 dark:hover:border-gray-500 transition-colors ${ee[Q.color]}`,children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx(V,{className:`w-4 h-4 sm:w-5 sm:h-5 ${B[Q.color]}`}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base",children:Q.label})]}),d.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Q.id==="income"&&"Money coming in",Q.id==="expense"&&"Money going out",Q.id==="transfer"&&"Between accounts"]})]},Q.id)})})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"account",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:n==="transfer"?"From Account":"Account"}),d.jsxs("select",{id:"account",value:i,onChange:Q=>a(Q.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",required:!0,children:[d.jsx("option",{value:"",children:"Select an account"}),P.map(Q=>d.jsxs("option",{value:Q.id,children:[Q.name," (₦",new Intl.NumberFormat("en-NG").format(Q.current_balance),")"]},Q.id))]})]}),n==="transfer"&&d.jsxs("div",{children:[d.jsx("label",{htmlFor:"targetAccount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"To Account"}),d.jsxs("select",{id:"targetAccount",value:o,onChange:Q=>l(Q.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",required:!0,children:[d.jsx("option",{value:"",children:"Select target account"}),D.map(Q=>d.jsxs("option",{value:Q.id,children:[Q.name," (₦",new Intl.NumberFormat("en-NG").format(Q.current_balance),")"]},Q.id))]})]}),n!=="transfer"&&d.jsxs("div",{children:[d.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),d.jsxs("select",{id:"category",value:c,onChange:Q=>h(Q.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",children:[d.jsx("option",{value:"",children:"Select a category (optional)"}),R.map(Q=>d.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Amount"}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400",children:"₦"}),d.jsx("input",{id:"amount",type:"number",step:"0.01",value:f,onChange:Q=>u(Q.target.value),placeholder:"0.00",className:"w-full pl-7 sm:pl-8 pr-3 sm:pr-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",required:!0})]}),n==="transfer"&&d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"This amount will be moved from the source to the target account"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),d.jsx("input",{id:"description",type:"text",value:g,onChange:Q=>p(Q.target.value),placeholder:n==="transfer"?"Transfer description (optional)":"What was this transaction for?",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date"}),d.jsx("input",{id:"date",type:"date",value:m,onChange:Q=>x(Q.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",required:!0})]}),n==="transfer"&&i&&o&&f&&d.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-4",children:[d.jsx("h4",{className:"text-sm font-medium text-blue-900 dark:text-blue-300 mb-2",children:"Transfer Summary"}),d.jsxs("div",{className:"space-y-2 text-sm text-blue-800 dark:text-blue-400",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{children:"From:"}),d.jsx("span",{className:"font-medium",children:(G=P.find(Q=>Q.id===i))==null?void 0:G.name})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{children:"To:"}),d.jsx("span",{className:"font-medium",children:(Z=P.find(Q=>Q.id===o))==null?void 0:Z.name})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{children:"Amount:"}),d.jsxs("span",{className:"font-medium",children:["₦",new Intl.NumberFormat("en-NG").format(parseFloat(f)||0)]})]})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 sticky bottom-0 bg-white dark:bg-gray-900 pb-2",children:[d.jsx("button",{type:"button",onClick:e,className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm sm:text-base",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:v||!i||!f||n==="transfer"&&!o,className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 bg-blue-600 dark:bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-700 dark:hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm sm:text-base",children:v?"Updating...":"Update Transaction"})]})]})]})})}function yy({transactions:r,accounts:e,categories:t,dateRange:n,exchangeRate:s}){const i=x=>{if(s){const v=x/s;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v)}return`₦${new Intl.NumberFormat("en-NG").format(x)}`},a=r.filter(x=>x.type==="income"),o=r.filter(x=>x.type==="expense"),l=a.reduce((x,v)=>x+v.amount,0),c=o.reduce((x,v)=>x+v.amount,0),h=l-c,f=t.filter(x=>x.type==="income").map(x=>{const b=a.filter(_=>_.category_id===x.id).reduce((_,k)=>_+k.amount,0);return{category:x.name,amount:b}}).filter(x=>x.amount>0),u=a.filter(x=>!x.category_id).reduce((x,v)=>x+v.amount,0);u>0&&f.push({category:"Uncategorized",amount:u});const g=t.filter(x=>x.type==="expense").map(x=>{const b=o.filter(_=>_.category_id===x.id).reduce((_,k)=>_+k.amount,0);return{category:x.name,amount:b}}).filter(x=>x.amount>0),p=o.filter(x=>!x.category_id).reduce((x,v)=>x+v.amount,0);p>0&&g.push({category:"Uncategorized",amount:p});const m=[...r].sort((x,v)=>new Date(x.date).getTime()-new Date(v.date).getTime());return d.jsxs(d.Fragment,{children:[d.jsx("style",{jsx:!0,global:!0,children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print-modal-content, .print-modal-content * {
            visibility: visible;
          }
          .print-modal-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            margin: 0;
            padding: 20px;
            background: white;
          }
          .no-print {
            display: none !important;
          }
        }
      `}),d.jsxs("div",{className:"print-modal-content max-w-4xl mx-auto p-8 bg-white text-black",children:[d.jsxs("div",{className:"text-center mb-8 border-b-2 border-gray-800 pb-6",children:[d.jsx("h1",{className:"text-3xl font-bold mb-2",children:"CHURCH OF CHRIST, KAGINI"}),d.jsx("h2",{className:"text-xl font-semibold mb-4",children:"STATEMENT OF ACCOUNT"}),d.jsxs("div",{className:"text-sm",children:[d.jsxs("p",{children:[d.jsx("strong",{children:"Period:"})," ",n.label]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Generated on:"})," ",Ge(new Date,"MMMM dd, yyyy")]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[d.jsx("div",{children:d.jsxs("div",{className:"bg-green-100 border-2 border-green-400 p-6 text-center",children:[d.jsx("h3",{className:"text-xl font-bold text-green-800 mb-2",children:"TOTAL INCOME"}),d.jsx("p",{className:"text-2xl font-bold text-green-900",children:i(l)})]})}),d.jsx("div",{children:d.jsxs("div",{className:"bg-red-100 border-2 border-red-400 p-6 text-center",children:[d.jsx("h3",{className:"text-xl font-bold text-red-800 mb-2",children:"TOTAL EXPENSES"}),d.jsx("p",{className:"text-2xl font-bold text-red-900",children:i(c)})]})})]}),d.jsx("div",{className:"mb-8",children:d.jsx("div",{className:`text-center p-4 border-2 ${h>=0?"bg-green-100 border-green-400":"bg-red-100 border-red-400"}`,children:d.jsxs("h3",{className:"text-xl font-bold",children:["NET INCOME: ",i(h)]})})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-bold mb-4 bg-blue-100 p-2 border border-gray-400",children:"DETAILED TRANSACTIONS"}),d.jsxs("table",{className:"w-full border-collapse border border-gray-400 text-sm",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-gray-100",children:[d.jsx("th",{className:"border border-gray-400 p-2 text-left font-semibold",children:"Date"}),d.jsx("th",{className:"border border-gray-400 p-2 text-left font-semibold",children:"Description"}),d.jsx("th",{className:"border border-gray-400 p-2 text-left font-semibold",children:"Account"}),d.jsx("th",{className:"border border-gray-400 p-2 text-left font-semibold",children:"Category"}),d.jsx("th",{className:"border border-gray-400 p-2 text-left font-semibold",children:"Type"}),d.jsx("th",{className:"border border-gray-400 p-2 text-right font-semibold",children:"Amount"})]})}),d.jsx("tbody",{children:m.map(x=>{const v=e.find(O=>O.id===x.account_id),b=t.find(O=>O.id===x.category_id),_=e.find(O=>O.id===x.target_account_id);let k=x.description||"Transaction";return x.type==="transfer"&&(k=`Transfer: ${v==null?void 0:v.name} → ${_==null?void 0:_.name}`),d.jsxs("tr",{className:x.type==="income"?"bg-green-25":x.type==="expense"?"bg-red-25":"bg-blue-25",children:[d.jsx("td",{className:"border border-gray-400 p-2",children:Ge(new Date(x.date),"MMM dd, yyyy")}),d.jsx("td",{className:"border border-gray-400 p-2",children:k}),d.jsx("td",{className:"border border-gray-400 p-2",children:(v==null?void 0:v.name)||"Unknown Account"}),d.jsx("td",{className:"border border-gray-400 p-2",children:x.type==="transfer"?"Transfer":(b==null?void 0:b.name)||"Uncategorized"}),d.jsx("td",{className:"border border-gray-400 p-2 capitalize",children:x.type}),d.jsx("td",{className:"border border-gray-400 p-2 text-right",children:x.type==="expense"?`-${i(Math.abs(x.amount))}`:i(Math.abs(x.amount))})]},x.id)})})]})]}),d.jsxs("div",{className:"mt-8 pt-4 border-t border-gray-400 text-center text-sm text-gray-600",children:[d.jsx("p",{children:"Generated by ChurchTrack Financial Management System"}),d.jsx("p",{children:"This is a computer-generated document and does not require a signature."})]}),d.jsx("div",{className:"no-print mt-8 text-center",children:d.jsx("button",{onClick:()=>window.print(),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Print Statement"})})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ki={};Ki.version="0.18.5";var Sd=1252,_y=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Td=function(r){_y.indexOf(r)!=-1&&(Sd=r)};function by(){Td(1252)}var Ps=function(r){Td(r)};function wy(){Ps(1200),by()}var yi=function(e){return String.fromCharCode(e)},h0=function(e){return String.fromCharCode(e)},tn,Pr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Rs(r){for(var e="",t=0,n=0,s=0,i=0,a=0,o=0,l=0,c=0;c<r.length;)t=r.charCodeAt(c++),i=t>>2,n=r.charCodeAt(c++),a=(t&3)<<4|n>>4,s=r.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Pr.charAt(i)+Pr.charAt(a)+Pr.charAt(o)+Pr.charAt(l);return e}function Sr(r){var e="",t=0,n=0,s=0,i=0,a=0,o=0,l=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<r.length;)i=Pr.indexOf(r.charAt(c++)),a=Pr.indexOf(r.charAt(c++)),t=i<<2|a>>4,e+=String.fromCharCode(t),o=Pr.indexOf(r.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Pr.indexOf(r.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var Ae=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Er=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function dn(r){return Ae?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function d0(r){return Ae?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var qt=function(e){return Ae?Er(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function ba(r){if(typeof ArrayBuffer>"u")return qt(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function Gs(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function ky(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}var ht=Ae?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:Er(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),s=0;for(e=0,t=0;e<r.length;t+=s,++e)if(s=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Sy(r){for(var e=[],t=0,n=r.length+250,s=dn(r.length+255),i=0;i<r.length;++i){var a=r.charCodeAt(i);if(a<128)s[t++]=a;else if(a<2048)s[t++]=192|a>>6&31,s[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++i)&1023;s[t++]=240|a>>8&7,s[t++]=128|a>>2&63,s[t++]=128|o>>6&15|(a&3)<<4,s[t++]=128|o&63}else s[t++]=224|a>>12&15,s[t++]=128|a>>6&63,s[t++]=128|a&63;t>n&&(e.push(s.slice(0,t)),t=0,s=dn(65535),n=65530)}return e.push(s.slice(0,t)),ht(e)}var ks=/\u0000/g,_i=/[\u0001-\u0006]/g;function Rn(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Jt(r,e){var t=""+r;return t.length>=e?t:ze("0",e-t.length)+t}function tl(r,e){var t=""+r;return t.length>=e?t:ze(" ",e-t.length)+t}function Yi(r,e){var t=""+r;return t.length>=e?t:t+ze(" ",e-t.length)}function Ty(r,e){var t=""+Math.round(r);return t.length>=e?t:ze("0",e-t.length)+t}function Ey(r,e){var t=""+r;return t.length>=e?t:ze("0",e-t.length)+t}var f0=Math.pow(2,32);function An(r,e){if(r>f0||r<-f0)return Ty(r,e);var t=Math.round(r);return Ey(t,e)}function qi(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var u0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],eo=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Ay(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',r}var Ve={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},g0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Cy={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ji(r,e,t){for(var n=r<0?-1:1,s=r*n,i=0,a=1,o=0,l=1,c=0,h=0,f=Math.floor(s);c<e&&(f=Math.floor(s),o=f*a+i,h=f*c+l,!(s-f<5e-8));)s=1/(s-f),i=a,a=o,l=c,c=h;if(h>e&&(c>e?(h=l,o=i):(h=c,o=a)),!t)return[0,n*o,h];var u=Math.floor(n*o/h);return[u,n*o-u*h,h]}function bi(r,e,t){if(r>2958465||r<0)return null;var n=r|0,s=Math.floor(86400*(r-n)),i=0,a=[],o={D:n,T:s,u:86400*(r-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=t?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=t?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),t&&(i=Ry(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var Ed=new Date(1899,11,31,0,0,0),Ny=Ed.getTime(),Oy=new Date(1900,2,1,0,0,0);function Ad(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=Oy&&(t+=24*60*60*1e3),(t-(Ny+(r.getTimezoneOffset()-Ed.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function rl(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Fy(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Dy(r){var e=r<0?12:11,t=rl(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function Iy(r){var e=rl(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function Py(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=Dy(r):e===10?t=r.toFixed(10).substr(0,12):t=Iy(r),rl(Fy(t.toUpperCase()))}function No(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):Py(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Br(14,Ad(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function Ry(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function jy(r,e,t,n){var s="",i=0,a=0,o=t.y,l,c=0;switch(r){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,c=e.length;break;case 3:return eo[t.m-1][1];case 5:return eo[t.m-1][0];default:return eo[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,c=e.length;break;case 3:return u0[t.q][0];default:return u0[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Jt(t.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(t.S+t.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=Jt(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var h=c>0?Jt(l,c):"";return h}function Rr(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var Cd=/%/g;function My(r,e,t){var n=e.replace(Cd,""),s=e.length-n.length;return _r(r,n,t*Math.pow(10,2*s))+ze("%",s)}function Ly(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return _r(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function Nd(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Nd(r,-e);var s=r.indexOf(".");s===-1&&(s=r.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),t=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+i):t+="E+"+(a-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(s+i)%s)+"."+h.substr(i)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Od=/# (\?+)( ?)\/( ?)(\d+)/;function By(r,e,t){var n=parseInt(r[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return t+(i===0?"":""+i)+" "+(a===0?ze(" ",r[1].length+1+r[4].length):tl(a,r[1].length)+r[2]+"/"+r[3]+Jt(o,r[4].length))}function Uy(r,e,t){return t+(e===0?"":""+e)+ze(" ",r[1].length+2+r[4].length)}var Fd=/^#*0*\.([0#]+)/,Dd=/\).*[0#]/,Id=/\(###\) ###\\?-####/;function yt(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function m0(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function x0(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function $y(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function Wy(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Bt(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Dd)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Bt("n",n,t):"("+Bt("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Ly(r,e,t);if(e.indexOf("%")!==-1)return My(r,e,t);if(e.indexOf("E")!==-1)return Nd(e,t);if(e.charCodeAt(0)===36)return"$"+Bt(r,e.substr(e.charAt(1)==" "?2:1),t);var s,i,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+An(l,e.length);if(e.match(/^[#?]+$/))return s=An(t,0),s==="0"&&(s=""),s.length>e.length?s:yt(e.substr(0,e.length-s.length))+s;if(i=e.match(Od))return By(i,l,c);if(e.match(/^#+0+$/))return c+An(l,e.length-e.indexOf("0"));if(i=e.match(Fd))return s=m0(t,i[1].length).replace(/^([^\.]+)$/,"$1."+yt(i[1])).replace(/\.$/,"."+yt(i[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+ze("0",yt(i[1]).length-m.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+m0(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Rr(An(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Bt(r,e,-t):Rr(""+(Math.floor(t)+$y(t,i[1].length)))+"."+Jt(x0(t,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Bt(r,e.replace(/^#,#*,/,""),t);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Rn(Bt(r,e.replace(/[\\-]/g,""),t)),a=0,Rn(Rn(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<s.length?s.charAt(a++):p==="0"?"0":""}));if(e.match(Id))return s=Bt(r,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Ji(l,Math.pow(10,a)-1,!1),s=""+c,h=_r("n",i[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+i[2]+"/"+i[3],h=Yi(o[2],a),h.length<i[4].length&&(h=yt(i[4].substr(i[4].length-h.length))+h),s+=h,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Ji(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?tl(o[1],a)+i[2]+"/"+i[3]+Yi(o[2],a):ze(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=An(t,0),e.length<=s.length?s:yt(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=e.indexOf(".")-a,u=e.length-s.length-f;return yt(e.substr(0,f)+s+e.substr(e.length-u))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=x0(t,i[1].length),t<0?"-"+Bt(r,e,-t):Rr(Wy(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Jt(0,3-p.length):"")+p})+"."+Jt(a,i[1].length);switch(e){case"###,##0.00":return Bt(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var g=Rr(An(l,0));return g!=="0"?c+g:"";case"###,###.00":return Bt(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Bt(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Hy(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return _r(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function zy(r,e,t){var n=e.replace(Cd,""),s=e.length-n.length;return _r(r,n,t*Math.pow(10,2*s))+ze("%",s)}function Pd(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Pd(r,-e);var s=r.indexOf(".");s===-1&&(s=r.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),t=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+i):t+="E+"+(a-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(s+i)%s)+"."+h.substr(i)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ir(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Dd)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ir("n",n,t):"("+ir("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Hy(r,e,t);if(e.indexOf("%")!==-1)return zy(r,e,t);if(e.indexOf("E")!==-1)return Pd(e,t);if(e.charCodeAt(0)===36)return"$"+ir(r,e.substr(e.charAt(1)==" "?2:1),t);var s,i,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+Jt(l,e.length);if(e.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>e.length?s:yt(e.substr(0,e.length-s.length))+s;if(i=e.match(Od))return Uy(i,l,c);if(e.match(/^#+0+$/))return c+Jt(l,e.length-e.indexOf("0"));if(i=e.match(Fd))return s=(""+t).replace(/^([^\.]+)$/,"$1."+yt(i[1])).replace(/\.$/,"."+yt(i[1])),s=s.replace(/\.(\d*)$/,function(p,m){return"."+m+ze("0",yt(i[1]).length-m.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Rr(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ir(r,e,-t):Rr(""+t)+"."+ze("0",i[1].length);if(i=e.match(/^#,#*,#0/))return ir(r,e.replace(/^#,#*,/,""),t);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Rn(ir(r,e.replace(/[\\-]/g,""),t)),a=0,Rn(Rn(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<s.length?s.charAt(a++):p==="0"?"0":""}));if(e.match(Id))return s=ir(r,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Ji(l,Math.pow(10,a)-1,!1),s=""+c,h=_r("n",i[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+i[2]+"/"+i[3],h=Yi(o[2],a),h.length<i[4].length&&(h=yt(i[4].substr(i[4].length-h.length))+h),s+=h,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Ji(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?tl(o[1],a)+i[2]+"/"+i[3]+Yi(o[2],a):ze(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+t,e.length<=s.length?s:yt(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=e.indexOf(".")-a,u=e.length-s.length-f;return yt(e.substr(0,f)+s+e.substr(e.length-u))}if(i=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ir(r,e,-t):Rr(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Jt(0,3-p.length):"")+p})+"."+Jt(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=Rr(""+l);return g!=="0"?c+g:"";default:if(e.match(/\.[0#?]*$/))return ir(r,e.slice(0,e.lastIndexOf(".")),t)+yt(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function _r(r,e,t){return(t|0)===t?ir(r,e,t):Bt(r,e,t)}function Vy(r){for(var e=[],t=!1,n=0,s=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(s,n-s),s=n+1}if(e[e.length]=r.substr(s),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var Rd=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function jd(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":qi(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(Rd))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Gy(r,e,t,n){for(var s=[],i="",a=0,o="",l="t",c,h,f,u="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!qi(r,a))throw new Error("unrecognized character "+o+" in "+r);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(f=r.charCodeAt(++a))!==34&&a<r.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++a;break;case"\\":var g=r.charAt(++a),p=g==="("||g===")"?g:"t";s[s.length]={t:p,v:g},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(c==null&&(c=bi(e,t,r.charAt(a+1)==="2"),c==null))return"";s[s.length]={t:"X",v:r.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=bi(e,t),c==null))return"";for(i=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=u),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"上":var m={t:o,v:o};if(c==null&&(c=bi(e,t)),r.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",u="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",a+=5,u="h"):r.substr(a,5).toUpperCase()==="上午/下午"?(c!=null&&(m.v=c.H>=12?"下午":"上午"),m.t="T",a+=5,u="h"):(m.t="t",++a),c==null&&m.t==="T")return"";s[s.length]=m,l=o;break;case"[":for(i=o;r.charAt(a++)!=="]"&&a<r.length;)i+=r.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Rd)){if(c==null&&(c=bi(e,t),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",jd(r)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++a<r.length&&(o=r.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;r.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)i+=r.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);s[s.length]={t:"t",v:o},++a;break}var x=0,v=0,b;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=u,l="h",x<1&&(x=1);break;case"s":(b=s[a].v.match(/\.0+$/))&&(v=Math.max(v,b[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&s[a].v.match(/[Hh]/)&&(x=1),x<2&&s[a].v.match(/[Mm]/)&&(x=2),x<3&&s[a].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",k;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=jy(s[a].t.charCodeAt(0),s[a].v,c,v),s[a].t="t";break;case"n":case"?":for(k=a+1;s[k]!=null&&((o=s[k].t)==="?"||o==="D"||(o===" "||o==="t")&&s[k+1]!=null&&(s[k+1].t==="?"||s[k+1].t==="t"&&s[k+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[k].v==="/"||s[k].v===" "&&s[k+1]!=null&&s[k+1].t=="?"));)s[a].v+=s[k].v,s[k]={v:"",t:";"},++k;_+=s[a].v,a=k-1;break;case"G":s[a].t="t",s[a].v=No(e,t);break}var O="",P,C;if(_.length>0){_.charCodeAt(0)==40?(P=e<0&&_.charCodeAt(0)===45?-e:e,C=_r("n",_,P)):(P=e<0&&n>1?-e:e,C=_r("n",_,P),P<0&&s[0]&&s[0].t=="t"&&(C=C.substr(1),s[0].v="-"+s[0].v)),k=C.length-1;var R=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){R=a;break}var D=s.length;if(R===s.length&&C.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(k>=s[a].v.length-1?(k-=s[a].v.length,s[a].v=C.substr(k+1,s[a].v.length)):k<0?s[a].v="":(s[a].v=C.substr(0,k+1),k=-1),s[a].t="t",D=a);k>=0&&D<s.length&&(s[D].v=C.substr(0,k+1)+s[D].v)}else if(R!==s.length&&C.indexOf("E")===-1){for(k=C.indexOf(".")-1,a=R;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(h=s[a].v.indexOf(".")>-1&&a===R?s[a].v.indexOf(".")-1:s[a].v.length-1,O=s[a].v.substr(h+1);h>=0;--h)k>=0&&(s[a].v.charAt(h)==="0"||s[a].v.charAt(h)==="#")&&(O=C.charAt(k--)+O);s[a].v=O,s[a].t="t",D=a}for(k>=0&&D<s.length&&(s[D].v=C.substr(0,k+1)+s[D].v),k=C.indexOf(".")+1,a=R;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==R)){for(h=s[a].v.indexOf(".")>-1&&a===R?s[a].v.indexOf(".")+1:0,O=s[a].v.substr(0,h);h<s[a].v.length;++h)k<C.length&&(O+=C.charAt(k++));s[a].v=O,s[a].t="t",D=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(P=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=_r(s[a].t,s[a].v,P),s[a].t="t");var M="";for(a=0;a!==s.length;++a)s[a]!=null&&(M+=s[a].v);return M}var p0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function v0(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function Xy(r,e){var t=Vy(r),n=t.length,s=t[n-1].indexOf("@");if(n<4&&s>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var i=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(p0),o=t[1].match(p0);return v0(e,a)?[n,t[0]]:v0(e,o)?[n,t[1]]:[n,t[a!=null&&o!=null?2:1]]}return[n,i]}function Br(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:Ve)[r],n==null&&(n=t.table&&t.table[g0[r]]||Ve[g0[r]]),n==null&&(n=Cy[r]||"General");break}if(qi(n,0))return No(e,t);e instanceof Date&&(e=Ad(e,t.date1904));var s=Xy(n,e);if(qi(s[1]))return No(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Gy(s[1],e,t,s[0])}function Md(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Ve[t]==null){e<0&&(e=t);continue}if(Ve[t]==r){e=t;break}}e<0&&(e=391)}return Ve[e]=r,e}function wa(r){for(var e=0;e!=392;++e)r[e]!==void 0&&Md(r[e],e)}function ka(){Ve=Ay()}var Ld=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Ky(r){var e=typeof r=="number"?Ve[r]:r;return e=e.replace(Ld,"(\\d+)"),new RegExp("^"+e+"$")}function Yy(r,e,t){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(e.match(Ld)||[]).forEach(function(f,u){var g=parseInt(t[u+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":a=g;break;case"s":l=g;break;case"m":a>=0?o=g:s=g;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&i==-1?h:c+"T"+h}var qy=function(){var r={};r.version="1.2.0";function e(){for(var C=0,R=new Array(256),D=0;D!=256;++D)C=D,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,R[D]=C;return typeof Int32Array<"u"?new Int32Array(R):R}var t=e();function n(C){var R=0,D=0,M=0,z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)z[M]=C[M];for(M=0;M!=256;++M)for(D=C[M],R=256+M;R<4096;R+=256)D=z[R]=D>>>8^C[D&255];var G=[];for(M=1;M!=16;++M)G[M-1]=typeof Int32Array<"u"?z.subarray(M*256,M*256+256):z.slice(M*256,M*256+256);return G}var s=n(t),i=s[0],a=s[1],o=s[2],l=s[3],c=s[4],h=s[5],f=s[6],u=s[7],g=s[8],p=s[9],m=s[10],x=s[11],v=s[12],b=s[13],_=s[14];function k(C,R){for(var D=R^-1,M=0,z=C.length;M<z;)D=D>>>8^t[(D^C.charCodeAt(M++))&255];return~D}function O(C,R){for(var D=R^-1,M=C.length-15,z=0;z<M;)D=_[C[z++]^D&255]^b[C[z++]^D>>8&255]^v[C[z++]^D>>16&255]^x[C[z++]^D>>>24]^m[C[z++]]^p[C[z++]]^g[C[z++]]^u[C[z++]]^f[C[z++]]^h[C[z++]]^c[C[z++]]^l[C[z++]]^o[C[z++]]^a[C[z++]]^i[C[z++]]^t[C[z++]];for(M+=15;z<M;)D=D>>>8^t[(D^C[z++])&255];return~D}function P(C,R){for(var D=R^-1,M=0,z=C.length,G=0,Z=0;M<z;)G=C.charCodeAt(M++),G<128?D=D>>>8^t[(D^G)&255]:G<2048?(D=D>>>8^t[(D^(192|G>>6&31))&255],D=D>>>8^t[(D^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,Z=C.charCodeAt(M++)&1023,D=D>>>8^t[(D^(240|G>>8&7))&255],D=D>>>8^t[(D^(128|G>>2&63))&255],D=D>>>8^t[(D^(128|Z>>6&15|(G&3)<<4))&255],D=D>>>8^t[(D^(128|Z&63))&255]):(D=D>>>8^t[(D^(224|G>>12&15))&255],D=D>>>8^t[(D^(128|G>>6&63))&255],D=D>>>8^t[(D^(128|G&63))&255]);return~D}return r.table=t,r.bstr=k,r.buf=O,r.str=P,r}(),Re=function(){var e={};e.version="1.2.1";function t(y,T){for(var w=y.split("/"),S=T.split("/"),E=0,A=0,L=Math.min(w.length,S.length);E<L;++E){if(A=w[E].length-S[E].length)return A;if(w[E]!=S[E])return w[E]<S[E]?-1:1}return w.length-S.length}function n(y){if(y.charAt(y.length-1)=="/")return y.slice(0,-1).indexOf("/")===-1?y:n(y.slice(0,-1));var T=y.lastIndexOf("/");return T===-1?y:y.slice(0,T+1)}function s(y){if(y.charAt(y.length-1)=="/")return s(y.slice(0,-1));var T=y.lastIndexOf("/");return T===-1?y:y.slice(T+1)}function i(y,T){typeof T=="string"&&(T=new Date(T));var w=T.getHours();w=w<<6|T.getMinutes(),w=w<<5|T.getSeconds()>>>1,y.write_shift(2,w);var S=T.getFullYear()-1980;S=S<<4|T.getMonth()+1,S=S<<5|T.getDate(),y.write_shift(2,S)}function a(y){var T=y.read_shift(2)&65535,w=y.read_shift(2)&65535,S=new Date,E=w&31;w>>>=5;var A=w&15;w>>>=4,S.setMilliseconds(0),S.setFullYear(w+1980),S.setMonth(A-1),S.setDate(E);var L=T&31;T>>>=5;var K=T&63;return T>>>=6,S.setHours(T),S.setMinutes(K),S.setSeconds(L<<1),S}function o(y){It(y,0);for(var T={},w=0;y.l<=y.length-4;){var S=y.read_shift(2),E=y.read_shift(2),A=y.l+E,L={};switch(S){case 21589:w=y.read_shift(1),w&1&&(L.mtime=y.read_shift(4)),E>5&&(w&2&&(L.atime=y.read_shift(4)),w&4&&(L.ctime=y.read_shift(4))),L.mtime&&(L.mt=new Date(L.mtime*1e3));break}y.l=A,T[S]=L}return T}var l;function c(){return l||(l={})}function h(y,T){if(y[0]==80&&y[1]==75)return Fl(y,T);if((y[0]|32)==109&&(y[1]|32)==105)return mu(y,T);if(y.length<512)throw new Error("CFB file size "+y.length+" < 512");var w=3,S=512,E=0,A=0,L=0,K=0,j=0,W=[],H=y.slice(0,512);It(H,0);var te=f(H);switch(w=te[0],w){case 3:S=512;break;case 4:S=4096;break;case 0:if(te[1]==0)return Fl(y,T);default:throw new Error("Major Version: Expected 3 or 4 saw "+w)}S!==512&&(H=y.slice(0,S),It(H,28));var ae=y.slice(0,S);u(H,w);var de=H.read_shift(4,"i");if(w===3&&de!==0)throw new Error("# Directory Sectors: Expected 0 saw "+de);H.l+=4,L=H.read_shift(4,"i"),H.l+=4,H.chk("00100000","Mini Stream Cutoff Size: "),K=H.read_shift(4,"i"),E=H.read_shift(4,"i"),j=H.read_shift(4,"i"),A=H.read_shift(4,"i");for(var re=-1,ce=0;ce<109&&(re=H.read_shift(4,"i"),!(re<0));++ce)W[ce]=re;var pe=g(y,S);x(j,A,pe,S,W);var We=b(pe,L,W,S);We[L].name="!Directory",E>0&&K!==Z&&(We[K].name="!MiniFAT"),We[W[0]].name="!FAT",We.fat_addrs=W,We.ssz=S;var He={},gt=[],qn=[],Jn=[];_(L,We,pe,gt,E,He,qn,K),p(qn,Jn,gt),gt.shift();var Zn={FileIndex:qn,FullPaths:Jn};return T&&T.raw&&(Zn.raw={header:ae,sectors:pe}),Zn}function f(y){if(y[y.l]==80&&y[y.l+1]==75)return[0,0];y.chk(Q,"Header Signature: "),y.l+=16;var T=y.read_shift(2,"u");return[y.read_shift(2,"u"),T]}function u(y,T){var w=9;switch(y.l+=2,w=y.read_shift(2)){case 9:if(T!=3)throw new Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(T!=4)throw new Error("Sector Shift: Expected 12 saw "+w);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+w)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ")}function g(y,T){for(var w=Math.ceil(y.length/T)-1,S=[],E=1;E<w;++E)S[E-1]=y.slice(E*T,(E+1)*T);return S[w-1]=y.slice(w*T),S}function p(y,T,w){for(var S=0,E=0,A=0,L=0,K=0,j=w.length,W=[],H=[];S<j;++S)W[S]=H[S]=S,T[S]=w[S];for(;K<H.length;++K)S=H[K],E=y[S].L,A=y[S].R,L=y[S].C,W[S]===S&&(E!==-1&&W[E]!==E&&(W[S]=W[E]),A!==-1&&W[A]!==A&&(W[S]=W[A])),L!==-1&&(W[L]=S),E!==-1&&S!=W[S]&&(W[E]=W[S],H.lastIndexOf(E)<K&&H.push(E)),A!==-1&&S!=W[S]&&(W[A]=W[S],H.lastIndexOf(A)<K&&H.push(A));for(S=1;S<j;++S)W[S]===S&&(A!==-1&&W[A]!==A?W[S]=W[A]:E!==-1&&W[E]!==E&&(W[S]=W[E]));for(S=1;S<j;++S)if(y[S].type!==0){if(K=S,K!=W[K])do K=W[K],T[S]=T[K]+"/"+T[S];while(K!==0&&W[K]!==-1&&K!=W[K]);W[S]=-1}for(T[0]+="/",S=1;S<j;++S)y[S].type!==2&&(T[S]+="/")}function m(y,T,w){for(var S=y.start,E=y.size,A=[],L=S;w&&E>0&&L>=0;)A.push(T.slice(L*G,L*G+G)),E-=G,L=rn(w,L*4);return A.length===0?X(0):ht(A).slice(0,y.size)}function x(y,T,w,S,E){var A=Z;if(y===Z){if(T!==0)throw new Error("DIFAT chain shorter than expected")}else if(y!==-1){var L=w[y],K=(S>>>2)-1;if(!L)return;for(var j=0;j<K&&(A=rn(L,j*4))!==Z;++j)E.push(A);x(rn(L,S-4),T-1,w,S,E)}}function v(y,T,w,S,E){var A=[],L=[];E||(E=[]);var K=S-1,j=0,W=0;for(j=T;j>=0;){E[j]=!0,A[A.length]=j,L.push(y[j]);var H=w[Math.floor(j*4/S)];if(W=j*4&K,S<4+W)throw new Error("FAT boundary crossed: "+j+" 4 "+S);if(!y[H])break;j=rn(y[H],W)}return{nodes:A,data:E0([L])}}function b(y,T,w,S){var E=y.length,A=[],L=[],K=[],j=[],W=S-1,H=0,te=0,ae=0,de=0;for(H=0;H<E;++H)if(K=[],ae=H+T,ae>=E&&(ae-=E),!L[ae]){j=[];var re=[];for(te=ae;te>=0;){re[te]=!0,L[te]=!0,K[K.length]=te,j.push(y[te]);var ce=w[Math.floor(te*4/S)];if(de=te*4&W,S<4+de)throw new Error("FAT boundary crossed: "+te+" 4 "+S);if(!y[ce]||(te=rn(y[ce],de),re[te]))break}A[ae]={nodes:K,data:E0([j])}}return A}function _(y,T,w,S,E,A,L,K){for(var j=0,W=S.length?2:0,H=T[y].data,te=0,ae=0,de;te<H.length;te+=128){var re=H.slice(te,te+128);It(re,64),ae=re.read_shift(2),de=ol(re,0,ae-W),S.push(de);var ce={name:de,type:re.read_shift(1),color:re.read_shift(1),L:re.read_shift(4,"i"),R:re.read_shift(4,"i"),C:re.read_shift(4,"i"),clsid:re.read_shift(16),state:re.read_shift(4,"i"),start:0,size:0},pe=re.read_shift(2)+re.read_shift(2)+re.read_shift(2)+re.read_shift(2);pe!==0&&(ce.ct=k(re,re.l-8));var We=re.read_shift(2)+re.read_shift(2)+re.read_shift(2)+re.read_shift(2);We!==0&&(ce.mt=k(re,re.l-8)),ce.start=re.read_shift(4,"i"),ce.size=re.read_shift(4,"i"),ce.size<0&&ce.start<0&&(ce.size=ce.type=0,ce.start=Z,ce.name=""),ce.type===5?(j=ce.start,E>0&&j!==Z&&(T[j].name="!StreamData")):ce.size>=4096?(ce.storage="fat",T[ce.start]===void 0&&(T[ce.start]=v(w,ce.start,T.fat_addrs,T.ssz)),T[ce.start].name=ce.name,ce.content=T[ce.start].data.slice(0,ce.size)):(ce.storage="minifat",ce.size<0?ce.size=0:j!==Z&&ce.start!==Z&&T[j]&&(ce.content=m(ce,T[j].data,(T[K]||{}).data))),ce.content&&It(ce.content,0),A[de]=ce,L.push(ce)}}function k(y,T){return new Date((Rt(y,T+4)/1e7*Math.pow(2,32)+Rt(y,T)/1e7-11644473600)*1e3)}function O(y,T){return c(),h(l.readFileSync(y),T)}function P(y,T){var w=T&&T.type;switch(w||Ae&&Buffer.isBuffer(y)&&(w="buffer"),w||"base64"){case"file":return O(y,T);case"base64":return h(qt(Sr(y)),T);case"binary":return h(qt(y),T)}return h(y,T)}function C(y,T){var w=T||{},S=w.root||"Root Entry";if(y.FullPaths||(y.FullPaths=[]),y.FileIndex||(y.FileIndex=[]),y.FullPaths.length!==y.FileIndex.length)throw new Error("inconsistent CFB structure");y.FullPaths.length===0&&(y.FullPaths[0]=S+"/",y.FileIndex[0]={name:S,type:5}),w.CLSID&&(y.FileIndex[0].clsid=w.CLSID),R(y)}function R(y){var T="Sh33tJ5";if(!Re.find(y,"/"+T)){var w=X(4);w[0]=55,w[1]=w[3]=50,w[2]=54,y.FileIndex.push({name:T,type:2,content:w,size:4,L:69,R:69,C:69}),y.FullPaths.push(y.FullPaths[0]+T),D(y)}}function D(y,T){C(y);for(var w=!1,S=!1,E=y.FullPaths.length-1;E>=0;--E){var A=y.FileIndex[E];switch(A.type){case 0:S?w=!0:(y.FileIndex.pop(),y.FullPaths.pop());break;case 1:case 2:case 5:S=!0,isNaN(A.R*A.L*A.C)&&(w=!0),A.R>-1&&A.L>-1&&A.R==A.L&&(w=!0);break;default:w=!0;break}}if(!(!w&&!T)){var L=new Date(1987,1,19),K=0,j=Object.create?Object.create(null):{},W=[];for(E=0;E<y.FullPaths.length;++E)j[y.FullPaths[E]]=!0,y.FileIndex[E].type!==0&&W.push([y.FullPaths[E],y.FileIndex[E]]);for(E=0;E<W.length;++E){var H=n(W[E][0]);S=j[H],S||(W.push([H,{name:s(H).replace("/",""),type:1,clsid:me,ct:L,mt:L,content:null}]),j[H]=!0)}for(W.sort(function(de,re){return t(de[0],re[0])}),y.FullPaths=[],y.FileIndex=[],E=0;E<W.length;++E)y.FullPaths[E]=W[E][0],y.FileIndex[E]=W[E][1];for(E=0;E<W.length;++E){var te=y.FileIndex[E],ae=y.FullPaths[E];if(te.name=s(ae).replace("/",""),te.L=te.R=te.C=-(te.color=1),te.size=te.content?te.content.length:0,te.start=0,te.clsid=te.clsid||me,E===0)te.C=W.length>1?1:-1,te.size=0,te.type=5;else if(ae.slice(-1)=="/"){for(K=E+1;K<W.length&&n(y.FullPaths[K])!=ae;++K);for(te.C=K>=W.length?-1:K,K=E+1;K<W.length&&n(y.FullPaths[K])!=n(ae);++K);te.R=K>=W.length?-1:K,te.type=1}else n(y.FullPaths[E+1]||"")==n(ae)&&(te.R=E+1),te.type=2}}}function M(y,T){var w=T||{};if(w.fileType=="mad")return xu(y,w);switch(D(y),w.fileType){case"zip":return cu(y,w)}var S=function(de){for(var re=0,ce=0,pe=0;pe<de.FileIndex.length;++pe){var We=de.FileIndex[pe];if(We.content){var He=We.content.length;He>0&&(He<4096?re+=He+63>>6:ce+=He+511>>9)}}for(var gt=de.FullPaths.length+3>>2,qn=re+7>>3,Jn=re+127>>7,Zn=qn+ce+gt+Jn,Vr=Zn+127>>7,Ia=Vr<=109?0:Math.ceil((Vr-109)/127);Zn+Vr+Ia+127>>7>Vr;)Ia=++Vr<=109?0:Math.ceil((Vr-109)/127);var fr=[1,Ia,Vr,Jn,gt,ce,re,0];return de.FileIndex[0].size=re<<6,fr[7]=(de.FileIndex[0].start=fr[0]+fr[1]+fr[2]+fr[3]+fr[4]+fr[5])+(fr[6]+7>>3),fr}(y),E=X(S[7]<<9),A=0,L=0;{for(A=0;A<8;++A)E.write_shift(1,V[A]);for(A=0;A<8;++A)E.write_shift(2,0);for(E.write_shift(2,62),E.write_shift(2,3),E.write_shift(2,65534),E.write_shift(2,9),E.write_shift(2,6),A=0;A<3;++A)E.write_shift(2,0);for(E.write_shift(4,0),E.write_shift(4,S[2]),E.write_shift(4,S[0]+S[1]+S[2]+S[3]-1),E.write_shift(4,0),E.write_shift(4,4096),E.write_shift(4,S[3]?S[0]+S[1]+S[2]-1:Z),E.write_shift(4,S[3]),E.write_shift(-4,S[1]?S[0]-1:Z),E.write_shift(4,S[1]),A=0;A<109;++A)E.write_shift(-4,A<S[2]?S[1]+A:-1)}if(S[1])for(L=0;L<S[1];++L){for(;A<236+L*127;++A)E.write_shift(-4,A<S[2]?S[1]+A:-1);E.write_shift(-4,L===S[1]-1?Z:L+1)}var K=function(de){for(L+=de;A<L-1;++A)E.write_shift(-4,A+1);de&&(++A,E.write_shift(-4,Z))};for(L=A=0,L+=S[1];A<L;++A)E.write_shift(-4,ee.DIFSECT);for(L+=S[2];A<L;++A)E.write_shift(-4,ee.FATSECT);K(S[3]),K(S[4]);for(var j=0,W=0,H=y.FileIndex[0];j<y.FileIndex.length;++j)H=y.FileIndex[j],H.content&&(W=H.content.length,!(W<4096)&&(H.start=L,K(W+511>>9)));for(K(S[6]+7>>3);E.l&511;)E.write_shift(-4,ee.ENDOFCHAIN);for(L=A=0,j=0;j<y.FileIndex.length;++j)H=y.FileIndex[j],H.content&&(W=H.content.length,!(!W||W>=4096)&&(H.start=L,K(W+63>>6)));for(;E.l&511;)E.write_shift(-4,ee.ENDOFCHAIN);for(A=0;A<S[4]<<2;++A){var te=y.FullPaths[A];if(!te||te.length===0){for(j=0;j<17;++j)E.write_shift(4,0);for(j=0;j<3;++j)E.write_shift(4,-1);for(j=0;j<12;++j)E.write_shift(4,0);continue}H=y.FileIndex[A],A===0&&(H.start=H.size?H.start-1:Z);var ae=A===0&&w.root||H.name;if(W=2*(ae.length+1),E.write_shift(64,ae,"utf16le"),E.write_shift(2,W),E.write_shift(1,H.type),E.write_shift(1,H.color),E.write_shift(-4,H.L),E.write_shift(-4,H.R),E.write_shift(-4,H.C),H.clsid)E.write_shift(16,H.clsid,"hex");else for(j=0;j<4;++j)E.write_shift(4,0);E.write_shift(4,H.state||0),E.write_shift(4,0),E.write_shift(4,0),E.write_shift(4,0),E.write_shift(4,0),E.write_shift(4,H.start),E.write_shift(4,H.size),E.write_shift(4,0)}for(A=1;A<y.FileIndex.length;++A)if(H=y.FileIndex[A],H.size>=4096)if(E.l=H.start+1<<9,Ae&&Buffer.isBuffer(H.content))H.content.copy(E,E.l,0,H.size),E.l+=H.size+511&-512;else{for(j=0;j<H.size;++j)E.write_shift(1,H.content[j]);for(;j&511;++j)E.write_shift(1,0)}for(A=1;A<y.FileIndex.length;++A)if(H=y.FileIndex[A],H.size>0&&H.size<4096)if(Ae&&Buffer.isBuffer(H.content))H.content.copy(E,E.l,0,H.size),E.l+=H.size+63&-64;else{for(j=0;j<H.size;++j)E.write_shift(1,H.content[j]);for(;j&63;++j)E.write_shift(1,0)}if(Ae)E.l=E.length;else for(;E.l<E.length;)E.write_shift(1,0);return E}function z(y,T){var w=y.FullPaths.map(function(j){return j.toUpperCase()}),S=w.map(function(j){var W=j.split("/");return W[W.length-(j.slice(-1)=="/"?2:1)]}),E=!1;T.charCodeAt(0)===47?(E=!0,T=w[0].slice(0,-1)+T):E=T.indexOf("/")!==-1;var A=T.toUpperCase(),L=E===!0?w.indexOf(A):S.indexOf(A);if(L!==-1)return y.FileIndex[L];var K=!A.match(_i);for(A=A.replace(ks,""),K&&(A=A.replace(_i,"!")),L=0;L<w.length;++L)if((K?w[L].replace(_i,"!"):w[L]).replace(ks,"")==A||(K?S[L].replace(_i,"!"):S[L]).replace(ks,"")==A)return y.FileIndex[L];return null}var G=64,Z=-2,Q="d0cf11e0a1b11ae1",V=[208,207,17,224,161,177,26,225],me="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Z,FREESECT:-1,HEADER_SIGNATURE:Q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function B(y,T,w){c();var S=M(y,w);l.writeFileSync(T,S)}function le(y){for(var T=new Array(y.length),w=0;w<y.length;++w)T[w]=String.fromCharCode(y[w]);return T.join("")}function Ee(y,T){var w=M(y,T);switch(T&&T.type||"buffer"){case"file":return c(),l.writeFileSync(T.filename,w),w;case"binary":return typeof w=="string"?w:le(w);case"base64":return Rs(typeof w=="string"?w:le(w));case"buffer":if(Ae)return Buffer.isBuffer(w)?w:Er(w);case"array":return typeof w=="string"?qt(w):w}return w}var Me;function N(y){try{var T=y.InflateRaw,w=new T;if(w._processChunk(new Uint8Array([3,0]),w._finishFlushFlag),w.bytesRead)Me=y;else throw new Error("zlib does not expose bytesRead")}catch(S){console.error("cannot use native zlib: "+(S.message||S))}}function U(y,T){if(!Me)return Nl(y,T);var w=Me.InflateRaw,S=new w,E=S._processChunk(y.slice(y.l),S._finishFlushFlag);return y.l+=S.bytesRead,E}function I(y){return Me?Me.deflateRawSync(y):kl(y)}var F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(y){var T=(y<<1|y<<11)&139536|(y<<5|y<<15)&558144;return(T>>16|T>>8|T)&255}for(var fe=typeof Uint8Array<"u",oe=fe?new Uint8Array(256):[],Ce=0;Ce<256;++Ce)oe[Ce]=ge(Ce);function we(y,T){var w=oe[y&255];return T<=8?w>>>8-T:(w=w<<8|oe[y>>8&255],T<=16?w>>>16-T:(w=w<<8|oe[y>>16&255],w>>>24-T))}function at(y,T){var w=T&7,S=T>>>3;return(y[S]|(w<=6?0:y[S+1]<<8))>>>w&3}function ke(y,T){var w=T&7,S=T>>>3;return(y[S]|(w<=5?0:y[S+1]<<8))>>>w&7}function ne(y,T){var w=T&7,S=T>>>3;return(y[S]|(w<=4?0:y[S+1]<<8))>>>w&15}function xe(y,T){var w=T&7,S=T>>>3;return(y[S]|(w<=3?0:y[S+1]<<8))>>>w&31}function he(y,T){var w=T&7,S=T>>>3;return(y[S]|(w<=1?0:y[S+1]<<8))>>>w&127}function tt(y,T,w){var S=T&7,E=T>>>3,A=(1<<w)-1,L=y[E]>>>S;return w<8-S||(L|=y[E+1]<<8-S,w<16-S)||(L|=y[E+2]<<16-S,w<24-S)||(L|=y[E+3]<<24-S),L&A}function Vt(y,T,w){var S=T&7,E=T>>>3;return S<=5?y[E]|=(w&7)<<S:(y[E]|=w<<S&255,y[E+1]=(w&7)>>8-S),T+3}function tr(y,T,w){var S=T&7,E=T>>>3;return w=(w&1)<<S,y[E]|=w,T+1}function Mt(y,T,w){var S=T&7,E=T>>>3;return w<<=S,y[E]|=w&255,w>>>=8,y[E+1]=w,T+8}function wl(y,T,w){var S=T&7,E=T>>>3;return w<<=S,y[E]|=w&255,w>>>=8,y[E+1]=w&255,y[E+2]=w>>>8,T+16}function Na(y,T){var w=y.length,S=2*w>T?2*w:T+5,E=0;if(w>=T)return y;if(Ae){var A=d0(S);if(y.copy)y.copy(A);else for(;E<y.length;++E)A[E]=y[E];return A}else if(fe){var L=new Uint8Array(S);if(L.set)L.set(y);else for(;E<w;++E)L[E]=y[E];return L}return y.length=S,y}function rr(y){for(var T=new Array(y),w=0;w<y;++w)T[w]=0;return T}function Zs(y,T,w){var S=1,E=0,A=0,L=0,K=0,j=y.length,W=fe?new Uint16Array(32):rr(32);for(A=0;A<32;++A)W[A]=0;for(A=j;A<w;++A)y[A]=0;j=y.length;var H=fe?new Uint16Array(j):rr(j);for(A=0;A<j;++A)W[E=y[A]]++,S<E&&(S=E),H[A]=0;for(W[0]=0,A=1;A<=S;++A)W[A+16]=K=K+W[A-1]<<1;for(A=0;A<j;++A)K=y[A],K!=0&&(H[A]=W[K+16]++);var te=0;for(A=0;A<j;++A)if(te=y[A],te!=0)for(K=we(H[A],S)>>S-te,L=(1<<S+4-te)-1;L>=0;--L)T[K|L<<te]=te&15|A<<4;return S}var Oa=fe?new Uint16Array(512):rr(512),Fa=fe?new Uint16Array(32):rr(32);if(!fe){for(var zr=0;zr<512;++zr)Oa[zr]=0;for(zr=0;zr<32;++zr)Fa[zr]=0}(function(){for(var y=[],T=0;T<32;T++)y.push(5);Zs(y,Fa,32);var w=[];for(T=0;T<=143;T++)w.push(8);for(;T<=255;T++)w.push(9);for(;T<=279;T++)w.push(7);for(;T<=287;T++)w.push(8);Zs(w,Oa,288)})();var iu=function(){for(var T=fe?new Uint8Array(32768):[],w=0,S=0;w<ue.length-1;++w)for(;S<ue[w+1];++S)T[S]=w;for(;S<32768;++S)T[S]=29;var E=fe?new Uint8Array(259):[];for(w=0,S=0;w<Y.length-1;++w)for(;S<Y[w+1];++S)E[S]=w;function A(K,j){for(var W=0;W<K.length;){var H=Math.min(65535,K.length-W),te=W+H==K.length;for(j.write_shift(1,+te),j.write_shift(2,H),j.write_shift(2,~H&65535);H-- >0;)j[j.l++]=K[W++]}return j.l}function L(K,j){for(var W=0,H=0,te=fe?new Uint16Array(32768):[];H<K.length;){var ae=Math.min(65535,K.length-H);if(ae<10){for(W=Vt(j,W,+(H+ae==K.length)),W&7&&(W+=8-(W&7)),j.l=W/8|0,j.write_shift(2,ae),j.write_shift(2,~ae&65535);ae-- >0;)j[j.l++]=K[H++];W=j.l*8;continue}W=Vt(j,W,+(H+ae==K.length)+2);for(var de=0;ae-- >0;){var re=K[H];de=(de<<5^re)&32767;var ce=-1,pe=0;if((ce=te[de])&&(ce|=H&-32768,ce>H&&(ce-=32768),ce<H))for(;K[ce+pe]==K[H+pe]&&pe<250;)++pe;if(pe>2){re=E[pe],re<=22?W=Mt(j,W,oe[re+1]>>1)-1:(Mt(j,W,3),W+=5,Mt(j,W,oe[re-23]>>5),W+=3);var We=re<8?0:re-4>>2;We>0&&(wl(j,W,pe-Y[re]),W+=We),re=T[H-ce],W=Mt(j,W,oe[re]>>3),W-=3;var He=re<4?0:re-2>>1;He>0&&(wl(j,W,H-ce-ue[re]),W+=He);for(var gt=0;gt<pe;++gt)te[de]=H&32767,de=(de<<5^K[H])&32767,++H;ae-=pe-1}else re<=143?re=re+48:W=tr(j,W,1),W=Mt(j,W,oe[re]),te[de]=H&32767,++H}W=Mt(j,W,0)-1}return j.l=(W+7)/8|0,j.l}return function(j,W){return j.length<8?A(j,W):L(j,W)}}();function kl(y){var T=X(50+Math.floor(y.length*1.1)),w=iu(y,T);return T.slice(0,w)}var Sl=fe?new Uint16Array(32768):rr(32768),Tl=fe?new Uint16Array(32768):rr(32768),El=fe?new Uint16Array(128):rr(128),Al=1,Cl=1;function au(y,T){var w=xe(y,T)+257;T+=5;var S=xe(y,T)+1;T+=5;var E=ne(y,T)+4;T+=4;for(var A=0,L=fe?new Uint8Array(19):rr(19),K=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],j=1,W=fe?new Uint8Array(8):rr(8),H=fe?new Uint8Array(8):rr(8),te=L.length,ae=0;ae<E;++ae)L[F[ae]]=A=ke(y,T),j<A&&(j=A),W[A]++,T+=3;var de=0;for(W[0]=0,ae=1;ae<=j;++ae)H[ae]=de=de+W[ae-1]<<1;for(ae=0;ae<te;++ae)(de=L[ae])!=0&&(K[ae]=H[de]++);var re=0;for(ae=0;ae<te;++ae)if(re=L[ae],re!=0){de=oe[K[ae]]>>8-re;for(var ce=(1<<7-re)-1;ce>=0;--ce)El[de|ce<<re]=re&7|ae<<3}var pe=[];for(j=1;pe.length<w+S;)switch(de=El[he(y,T)],T+=de&7,de>>>=3){case 16:for(A=3+at(y,T),T+=2,de=pe[pe.length-1];A-- >0;)pe.push(de);break;case 17:for(A=3+ke(y,T),T+=3;A-- >0;)pe.push(0);break;case 18:for(A=11+he(y,T),T+=7;A-- >0;)pe.push(0);break;default:pe.push(de),j<de&&(j=de);break}var We=pe.slice(0,w),He=pe.slice(w);for(ae=w;ae<286;++ae)We[ae]=0;for(ae=S;ae<30;++ae)He[ae]=0;return Al=Zs(We,Sl,286),Cl=Zs(He,Tl,30),T}function ou(y,T){if(y[0]==3&&!(y[1]&3))return[dn(T),2];for(var w=0,S=0,E=d0(T||1<<18),A=0,L=E.length>>>0,K=0,j=0;!(S&1);){if(S=ke(y,w),w+=3,S>>>1)S>>1==1?(K=9,j=5):(w=au(y,w),K=Al,j=Cl);else{w&7&&(w+=8-(w&7));var W=y[w>>>3]|y[(w>>>3)+1]<<8;if(w+=32,W>0)for(!T&&L<A+W&&(E=Na(E,A+W),L=E.length);W-- >0;)E[A++]=y[w>>>3],w+=8;continue}for(;;){!T&&L<A+32767&&(E=Na(E,A+32767),L=E.length);var H=tt(y,w,K),te=S>>>1==1?Oa[H]:Sl[H];if(w+=te&15,te>>>=4,!(te>>>8&255))E[A++]=te;else{if(te==256)break;te-=257;var ae=te<8?0:te-4>>2;ae>5&&(ae=0);var de=A+Y[te];ae>0&&(de+=tt(y,w,ae),w+=ae),H=tt(y,w,j),te=S>>>1==1?Fa[H]:Tl[H],w+=te&15,te>>>=4;var re=te<4?0:te-2>>1,ce=ue[te];for(re>0&&(ce+=tt(y,w,re),w+=re),!T&&L<de&&(E=Na(E,de+100),L=E.length);A<de;)E[A]=E[A-ce],++A}}}return T?[E,w+7>>>3]:[E.slice(0,A),w+7>>>3]}function Nl(y,T){var w=y.slice(y.l||0),S=ou(w,T);return y.l+=S[1],S[0]}function Ol(y,T){if(y)typeof console<"u"&&console.error(T);else throw new Error(T)}function Fl(y,T){var w=y;It(w,0);var S=[],E=[],A={FileIndex:S,FullPaths:E};C(A,{root:T.root});for(var L=w.length-4;(w[L]!=80||w[L+1]!=75||w[L+2]!=5||w[L+3]!=6)&&L>=0;)--L;w.l=L+4,w.l+=4;var K=w.read_shift(2);w.l+=6;var j=w.read_shift(4);for(w.l=j,L=0;L<K;++L){w.l+=20;var W=w.read_shift(4),H=w.read_shift(4),te=w.read_shift(2),ae=w.read_shift(2),de=w.read_shift(2);w.l+=8;var re=w.read_shift(4),ce=o(w.slice(w.l+te,w.l+te+ae));w.l+=te+ae+de;var pe=w.l;w.l=re+4,lu(w,W,H,A,ce),w.l=pe}return A}function lu(y,T,w,S,E){y.l+=2;var A=y.read_shift(2),L=y.read_shift(2),K=a(y);if(A&8257)throw new Error("Unsupported ZIP encryption");for(var j=y.read_shift(4),W=y.read_shift(4),H=y.read_shift(4),te=y.read_shift(2),ae=y.read_shift(2),de="",re=0;re<te;++re)de+=String.fromCharCode(y[y.l++]);if(ae){var ce=o(y.slice(y.l,y.l+ae));(ce[21589]||{}).mt&&(K=ce[21589].mt),((E||{})[21589]||{}).mt&&(K=E[21589].mt)}y.l+=ae;var pe=y.slice(y.l,y.l+W);switch(L){case 8:pe=U(y,H);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+L)}var We=!1;A&8&&(j=y.read_shift(4),j==134695760&&(j=y.read_shift(4),We=!0),W=y.read_shift(4),H=y.read_shift(4)),W!=T&&Ol(We,"Bad compressed size: "+T+" != "+W),H!=w&&Ol(We,"Bad uncompressed size: "+w+" != "+H),Da(S,de,pe,{unsafe:!0,mt:K})}function cu(y,T){var w=T||{},S=[],E=[],A=X(1),L=w.compression?8:0,K=0,j=0,W=0,H=0,te=0,ae=y.FullPaths[0],de=ae,re=y.FileIndex[0],ce=[],pe=0;for(j=1;j<y.FullPaths.length;++j)if(de=y.FullPaths[j].slice(ae.length),re=y.FileIndex[j],!(!re.size||!re.content||de=="Sh33tJ5")){var We=H,He=X(de.length);for(W=0;W<de.length;++W)He.write_shift(1,de.charCodeAt(W)&127);He=He.slice(0,He.l),ce[te]=qy.buf(re.content,0);var gt=re.content;L==8&&(gt=I(gt)),A=X(30),A.write_shift(4,67324752),A.write_shift(2,20),A.write_shift(2,K),A.write_shift(2,L),re.mt?i(A,re.mt):A.write_shift(4,0),A.write_shift(-4,ce[te]),A.write_shift(4,gt.length),A.write_shift(4,re.content.length),A.write_shift(2,He.length),A.write_shift(2,0),H+=A.length,S.push(A),H+=He.length,S.push(He),H+=gt.length,S.push(gt),A=X(46),A.write_shift(4,33639248),A.write_shift(2,0),A.write_shift(2,20),A.write_shift(2,K),A.write_shift(2,L),A.write_shift(4,0),A.write_shift(-4,ce[te]),A.write_shift(4,gt.length),A.write_shift(4,re.content.length),A.write_shift(2,He.length),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(4,0),A.write_shift(4,We),pe+=A.l,E.push(A),pe+=He.length,E.push(He),++te}return A=X(22),A.write_shift(4,101010256),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,te),A.write_shift(2,te),A.write_shift(4,pe),A.write_shift(4,H),A.write_shift(2,0),ht([ht(S),ht(E),A])}var Qs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function hu(y,T){if(y.ctype)return y.ctype;var w=y.name||"",S=w.match(/\.([^\.]+)$/);return S&&Qs[S[1]]||T&&(S=(w=T).match(/[\.\\]([^\.\\])+$/),S&&Qs[S[1]])?Qs[S[1]]:"application/octet-stream"}function du(y){for(var T=Rs(y),w=[],S=0;S<T.length;S+=76)w.push(T.slice(S,S+76));return w.join(`\r
`)+`\r
`}function fu(y){var T=y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(W){var H=W.charCodeAt(0).toString(16).toUpperCase();return"="+(H.length==1?"0"+H:H)});T=T.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),T.charAt(0)==`
`&&(T="=0D"+T.slice(1)),T=T.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var w=[],S=T.split(`\r
`),E=0;E<S.length;++E){var A=S[E];if(A.length==0){w.push("");continue}for(var L=0;L<A.length;){var K=76,j=A.slice(L,L+K);j.charAt(K-1)=="="?K--:j.charAt(K-2)=="="?K-=2:j.charAt(K-3)=="="&&(K-=3),j=A.slice(L,L+K),L+=K,L<A.length&&(j+="="),w.push(j)}}return w.join(`\r
`)}function uu(y){for(var T=[],w=0;w<y.length;++w){for(var S=y[w];w<=y.length&&S.charAt(S.length-1)=="=";)S=S.slice(0,S.length-1)+y[++w];T.push(S)}for(var E=0;E<T.length;++E)T[E]=T[E].replace(/[=][0-9A-Fa-f]{2}/g,function(A){return String.fromCharCode(parseInt(A.slice(1),16))});return qt(T.join(`\r
`))}function gu(y,T,w){for(var S="",E="",A="",L,K=0;K<10;++K){var j=T[K];if(!j||j.match(/^\s*$/))break;var W=j.match(/^(.*?):\s*([^\s].*)$/);if(W)switch(W[1].toLowerCase()){case"content-location":S=W[2].trim();break;case"content-type":A=W[2].trim();break;case"content-transfer-encoding":E=W[2].trim();break}}switch(++K,E.toLowerCase()){case"base64":L=qt(Sr(T.slice(K).join("")));break;case"quoted-printable":L=uu(T.slice(K));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+E)}var H=Da(y,S.slice(w.length),L,{unsafe:!0});A&&(H.ctype=A)}function mu(y,T){if(le(y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var w=T&&T.root||"",S=(Ae&&Buffer.isBuffer(y)?y.toString("binary"):le(y)).split(`\r
`),E=0,A="";for(E=0;E<S.length;++E)if(A=S[E],!!/^Content-Location:/i.test(A)&&(A=A.slice(A.indexOf("file")),w||(w=A.slice(0,A.lastIndexOf("/")+1)),A.slice(0,w.length)!=w))for(;w.length>0&&(w=w.slice(0,w.length-1),w=w.slice(0,w.lastIndexOf("/")+1),A.slice(0,w.length)!=w););var L=(S[1]||"").match(/boundary="(.*?)"/);if(!L)throw new Error("MAD cannot find boundary");var K="--"+(L[1]||""),j=[],W=[],H={FileIndex:j,FullPaths:W};C(H);var te,ae=0;for(E=0;E<S.length;++E){var de=S[E];de!==K&&de!==K+"--"||(ae++&&gu(H,S.slice(te,E),w),te=E)}return H}function xu(y,T){var w=T||{},S=w.boundary||"SheetJS";S="------="+S;for(var E=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+S.slice(2)+'"',"","",""],A=y.FullPaths[0],L=A,K=y.FileIndex[0],j=1;j<y.FullPaths.length;++j)if(L=y.FullPaths[j].slice(A.length),K=y.FileIndex[j],!(!K.size||!K.content||L=="Sh33tJ5")){L=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(pe){return"_x"+pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(pe){return"_u"+pe.charCodeAt(0).toString(16)+"_"});for(var W=K.content,H=Ae&&Buffer.isBuffer(W)?W.toString("binary"):le(W),te=0,ae=Math.min(1024,H.length),de=0,re=0;re<=ae;++re)(de=H.charCodeAt(re))>=32&&de<128&&++te;var ce=te>=ae*4/5;E.push(S),E.push("Content-Location: "+(w.root||"file:///C:/SheetJS/")+L),E.push("Content-Transfer-Encoding: "+(ce?"quoted-printable":"base64")),E.push("Content-Type: "+hu(K,L)),E.push(""),E.push(ce?fu(H):du(H))}return E.push(S+`--\r
`),E.join(`\r
`)}function pu(y){var T={};return C(T,y),T}function Da(y,T,w,S){var E=S&&S.unsafe;E||C(y);var A=!E&&Re.find(y,T);if(!A){var L=y.FullPaths[0];T.slice(0,L.length)==L?L=T:(L.slice(-1)!="/"&&(L+="/"),L=(L+T).replace("//","/")),A={name:s(T),type:2},y.FileIndex.push(A),y.FullPaths.push(L),E||Re.utils.cfb_gc(y)}return A.content=w,A.size=w?w.length:0,S&&(S.CLSID&&(A.clsid=S.CLSID),S.mt&&(A.mt=S.mt),S.ct&&(A.ct=S.ct)),A}function vu(y,T){C(y);var w=Re.find(y,T);if(w){for(var S=0;S<y.FileIndex.length;++S)if(y.FileIndex[S]==w)return y.FileIndex.splice(S,1),y.FullPaths.splice(S,1),!0}return!1}function yu(y,T,w){C(y);var S=Re.find(y,T);if(S){for(var E=0;E<y.FileIndex.length;++E)if(y.FileIndex[E]==S)return y.FileIndex[E].name=s(w),y.FullPaths[E]=w,!0}return!1}function _u(y){D(y,!0)}return e.find=z,e.read=P,e.parse=h,e.write=Ee,e.writeFile=B,e.utils={cfb_new:pu,cfb_add:Da,cfb_del:vu,cfb_mov:yu,cfb_gc:_u,ReadShift:Ts,CheckField:rf,prep_blob:It,bconcat:ht,use_zlib:N,_deflateRaw:kl,_inflateRaw:Nl,consts:ee},e}();function Jy(r){return typeof r=="string"?ba(r):Array.isArray(r)?ky(r):r}function Xs(r,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=ba(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?Ms(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var s=new Blob([Jy(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,r);if(typeof saveAs<"u")return saveAs(s,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:r,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=r,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Gs(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+r)}function ut(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function y0(r,e){for(var t=[],n=ut(r),s=0;s!==n.length;++s)t[r[n[s]][e]]==null&&(t[r[n[s]][e]]=n[s]);return t}function nl(r){for(var e=[],t=ut(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function Sa(r){for(var e=[],t=ut(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function Zy(r){for(var e=[],t=ut(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var Zi=new Date(1899,11,30,0,0,0);function Ct(r,e){var t=r.getTime(),n=Zi.getTime()+(r.getTimezoneOffset()-Zi.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Bd=new Date,Qy=Zi.getTime()+(Bd.getTimezoneOffset()-Zi.getTimezoneOffset())*6e4,_0=Bd.getTimezoneOffset();function Ud(r){var e=new Date;return e.setTime(r*24*60*60*1e3+Qy),e.getTimezoneOffset()!==_0&&e.setTime(e.getTime()+(e.getTimezoneOffset()-_0)*6e4),e}var b0=new Date("2017-02-19T19:06:09.000Z"),$d=isNaN(b0.getFullYear())?new Date("2/19/17"):b0,e_=$d.getFullYear()==2017;function bt(r,e){var t=new Date(r);if(e_)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if($d.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var s=r.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return r.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Ta(r,e){if(Ae&&Buffer.isBuffer(r))return r.toString("binary");if(typeof TextDecoder<"u")try{var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return t[i]||i})}catch{}for(var n=[],s=0;s!=r.length;++s)n.push(String.fromCharCode(r[s]));return n.join("")}function Nt(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=Nt(r[t]));return e}function ze(r,e){for(var t="";t.length<e;)t+=r;return t}function br(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return t=-t,i}),!isNaN(e=Number(n)))?e/t:e}var t_=["january","february","march","april","may","june","july","august","september","october","november","december"];function js(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return t;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&t_.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return n<0||n>8099?t:(s>0||i>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}function _e(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return Ae?n=Er(t):n=Sy(t),Re.utils.cfb_add(r,e,n)}Re.utils.cfb_add(r,e,t)}else r.file(e,t)}function sl(){return Re.utils.cfb_new()}var Ze=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,r_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},il=nl(r_),al=/[&<>'"]/g,n_=/[\u0000-\u0008\u000b-\u001f]/g;function Ie(r){var e=r+"";return e.replace(al,function(t){return il[t]}).replace(n_,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function w0(r){return Ie(r).replace(/ /g,"_x0020_")}var Wd=/[\u0000-\u001f]/g;function s_(r){var e=r+"";return e.replace(al,function(t){return il[t]}).replace(/\n/g,"<br/>").replace(Wd,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function i_(r){var e=r+"";return e.replace(al,function(t){return il[t]}).replace(Wd,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function a_(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function o_(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function to(r){for(var e="",t=0,n=0,s=0,i=0,a=0,o=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(s=r.charCodeAt(t++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=r.charCodeAt(t++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function k0(r){var e=dn(2*r.length),t,n,s=1,i=0,a=0,o;for(n=0;n<r.length;n+=s)s=1,(o=r.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(r.charCodeAt(n+1)&63),s=2):o<240?(t=(o&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),s=3):(s=4,t=(o&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=t%256,e[i++]=t>>>8;return e.slice(0,i).toString("ucs2")}function S0(r){return Er(r,"binary").toString("utf8")}var wi="foo bar bazâð£",Ss=Ae&&(S0(wi)==to(wi)&&S0||k0(wi)==to(wi)&&k0)||to,Ms=Ae?function(r){return Er(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,s=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},l_=function(){var r=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<r.length;++s)n=n.replace(r[s][0],r[s][1]);return n}}(),Hd=/(^\s|\s$|\n)/;function dt(r,e){return"<"+r+(e.match(Hd)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function Ls(r){return ut(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function se(r,e,t){return"<"+r+(t!=null?Ls(t):"")+(e!=null?(e.match(Hd)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function Oo(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function c_(r,e){switch(typeof r){case"string":var t=se("vt:lpwstr",Ie(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return se((r|0)==r?"vt:i4":"vt:r8",Ie(String(r)));case"boolean":return se("vt:bool",r?"true":"false")}if(r instanceof Date)return se("vt:filetime",Oo(r));throw new Error("Unable to serialize "+r)}var nt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Gn=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function h_(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),s=r[e+6]&15,i=5;i>=0;--i)s=s*256+r[e+i];return n==2047?s==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),t*Math.pow(2,n-52)*s)}function d_(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)r[t+o]=i&255;r[t+6]=(s&15)<<4|i&15,r[t+7]=s>>4|n}var T0=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var s=0,i=r[0][n].length;s<i;s+=t)e.push.apply(e,r[0][n].slice(s,s+t));return e},E0=Ae?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:Er(e)})):T0(r)}:T0,A0=function(r,e,t){for(var n=[],s=e;s<t;s+=2)n.push(String.fromCharCode(us(r,s)));return n.join("").replace(ks,"")},ol=Ae?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(ks,""):A0(r,e,t)}:A0,C0=function(r,e,t){for(var n=[],s=e;s<e+t;++s)n.push(("0"+r[s].toString(16)).slice(-2));return n.join("")},zd=Ae?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):C0(r,e,t)}:C0,N0=function(r,e,t){for(var n=[],s=e;s<t;s++)n.push(String.fromCharCode(Fn(r,s)));return n.join("")},Ks=Ae?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):N0(e,t,n)}:N0,Vd=function(r,e){var t=Rt(r,e);return t>0?Ks(r,e+4,e+4+t-1):""},Gd=Vd,Xd=function(r,e){var t=Rt(r,e);return t>0?Ks(r,e+4,e+4+t-1):""},Kd=Xd,Yd=function(r,e){var t=2*Rt(r,e);return t>0?Ks(r,e+4,e+4+t-1):""},qd=Yd,Jd=function(e,t){var n=Rt(e,t);return n>0?ol(e,t+4,t+4+n):""},Zd=Jd,Qd=function(r,e){var t=Rt(r,e);return t>0?Ks(r,e+4,e+4+t):""},ef=Qd,tf=function(r,e){return h_(r,e)},Qi=tf,ll=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ae&&(Gd=function(e,t){if(!Buffer.isBuffer(e))return Vd(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Kd=function(e,t){if(!Buffer.isBuffer(e))return Xd(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},qd=function(e,t){if(!Buffer.isBuffer(e))return Yd(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},Zd=function(e,t){if(!Buffer.isBuffer(e))return Jd(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},ef=function(e,t){if(!Buffer.isBuffer(e))return Qd(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},Qi=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):tf(e,t)},ll=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Fn=function(r,e){return r[e]},us=function(r,e){return r[e+1]*256+r[e]},f_=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},Rt=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},rn=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},u_=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function Ts(r,e){var t="",n,s,i=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Ae&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(l=0;l<r;++l)t+=String.fromCharCode(us(this,c)),c+=2;r*=2;break;case"utf8":t=Ks(this,this.l,this.l+r);break;case"utf16le":r*=2,t=ol(this,this.l,this.l+r);break;case"wstr":return Ts.call(this,r,"dbcs");case"lpstr-ansi":t=Gd(this,this.l),r=4+Rt(this,this.l);break;case"lpstr-cp":t=Kd(this,this.l),r=4+Rt(this,this.l);break;case"lpwstr":t=qd(this,this.l),r=4+2*Rt(this,this.l);break;case"lpp4":r=4+Rt(this,this.l),t=Zd(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+Rt(this,this.l),t=ef(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(a=Fn(this,this.l+r++))!==0;)i.push(yi(a));t=i.join("");break;case"_wstr":for(r=0,t="";(a=us(this,this.l+r))!==0;)i.push(yi(a)),r+=2;r+=2,t=i.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<r;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Fn(this,c),this.l=c+1,o=Ts.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(yi(us(this,c))),c+=2}t=i.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,l=0;l!=r;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Fn(this,c),this.l=c+1,o=Ts.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(yi(Fn(this,c))),c+=1}t=i.join("");break;default:switch(r){case 1:return n=Fn(this,this.l),this.l++,n;case 2:return n=(e==="i"?f_:us)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(r>0?rn:u_)(this,this.l),this.l+=4,n):(s=Rt(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return r==8?s=Qi(this,this.l):s=Qi([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;r=8;case 16:t=zd(this,this.l,r);break}}return this.l+=r,t}var g_=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},m_=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},x_=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function p_(r,e,t){var n=0,s=0;if(t==="dbcs"){for(s=0;s!=e.length;++s)x_(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(t==="hex"){for(;s<r;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var i=Math.min(this.l+r,this.length);for(s=0;s<Math.min(e.length,r);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,g_(this,e,this.l);break;case 8:if(n=8,t==="f"){d_(this,e,this.l);break}case 16:break;case-4:n=4,m_(this,e,this.l);break}return this.l+=n,this}function rf(r,e){var t=zd(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function It(r,e){r.l=e,r.read_shift=Ts,r.chk=rf,r.write_shift=p_}function hr(r,e){r.l+=e}function X(r){var e=dn(r);return It(e,0),e}function At(){var r=[],e=Ae?256:2048,t=function(c){var h=X(c);return It(h,0),h},n=t(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=t(Math.max(c+1,e)))},a=function(){return s(),ht(r)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:r}}function q(r,e,t,n){var s=+e,i;if(!isNaN(s)){n||(n=hT[s].p||(t||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var a=r.next(i);s<=127?a.write_shift(1,s):(a.write_shift(1,(s&127)+128),a.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&ll(t)&&r.push(t)}}function Es(r,e,t){var n=Nt(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function O0(r,e,t){var n=Nt(r);return n.s=Es(n.s,e.s,t),n.e=Es(n.e,e.s,t),n}function As(r,e){if(r.cRel&&r.c<0)for(r=Nt(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=Nt(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=Pe(r);return!r.cRel&&r.cRel!=null&&(t=__(t)),!r.rRel&&r.rRel!=null&&(t=v_(t)),t}function ro(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+pt(r.s.c)+":"+(r.e.cRel?"":"$")+pt(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+ft(r.s.r)+":"+(r.e.rRel?"":"$")+ft(r.e.r):As(r.s,e.biff)+":"+As(r.e,e.biff)}function cl(r){return parseInt(y_(r),10)-1}function ft(r){return""+(r+1)}function v_(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function y_(r){return r.replace(/\$(\d+)$/,"$1")}function hl(r){for(var e=b_(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function pt(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function __(r){return r.replace(/^([A-Z])/,"$$$1")}function b_(r){return r.replace(/^\$([A-Z])/,"$1")}function w_(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function st(r){for(var e=0,t=0,n=0;n<r.length;++n){var s=r.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:e-1}}function Pe(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function jt(r){var e=r.indexOf(":");return e==-1?{s:st(r),e:st(r)}:{s:st(r.slice(0,e)),e:st(r.slice(e+1))}}function Je(r,e){return typeof e>"u"||typeof e=="number"?Je(r.s,r.e):(typeof r!="string"&&(r=Pe(r)),typeof e!="string"&&(e=Pe(e)),r==e?r:r+":"+e)}function $e(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,s=0,i=r.length;for(t=0;n<i&&!((s=r.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(e.s.c=--t,t=0;n<i&&!((s=r.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;if(e.s.r=--t,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=i&&!((s=r.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(e.e.c=--t,t=0;n!=i&&!((s=r.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;return e.e.r=--t,e}function F0(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=Br(r.z,t?Ct(e):e)}catch{}try{return r.w=Br((r.XF||{}).numFmtId||(t?14:0),t?Ct(e):e)}catch{return""+e}}function Tr(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?Ys[r.v]||r.v:e==null?F0(r,r.v):F0(r,e))}function mn(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function nf(r,e,t){var n=t||{},s=r?Array.isArray(r):n.dense,i=r||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?st(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=$e(i["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(c.e.r=a=h.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=e[f].length;++u)if(!(typeof e[f][u]>"u")){var g={v:e[f][u]},p=a+f,m=o+u;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),e[f][u]&&typeof e[f][u]=="object"&&!Array.isArray(e[f][u])&&!(e[f][u]instanceof Date))g=e[f][u];else if(Array.isArray(g.v)&&(g.f=e[f][u][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||Ve[14],n.cellDates?(g.t="d",g.w=Br(g.z,Ct(g.v))):(g.t="n",g.v=Ct(g.v),g.w=Br(g.z,g.v))):g.t="s";if(s)i[p]||(i[p]=[]),i[p][m]&&i[p][m].z&&(g.z=i[p][m].z),i[p][m]=g;else{var x=Pe({c:m,r:p});i[x]&&i[x].z&&(g.z=i[x].z),i[x]=g}}}return c.s.c<1e7&&(i["!ref"]=Je(c)),i}function Xn(r,e){return nf(null,r,e)}function k_(r){return r.read_shift(4,"i")}function Zt(r,e){return e||(e=X(4)),e.write_shift(4,r),e}function vt(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function it(r,e){var t=!1;return e==null&&(t=!0,e=X(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function S_(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function T_(r,e){return e||(e=X(4)),e.write_shift(2,0),e.write_shift(2,0),e}function dl(r,e){var t=r.l,n=r.read_shift(1),s=vt(r),i=[],a={t:s,h:s};if(n&1){for(var o=r.read_shift(4),l=0;l!=o;++l)i.push(S_(r));a.r=i}else a.r=[{ich:0,ifnt:0}];return r.l=t+e,a}function E_(r,e){var t=!1;return e==null&&(t=!0,e=X(15+4*r.t.length)),e.write_shift(1,0),it(r.t,e),t?e.slice(0,e.l):e}var A_=dl;function C_(r,e){var t=!1;return e==null&&(t=!0,e=X(23+4*r.t.length)),e.write_shift(1,1),it(r.t,e),e.write_shift(4,1),T_({ich:0,ifnt:0},e),t?e.slice(0,e.l):e}function zt(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function xn(r,e){return e==null&&(e=X(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function pn(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function vn(r,e){return e==null&&(e=X(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var N_=vt,sf=it;function fl(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function ea(r,e){var t=!1;return e==null&&(t=!0,e=X(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var O_=vt,Fo=fl,ul=ea;function af(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var s=n===0?Qi([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):rn(e,0)>>2;return t?s/100:s}function of(r,e){e==null&&(e=X(4));var t=0,n=0,s=r*100;if(r==(r|0)&&r>=-(1<<29)&&r<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?s:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function lf(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function F_(r,e){return e||(e=X(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var yn=lf,Kn=F_;function Yn(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function fn(r,e){return(e||X(8)).write_shift(8,r,"f")}function D_(r){var e={},t=r.read_shift(1),n=t>>>1,s=r.read_shift(1),i=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),l=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=$_[s];c&&(e.rgb=W0(c));break;case 2:e.rgb=W0([a,o,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function ta(r,e){if(e||(e=X(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function I_(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function P_(r,e){e||(e=X(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var cf=2,Dt=3,ki=11,ra=19,Si=64,R_=65,j_=71,M_=4108,L_=4126,lt=80,D0={1:{n:"CodePage",t:cf},2:{n:"Category",t:lt},3:{n:"PresentationFormat",t:lt},4:{n:"ByteCount",t:Dt},5:{n:"LineCount",t:Dt},6:{n:"ParagraphCount",t:Dt},7:{n:"SlideCount",t:Dt},8:{n:"NoteCount",t:Dt},9:{n:"HiddenCount",t:Dt},10:{n:"MultimediaClipCount",t:Dt},11:{n:"ScaleCrop",t:ki},12:{n:"HeadingPairs",t:M_},13:{n:"TitlesOfParts",t:L_},14:{n:"Manager",t:lt},15:{n:"Company",t:lt},16:{n:"LinksUpToDate",t:ki},17:{n:"CharacterCount",t:Dt},19:{n:"SharedDoc",t:ki},22:{n:"HyperlinksChanged",t:ki},23:{n:"AppVersion",t:Dt,p:"version"},24:{n:"DigSig",t:R_},26:{n:"ContentType",t:lt},27:{n:"ContentStatus",t:lt},28:{n:"Language",t:lt},29:{n:"Version",t:lt},255:{},2147483648:{n:"Locale",t:ra},2147483651:{n:"Behavior",t:ra},1919054434:{}},I0={1:{n:"CodePage",t:cf},2:{n:"Title",t:lt},3:{n:"Subject",t:lt},4:{n:"Author",t:lt},5:{n:"Keywords",t:lt},6:{n:"Comments",t:lt},7:{n:"Template",t:lt},8:{n:"LastAuthor",t:lt},9:{n:"RevNumber",t:lt},10:{n:"EditTime",t:Si},11:{n:"LastPrinted",t:Si},12:{n:"CreatedDate",t:Si},13:{n:"ModifiedDate",t:Si},14:{n:"PageCount",t:Dt},15:{n:"WordCount",t:Dt},16:{n:"CharCount",t:Dt},17:{n:"Thumbnail",t:j_},18:{n:"Application",t:lt},19:{n:"DocSecurity",t:Dt},255:{},2147483648:{n:"Locale",t:ra},2147483651:{n:"Behavior",t:ra},1919054434:{}};function B_(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var U_=B_([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),$_=Nt(U_),Ys={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},W_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ti={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function hf(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function df(r,e){var t=Zy(W_),n=[],s;n[n.length]=Ze,n[n.length]=se("Types",null,{xmlns:nt.CT,"xmlns:xsd":nt.xsd,"xmlns:xsi":nt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return se("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){r[l]&&r[l].length>0&&(s=r[l][0],n[n.length]=se("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Ti[l][e.bookType]||Ti[l].xlsx}))},a=function(l){(r[l]||[]).forEach(function(c){n[n.length]=se("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Ti[l][e.bookType]||Ti[l].xlsx})})},o=function(l){(r[l]||[]).forEach(function(c){n[n.length]=se("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:t[l][0]})})};return i("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Se={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ff(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function jn(r){var e=[Ze,se("Relationships",null,{xmlns:nt.RELS})];return ut(r["!id"]).forEach(function(t){e[e.length]=se("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Oe(r,e,t,n,s,i){if(s||(s={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=t,[Se.HLINK,Se.XPATH,Se.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),r["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][s.Id]=s,r[("/"+s.Target).replace("//","/")]=s,e}function H_(r){var e=[Ze];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function P0(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function z_(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function V_(r){var e=[Ze];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(P0(r[t][0],r[t][1])),e.push(z_("",r[t][0]));return e.push(P0("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function uf(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ki.version+"</meta:generator></office:meta></office:document-meta>"}var ln=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function no(r,e,t,n,s){s[r]!=null||e==null||e===""||(s[r]=e,e=Ie(e),n[n.length]=t?se(r,e,t):dt(r,e))}function gf(r,e){var t=e||{},n=[Ze,se("cp:coreProperties",null,{"xmlns:cp":nt.CORE_PROPS,"xmlns:dc":nt.dc,"xmlns:dcterms":nt.dcterms,"xmlns:dcmitype":nt.dcmitype,"xmlns:xsi":nt.xsi})],s={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&no("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:Oo(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),r.ModifiedDate!=null&&no("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:Oo(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=ln.length;++i){var a=ln[i],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:r?r[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&no(a[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Mn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],mf=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function xf(r){var e=[],t=se;return r||(r={}),r.Application="SheetJS",e[e.length]=Ze,e[e.length]=se("Properties",null,{xmlns:nt.EXT_PROPS,"xmlns:vt":nt.vt}),Mn.forEach(function(n){if(r[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Ie(String(r[n[1]]));break;case"bool":s=r[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=t(n[0],s))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+Ie(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function pf(r){var e=[Ze,se("Properties",null,{xmlns:nt.CUST_PROPS,"xmlns:vt":nt.vt})];if(!r)return e.join("");var t=1;return ut(r).forEach(function(s){++t,e[e.length]=se("property",c_(r[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Ie(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var R0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function G_(r,e){var t=[];return ut(R0).map(function(n){for(var s=0;s<ln.length;++s)if(ln[s][1]==n)return ln[s];for(s=0;s<Mn.length;++s)if(Mn[s][1]==n)return Mn[s];throw n}).forEach(function(n){if(r[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(dt(R0[n[1]]||n[1],s))}}),se("DocumentProperties",t.join(""),{xmlns:Pt.o})}function X_(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return r&&ut(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)){for(var a=0;a<ln.length;++a)if(i==ln[a][1])return;for(a=0;a<Mn.length;++a)if(i==Mn[a][1])return;for(a=0;a<t.length;++a)if(i==t[a])return;var o=r[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),s.push(se(w0(i),o,{"dt:dt":l}))}}),e&&ut(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(r&&Object.prototype.hasOwnProperty.call(r,i))){var a=e[i],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),s.push(se(w0(i),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Pt.o+'">'+s.join("")+"</"+n+">"}function K_(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),s=(t-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var a=X(8);return a.write_shift(4,n),a.write_shift(4,s),a}function j0(r,e){var t=X(4),n=X(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=X(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=K_(e);break;case 31:case 80:for(n=X(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return ht([t,n])}var vf=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Y_(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function M0(r,e,t){var n=X(8),s=[],i=[],a=8,o=0,l=X(8),c=X(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),s.push(c),a+=8+l.length,!e){c=X(8),c.write_shift(4,0),s.unshift(c);var h=[X(4)];for(h[0].write_shift(4,r.length),o=0;o<r.length;++o){var f=r[o][0];for(l=X(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=ht(h),i.unshift(l),a+=8+l.length}for(o=0;o<r.length;++o)if(!(e&&!e[r[o][0]])&&!(vf.indexOf(r[o][0])>-1||mf.indexOf(r[o][0])>-1)&&r[o][1]!=null){var u=r[o][1],g=0;if(e){g=+e[r[o][0]];var p=t[g];if(p.p=="version"&&typeof u=="string"){var m=u.split(".");u=(+m[0]<<16)+(+m[1]||0)}l=j0(p.t,u)}else{var x=Y_(u);x==-1&&(x=31,u=String(u)),l=j0(x,u)}i.push(l),c=X(8),c.write_shift(4,e?g:2+o),s.push(c),a+=8+l.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)s[o].write_shift(4,v),v+=i[o].length;return n.write_shift(4,a),n.write_shift(4,i.length),ht([n].concat(s).concat(i))}function L0(r,e,t,n,s,i){var a=X(s?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Re.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,s?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,s?68:48);var l=M0(r,t,n);if(o.push(l),s){var c=M0(s,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+l.length),o.push(c)}return ht(o)}function q_(r,e){e||(e=X(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function J_(r,e){return r.read_shift(e)===1}function _t(r,e){return e||(e=X(2)),e.write_shift(2,+!!r),e}function yf(r){return r.read_shift(2,"u")}function Ut(r,e){return e||(e=X(2)),e.write_shift(2,r),e}function _f(r,e,t){return t||(t=X(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function bf(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var i=r.read_shift(1);i&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var a=n?r.read_shift(n,s):"";return a}function Z_(r){var e=r.t||"",t=X(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=X(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[t,n];return ht(s)}function Q_(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var s=r.read_shift(1);return s===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function eb(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):Q_(r,n,t)}function tb(r,e,t){if(t.biff>5)return eb(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function wf(r,e,t){return t||(t=X(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function B0(r,e){e||(e=X(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function rb(r){var e=X(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(i==28)n=n.slice(1),B0(n,e);else if(i&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),i&8&&B0(s>-1?n.slice(s+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),t=0;t<n.length-3*l;++t)e.write_shift(1,n.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function un(r,e,t,n){return n||(n=X(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function nb(r,e,t){var n=t.biff>8?4:2,s=r.read_shift(n),i=r.read_shift(n,"i"),a=r.read_shift(n,"i");return[s,i,a]}function sb(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),s=r.read_shift(2);return{s:{c:n,r:e},e:{c:s,r:t}}}function kf(r,e){return e||(e=X(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function gl(r,e,t){var n=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=X(s);return i.write_shift(2,n),i.write_shift(2,e),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function ib(r,e){var t=!e||e.biff==8,n=X(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function ab(r,e){var t=!e||e.biff>=8?2:1,n=X(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function ob(r,e){var t=X(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],s=0;s<r.length;++s)n[s]=Z_(r[s]);var i=ht([t].concat(n));return i.parts=[t.length].concat(n.map(function(a){return a.length})),i}function lb(){var r=X(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function cb(r){var e=X(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function hb(r,e){var t=r.name||"Arial",n=e&&e.biff==5,s=n?15+t.length:16+2*t.length,i=X(s);return i.write_shift(2,(r.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,t.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),i}function db(r,e,t,n){var s=X(10);return un(r,e,n,s),s.write_shift(4,t),s}function fb(r,e,t,n,s){var i=!s||s.biff==8,a=X(8+ +i+(1+i)*t.length);return un(r,e,n,a),a.write_shift(2,t.length),i&&a.write_shift(1,1),a.write_shift((1+i)*t.length,t,i?"utf16le":"sbcs"),a}function ub(r,e,t,n){var s=t&&t.biff==5;n||(n=X(s?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function gb(r,e){var t=e.biff==8||!e.biff?4:2,n=X(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function U0(r,e,t,n){var s=t&&t.biff==5;n||(n=X(s?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var i=0;return r.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function mb(r){var e=X(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function xb(r,e,t,n,s,i){var a=X(8);return un(r,e,n,a),_f(t,i,a),a}function pb(r,e,t,n){var s=X(14);return un(r,e,n,s),fn(t,s),s}function vb(r,e,t){if(t.biff<8)return yb(r,e,t);for(var n=[],s=r.l+e,i=r.read_shift(t.biff>8?4:2);i--!==0;)n.push(nb(r,t.biff>8?12:6,t));if(r.l!=s)throw new Error("Bad ExternSheet: "+r.l+" != "+s);return n}function yb(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=bf(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function _b(r){var e=X(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)kf(r[t],e);return e}function bb(r){var e=X(24),t=st(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return ht([e,rb(r[1])])}function wb(r){var e=r[1].Tooltip,t=X(10+2*(e.length+1));t.write_shift(2,2048);var n=st(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var s=0;s<e.length;++s)t.write_shift(2,e.charCodeAt(s));return t.write_shift(2,0),t}function kb(r){return r||(r=X(4)),r.write_shift(2,1),r.write_shift(2,1),r}function Sb(r,e,t){if(!t.cellStyles)return hr(r,e);var n=t&&t.biff>=12?4:2,s=r.read_shift(n),i=r.read_shift(n),a=r.read_shift(n),o=r.read_shift(n),l=r.read_shift(2);n==2&&(r.l+=2);var c={s,e:i,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function Tb(r,e){var t=X(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function Eb(r){for(var e=X(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}function Ab(r,e,t){var n=X(15);return Js(n,r,e),n.write_shift(8,t,"f"),n}function Cb(r,e,t){var n=X(9);return Js(n,r,e),n.write_shift(2,t),n}var Nb=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=nl({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var c=[],h=dn(1);switch(l.type){case"base64":h=qt(Sr(o));break;case"binary":h=qt(o);break;case"buffer":case"array":h=o;break}It(h,0);var f=h.read_shift(1),u=!!(f&136),g=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:g=!0,u=!0;break;case 49:g=!0,u=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,x=521;f==2&&(m=h.read_shift(2)),h.l+=3,f!=2&&(m=h.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(x=h.read_shift(2));var v=h.read_shift(2),b=l.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(b=r[h[h.l]]),h.l+=1,h.l+=2),p&&(h.l+=36);for(var _=[],k={},O=Math.min(h.length,f==2?521:x-10-(g?264:0)),P=p?32:11;h.l<O&&h[h.l]!=13;)switch(k={},k.name=tn.utils.decode(b,h.slice(h.l,h.l+P)).replace(/[\u0000\r\n].*$/g,""),h.l+=P,k.type=String.fromCharCode(h.read_shift(1)),f!=2&&!p&&(k.offset=h.read_shift(4)),k.len=h.read_shift(1),f==2&&(k.offset=h.read_shift(2)),k.dec=h.read_shift(1),k.name.length&&_.push(k),f!=2&&(h.l+=p?13:14),k.type){case"B":(!g||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(h[h.l]!==13&&(h.l=x-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=x;var C=0,R=0;for(c[0]=[],R=0;R!=_.length;++R)c[0][R]=_[R].name;for(;m-- >0;){if(h[h.l]===42){h.l+=v;continue}for(++h.l,c[++C]=[],R=0,R=0;R!=_.length;++R){var D=h.slice(h.l,h.l+_[R].len);h.l+=_[R].len,It(D,0);var M=tn.utils.decode(b,D);switch(_[R].type){case"C":M.trim().length&&(c[C][R]=M.replace(/\s+$/,""));break;case"D":M.length===8?c[C][R]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):c[C][R]=M;break;case"F":c[C][R]=parseFloat(M.trim());break;case"+":case"I":c[C][R]=p?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":c[C][R]=!0;break;case"N":case"F":c[C][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[C][R]="##MEMO##"+(p?parseInt(M.trim(),10):D.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(c[C][R]=+M||0);break;case"@":c[C][R]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":c[C][R]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":c[C][R]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[C][R]=-D.read_shift(-8,"f");break;case"B":if(g&&_[R].len==8){c[C][R]=D.read_shift(8,"f");break}case"G":case"P":D.l+=_[R].len;break;case"0":if(_[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[R].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var h=Xn(t(o,c),c);return h["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,h}function s(o,l){try{return mn(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Ps(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var h=At(),f=oa(o,{header:1,raw:!0,cellDates:!0}),u=f[0],g=f.slice(1),p=o["!cols"]||[],m=0,x=0,v=0,b=1;for(m=0;m<u.length;++m){if(((p[m]||{}).DBF||{}).name){u[m]=p[m].DBF.name,++v;continue}if(u[m]!=null){if(++v,typeof u[m]=="number"&&(u[m]=u[m].toString(10)),typeof u[m]!="string")throw new Error("DBF Invalid column name "+u[m]+" |"+typeof u[m]+"|");if(u.indexOf(u[m])!==m){for(x=0;x<1024;++x)if(u.indexOf(u[m]+"_"+x)==-1){u[m]+="_"+x;break}}}}var _=$e(o["!ref"]),k=[],O=[],P=[];for(m=0;m<=_.e.c-_.s.c;++m){var C="",R="",D=0,M=[];for(x=0;x<g.length;++x)g[x][m]!=null&&M.push(g[x][m]);if(M.length==0||u[m]==null){k[m]="?";continue}for(x=0;x<M.length;++x){switch(typeof M[x]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=M[x]instanceof Date?"D":"C";break;default:R="C"}D=Math.max(D,String(M[x]).length),C=C&&C!=R?"C":R}D>250&&(D=250),R=((p[m]||{}).DBF||{}).type,R=="C"&&p[m].DBF.len>D&&(D=p[m].DBF.len),C=="B"&&R=="N"&&(C="N",P[m]=p[m].DBF.dec,D=p[m].DBF.len),O[m]=C=="C"||R=="N"?D:i[C]||0,b+=O[m],k[m]=C}var z=h.next(32);for(z.write_shift(4,318902576),z.write_shift(4,g.length),z.write_shift(2,296+32*v),z.write_shift(2,b),m=0;m<4;++m)z.write_shift(4,0);for(z.write_shift(4,0|(+e[Sd]||3)<<8),m=0,x=0;m<u.length;++m)if(u[m]!=null){var G=h.next(32),Z=(u[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,Z,"sbcs"),G.write_shift(1,k[m]=="?"?"C":k[m],"sbcs"),G.write_shift(4,x),G.write_shift(1,O[m]||i[k[m]]||0),G.write_shift(1,P[m]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),x+=O[m]||i[k[m]]||0}var Q=h.next(264);for(Q.write_shift(4,13),m=0;m<65;++m)Q.write_shift(4,0);for(m=0;m<g.length;++m){var V=h.next(b);for(V.write_shift(1,0),x=0;x<u.length;++x)if(u[x]!=null)switch(k[x]){case"L":V.write_shift(1,g[m][x]==null?63:g[m][x]?84:70);break;case"B":V.write_shift(8,g[m][x]||0,"f");break;case"N":var me="0";for(typeof g[m][x]=="number"&&(me=g[m][x].toFixed(P[x]||0)),v=0;v<O[x]-me.length;++v)V.write_shift(1,32);V.write_shift(1,me,"sbcs");break;case"D":g[m][x]?(V.write_shift(4,("0000"+g[m][x].getFullYear()).slice(-4),"sbcs"),V.write_shift(2,("00"+(g[m][x].getMonth()+1)).slice(-2),"sbcs"),V.write_shift(2,("00"+g[m][x].getDate()).slice(-2),"sbcs")):V.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(g[m][x]!=null?g[m][x]:"").slice(0,O[x]);for(V.write_shift(1,ee,"sbcs"),v=0;v<O[x]-ee.length;++v)V.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),Ob=function(){var r={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ut(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(u,g){var p=r[g];return typeof p=="number"?h0(p):p},n=function(u,g,p){var m=g.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?u:h0(m)};r["|"]=254;function s(u,g){switch(g.type){case"base64":return i(Sr(u),g);case"binary":return i(u,g);case"buffer":return i(Ae&&Buffer.isBuffer(u)?u.toString("binary"):Gs(u),g);case"array":return i(Ta(u),g)}throw new Error("Unrecognized type "+g.type)}function i(u,g){var p=u.split(/[\n\r]+/),m=-1,x=-1,v=0,b=0,_=[],k=[],O=null,P={},C=[],R=[],D=[],M=0,z;for(+g.codepage>=0&&Ps(+g.codepage);v!==p.length;++v){M=0;var G=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),Z=G.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),Q=Z[0],V;if(G.length>0)switch(Q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Z[1].charAt(0)=="P"&&k.push(G.slice(3).replace(/;;/g,";"));break;case"C":var me=!1,ee=!1,B=!1,le=!1,Ee=-1,Me=-1;for(b=1;b<Z.length;++b)switch(Z[b].charAt(0)){case"A":break;case"X":x=parseInt(Z[b].slice(1))-1,ee=!0;break;case"Y":for(m=parseInt(Z[b].slice(1))-1,ee||(x=0),z=_.length;z<=m;++z)_[z]=[];break;case"K":V=Z[b].slice(1),V.charAt(0)==='"'?V=V.slice(1,V.length-1):V==="TRUE"?V=!0:V==="FALSE"?V=!1:isNaN(br(V))?isNaN(js(V).getDate())||(V=bt(V)):(V=br(V),O!==null&&jd(O)&&(V=Ud(V))),me=!0;break;case"E":le=!0;var N=Cw(Z[b].slice(1),{r:m,c:x});_[m][x]=[_[m][x],N];break;case"S":B=!0,_[m][x]=[_[m][x],"S5S"];break;case"G":break;case"R":Ee=parseInt(Z[b].slice(1))-1;break;case"C":Me=parseInt(Z[b].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+G)}if(me&&(_[m][x]&&_[m][x].length==2?_[m][x][0]=V:_[m][x]=V,O=null),B){if(le)throw new Error("SYLK shared formula cannot have own formula");var U=Ee>-1&&_[Ee][Me];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");_[m][x][1]=Nw(U[1],{r:m-Ee,c:x-Me})}break;case"F":var I=0;for(b=1;b<Z.length;++b)switch(Z[b].charAt(0)){case"X":x=parseInt(Z[b].slice(1))-1,++I;break;case"Y":for(m=parseInt(Z[b].slice(1))-1,z=_.length;z<=m;++z)_[z]=[];break;case"M":M=parseInt(Z[b].slice(1))/20;break;case"F":break;case"G":break;case"P":O=k[parseInt(Z[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=Z[b].slice(1).split(" "),z=parseInt(D[0],10);z<=parseInt(D[1],10);++z)M=parseInt(D[2],10),R[z-1]=M===0?{hidden:!0}:{wch:M},ml(R[z-1]);break;case"C":x=parseInt(Z[b].slice(1))-1,R[x]||(R[x]={});break;case"R":m=parseInt(Z[b].slice(1))-1,C[m]||(C[m]={}),M>0?(C[m].hpt=M,C[m].hpx=Cf(M)):M===0&&(C[m].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+G)}I<1&&(O=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+G)}}return C.length>0&&(P["!rows"]=C),R.length>0&&(P["!cols"]=R),g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),[_,P]}function a(u,g){var p=s(u,g),m=p[0],x=p[1],v=Xn(m,g);return ut(x).forEach(function(b){v[b]=x[b]}),v}function o(u,g){return mn(a(u,g),g)}function l(u,g,p,m){var x="C;Y"+(p+1)+";X"+(m+1)+";K";switch(u.t){case"n":x+=u.v||0,u.f&&!u.F&&(x+=";E"+pl(u.f,{r:p,c:m}));break;case"b":x+=u.v?"TRUE":"FALSE";break;case"e":x+=u.w||u.v;break;case"d":x+='"'+(u.w||u.v)+'"';break;case"s":x+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function c(u,g){g.forEach(function(p,m){var x="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?x+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=na(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=sa(p.wpx)),typeof p.wch=="number"&&(x+=Math.round(p.wch))),x.charAt(x.length-1)!=" "&&u.push(x)})}function h(u,g){g.forEach(function(p,m){var x="F;";p.hidden?x+="M0;":p.hpt?x+="M"+20*p.hpt+";":p.hpx&&(x+="M"+20*ia(p.hpx)+";"),x.length>2&&u.push(x+"R"+(m+1))})}function f(u,g){var p=["ID;PWXL;N;E"],m=[],x=$e(u["!ref"]),v,b=Array.isArray(u),_=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),u["!cols"]&&c(p,u["!cols"]),u["!rows"]&&h(p,u["!rows"]),p.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var k=x.s.r;k<=x.e.r;++k)for(var O=x.s.c;O<=x.e.c;++O){var P=Pe({r:k,c:O});v=b?(u[k]||[])[O]:u[P],!(!v||v.v==null&&(!v.f||v.F))&&m.push(l(v,u,k,O))}return p.join(_)+_+m.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),Fb=function(){function r(i,a){switch(a.type){case"base64":return e(Sr(i),a);case"binary":return e(i,a);case"buffer":return e(Ae&&Buffer.isBuffer(i)?i.toString("binary"):Gs(i),a);case"array":return e(Ta(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),l=-1,c=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var u=o[h].trim().split(","),g=u[0],p=u[1];++h;for(var m=o[h]||"";(m.match(/["]/g)||[]).length&1&&h<o.length-1;)m+=`
`+o[++h];switch(m=m.trim(),+g){case-1:if(m==="BOT"){f[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[l][c]=!0:m==="FALSE"?f[l][c]=!1:isNaN(br(p))?isNaN(js(p).getDate())?f[l][c]=p:f[l][c]=bt(p):f[l][c]=br(p),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function t(i,a){return Xn(r(i,a),a)}function n(i,a){return mn(t(i,a),a)}var s=function(){var i=function(l,c,h,f,u){l.push(c),l.push(h+","+f),l.push('"'+u.replace(/"/g,'""')+'"')},a=function(l,c,h,f){l.push(c+","+h),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],h=$e(l["!ref"]),f,u=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,h.e.r-h.s.r+1,""),i(c,"TUPLES",0,h.e.c-h.s.c+1,""),i(c,"DATA",0,0,"");for(var g=h.s.r;g<=h.e.r;++g){a(c,-1,0,"BOT");for(var p=h.s.c;p<=h.e.c;++p){var m=Pe({r:g,c:p});if(f=u?(l[g]||[])[p]:l[m],!f){a(c,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,x,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Br(f.z||Ve[14],Ct(bt(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var v=`\r
`,b=c.join(v);return b}}();return{to_workbook:n,to_sheet:t,from_sheet:s}}(),Sf=function(){function r(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,u){for(var g=f.split(`
`),p=-1,m=-1,x=0,v=[];x!==g.length;++x){var b=g[x].trim().split(":");if(b[0]==="cell"){var _=st(b[1]);if(v.length<=_.r)for(p=v.length;p<=_.r;++p)v[p]||(v[p]=[]);switch(p=_.r,m=_.c,b[2]){case"t":v[p][m]=r(b[3]);break;case"v":v[p][m]=+b[3];break;case"vtf":var k=b[b.length-1];case"vtc":switch(b[3]){case"nl":v[p][m]=!!+b[4];break;default:v[p][m]=+b[4];break}b[2]=="vtf"&&(v[p][m]=[v[p][m],k])}}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function n(f,u){return Xn(t(f,u),u)}function s(f,u){return mn(n(f,u),u)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var u=[],g=[],p,m="",x=jt(f["!ref"]),v=Array.isArray(f),b=x.s.r;b<=x.e.r;++b)for(var _=x.s.c;_<=x.e.c;++_)if(m=Pe({r:b,c:_}),p=v?(f[b]||[])[_]:f[m],!(!p||p.v==null||p.t==="z")){switch(g=["cell",m,"t"],p.t){case"s":case"str":g.push(e(p.v));break;case"n":p.f?(g[2]="vtf",g[3]="n",g[4]=p.v,g[5]=e(p.f)):(g[2]="v",g[3]=p.v);break;case"b":g[2]="vt"+(p.f?"f":"c"),g[3]="nl",g[4]=p.v?"1":"0",g[5]=e(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var k=Ct(bt(p.v));g[2]="vtc",g[3]="nd",g[4]=""+k,g[5]=p.w||Br(p.z||Ve[14],k);break;case"e":continue}u.push(g.join(":"))}return u.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function h(f){return[i,a,o,a,c(f),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:h}}(),Db=function(){function r(h,f,u,g,p){p.raw?f[u][g]=h:h===""||(h==="TRUE"?f[u][g]=!0:h==="FALSE"?f[u][g]=!1:isNaN(br(h))?isNaN(js(h).getDate())?f[u][g]=h:f[u][g]=bt(h):f[u][g]=br(h))}function e(h,f){var u=f||{},g=[];if(!h||h.length===0)return g;for(var p=h.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var x=10,v=0,b=0;b<=m;++b)v=p[b].indexOf(" "),v==-1?v=p[b].length:v++,x=Math.max(x,v);for(b=0;b<=m;++b){g[b]=[];var _=0;for(r(p[b].slice(0,x).trim(),g,b,_,u),_=1;_<=(p[b].length-x)/10+1;++_)r(p[b].slice(x+(_-1)*10,x+_*10).trim(),g,b,_,u)}return u.sheetRows&&(g=g.slice(0,u.sheetRows)),g}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(h){for(var f={},u=!1,g=0,p=0;g<h.length;++g)(p=h.charCodeAt(g))==34?u=!u:!u&&p in t&&(f[p]=(f[p]||0)+1);p=[];for(g in f)Object.prototype.hasOwnProperty.call(f,g)&&p.push([f[g],g]);if(!p.length){f=n;for(g in f)Object.prototype.hasOwnProperty.call(f,g)&&p.push([f[g],g])}return p.sort(function(m,x){return m[0]-x[0]||n[m[1]]-n[x[1]]}),t[p.pop()[1]]||44}function i(h,f){var u=f||{},g="",p=u.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(g=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(g=h.charAt(4),h=h.slice(6)):g=s(h.slice(0,1024)):u&&u.FS?g=u.FS:g=s(h.slice(0,1024));var x=0,v=0,b=0,_=0,k=0,O=g.charCodeAt(0),P=!1,C=0,R=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var D=u.dateNF!=null?Ky(u.dateNF):null;function M(){var z=h.slice(_,k),G={};if(z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'&&(z=z.slice(1,-1).replace(/""/g,'"')),z.length===0)G.t="z";else if(u.raw)G.t="s",G.v=z;else if(z.trim().length===0)G.t="s",G.v=z;else if(z.charCodeAt(0)==61)z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(G.t="s",G.v=z.slice(2,-1).replace(/""/g,'"')):Ow(z)?(G.t="n",G.f=z.slice(1)):(G.t="s",G.v=z);else if(z=="TRUE")G.t="b",G.v=!0;else if(z=="FALSE")G.t="b",G.v=!1;else if(!isNaN(b=br(z)))G.t="n",u.cellText!==!1&&(G.w=z),G.v=b;else if(!isNaN(js(z).getDate())||D&&z.match(D)){G.z=u.dateNF||Ve[14];var Z=0;D&&z.match(D)&&(z=Yy(z,u.dateNF,z.match(D)||[]),Z=1),u.cellDates?(G.t="d",G.v=bt(z,Z)):(G.t="n",G.v=Ct(bt(z,Z))),u.cellText!==!1&&(G.w=Br(G.z,G.v instanceof Date?Ct(G.v):G.v)),u.cellNF||delete G.z}else G.t="s",G.v=z;if(G.t=="z"||(u.dense?(p[x]||(p[x]=[]),p[x][v]=G):p[Pe({c:v,r:x})]=G),_=k+1,R=h.charCodeAt(_),m.e.c<v&&(m.e.c=v),m.e.r<x&&(m.e.r=x),C==O)++v;else if(v=0,++x,u.sheetRows&&u.sheetRows<=x)return!0}e:for(;k<h.length;++k)switch(C=h.charCodeAt(k)){case 34:R===34&&(P=!P);break;case O:case 10:case 13:if(!P&&M())break e;break}return k-_>0&&M(),p["!ref"]=Je(m),p}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,f):Xn(e(h,f),f)}function o(h,f){var u="",g=f.type=="string"?[0,0,0,0]:zT(h,f);switch(f.type){case"base64":u=Sr(h);break;case"binary":u=h;break;case"buffer":f.codepage==65001?u=h.toString("utf8"):f.codepage&&typeof tn<"u"?u=tn.utils.decode(f.codepage,h):u=Ae&&Buffer.isBuffer(h)?h.toString("binary"):Gs(h);break;case"array":u=Ta(h);break;case"string":u=h;break;default:throw new Error("Unrecognized type "+f.type)}return g[0]==239&&g[1]==187&&g[2]==191?u=Ss(u.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?u=Ss(u):f.type=="binary"&&typeof tn<"u"&&f.codepage&&(u=tn.utils.decode(f.codepage,tn.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?Sf.to_sheet(f.type=="string"?u:Ss(u),f):a(u,f)}function l(h,f){return mn(o(h,f),f)}function c(h){for(var f=[],u=$e(h["!ref"]),g,p=Array.isArray(h),m=u.s.r;m<=u.e.r;++m){for(var x=[],v=u.s.c;v<=u.e.c;++v){var b=Pe({r:m,c:v});if(g=p?(h[m]||[])[v]:h[b],!g||g.v==null){x.push("          ");continue}for(var _=(g.w||(Tr(g),g.w)||"").slice(0,10);_.length<10;)_+=" ";x.push(_+(v===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}(),$0=function(){function r(N,U,I){if(N){It(N,N.l||0);for(var F=I.Enum||Ee;N.l<N.length;){var Y=N.read_shift(2),ue=F[Y]||F[65535],ge=N.read_shift(2),fe=N.l+ge,oe=ue.f&&ue.f(N,ge,I);if(N.l=fe,U(oe,ue,Y))return}}}function e(N,U){switch(U.type){case"base64":return t(qt(Sr(N)),U);case"binary":return t(qt(N),U);case"buffer":case"array":return t(N,U)}throw"Unsupported type "+U.type}function t(N,U){if(!N)return N;var I=U||{},F=I.dense?[]:{},Y="Sheet1",ue="",ge=0,fe={},oe=[],Ce=[],we={s:{r:0,c:0},e:{r:0,c:0}},at=I.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)I.Enum=Ee,r(N,function(he,tt,Vt){switch(Vt){case 0:I.vers=he,he>=4096&&(I.qpro=!0);break;case 6:we=he;break;case 204:he&&(ue=he);break;case 222:ue=he;break;case 15:case 51:I.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:Vt==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=I.dateNF||Ve[14],I.cellDates&&(he[1].t="d",he[1].v=Ud(he[1].v))),I.qpro&&he[3]>ge&&(F["!ref"]=Je(we),fe[Y]=F,oe.push(Y),F=I.dense?[]:{},we={s:{r:0,c:0},e:{r:0,c:0}},ge=he[3],Y=ue||"Sheet"+(ge+1),ue="");var tr=I.dense?(F[he[0].r]||[])[he[0].c]:F[Pe(he[0])];if(tr){tr.t=he[1].t,tr.v=he[1].v,he[1].z!=null&&(tr.z=he[1].z),he[1].f!=null&&(tr.f=he[1].f);break}I.dense?(F[he[0].r]||(F[he[0].r]=[]),F[he[0].r][he[0].c]=he[1]):F[Pe(he[0])]=he[1];break}},I);else if(N[2]==26||N[2]==14)I.Enum=Me,N[2]==14&&(I.qpro=!0,N.l=0),r(N,function(he,tt,Vt){switch(Vt){case 204:Y=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>ge&&(F["!ref"]=Je(we),fe[Y]=F,oe.push(Y),F=I.dense?[]:{},we={s:{r:0,c:0},e:{r:0,c:0}},ge=he[3],Y="Sheet"+(ge+1)),at>0&&he[0].r>=at)break;I.dense?(F[he[0].r]||(F[he[0].r]=[]),F[he[0].r][he[0].c]=he[1]):F[Pe(he[0])]=he[1],we.e.c<he[0].c&&(we.e.c=he[0].c),we.e.r<he[0].r&&(we.e.r=he[0].r);break;case 27:he[14e3]&&(Ce[he[14e3][0]]=he[14e3][1]);break;case 1537:Ce[he[0]]=he[1],he[0]==ge&&(Y=he[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(F["!ref"]=Je(we),fe[ue||Y]=F,oe.push(ue||Y),!Ce.length)return{SheetNames:oe,Sheets:fe};for(var ke={},ne=[],xe=0;xe<Ce.length;++xe)fe[oe[xe]]?(ne.push(Ce[xe]||oe[xe]),ke[Ce[xe]]=fe[Ce[xe]]||fe[oe[xe]]):(ne.push(Ce[xe]),ke[Ce[xe]]={"!ref":"A1"});return{SheetNames:ne,Sheets:ke}}function n(N,U){var I=U||{};if(+I.codepage>=0&&Ps(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var F=At(),Y=$e(N["!ref"]),ue=Array.isArray(N),ge=[];ie(F,0,i(1030)),ie(F,6,l(Y));for(var fe=Math.min(Y.e.r,8191),oe=Y.s.r;oe<=fe;++oe)for(var Ce=ft(oe),we=Y.s.c;we<=Y.e.c;++we){oe===Y.s.r&&(ge[we]=pt(we));var at=ge[we]+Ce,ke=ue?(N[oe]||[])[we]:N[at];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?ie(F,13,g(oe,we,ke.v)):ie(F,14,m(oe,we,ke.v));else{var ne=Tr(ke);ie(F,15,f(oe,we,ne.slice(0,239)))}}return ie(F,1),F.end()}function s(N,U){var I=U||{};if(+I.codepage>=0&&Ps(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var F=At();ie(F,0,a(N));for(var Y=0,ue=0;Y<N.SheetNames.length;++Y)(N.Sheets[N.SheetNames[Y]]||{})["!ref"]&&ie(F,27,le(N.SheetNames[Y],ue++));var ge=0;for(Y=0;Y<N.SheetNames.length;++Y){var fe=N.Sheets[N.SheetNames[Y]];if(!(!fe||!fe["!ref"])){for(var oe=$e(fe["!ref"]),Ce=Array.isArray(fe),we=[],at=Math.min(oe.e.r,8191),ke=oe.s.r;ke<=at;++ke)for(var ne=ft(ke),xe=oe.s.c;xe<=oe.e.c;++xe){ke===oe.s.r&&(we[xe]=pt(xe));var he=we[xe]+ne,tt=Ce?(fe[ke]||[])[xe]:fe[he];if(!(!tt||tt.t=="z"))if(tt.t=="n")ie(F,23,M(ke,xe,ge,tt.v));else{var Vt=Tr(tt);ie(F,22,C(ke,xe,ge,Vt.slice(0,239)))}}++ge}}return ie(F,1),F.end()}function i(N){var U=X(2);return U.write_shift(2,N),U}function a(N){var U=X(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var I=0,F=0,Y=0,ue=0;ue<N.SheetNames.length;++ue){var ge=N.SheetNames[ue],fe=N.Sheets[ge];if(!(!fe||!fe["!ref"])){++Y;var oe=jt(fe["!ref"]);I<oe.e.r&&(I=oe.e.r),F<oe.e.c&&(F=oe.e.c)}}return I>8191&&(I=8191),U.write_shift(2,I),U.write_shift(1,Y),U.write_shift(1,F),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(N,U,I){var F={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&I.qpro?(F.s.c=N.read_shift(1),N.l++,F.s.r=N.read_shift(2),F.e.c=N.read_shift(1),N.l++,F.e.r=N.read_shift(2),F):(F.s.c=N.read_shift(2),F.s.r=N.read_shift(2),U==12&&I.qpro&&(N.l+=2),F.e.c=N.read_shift(2),F.e.r=N.read_shift(2),U==12&&I.qpro&&(N.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function l(N){var U=X(8);return U.write_shift(2,N.s.c),U.write_shift(2,N.s.r),U.write_shift(2,N.e.c),U.write_shift(2,N.e.r),U}function c(N,U,I){var F=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(F[0].c=N.read_shift(1),F[3]=N.read_shift(1),F[0].r=N.read_shift(2),N.l+=2):(F[2]=N.read_shift(1),F[0].c=N.read_shift(2),F[0].r=N.read_shift(2)),F}function h(N,U,I){var F=N.l+U,Y=c(N,U,I);if(Y[1].t="s",I.vers==20768){N.l++;var ue=N.read_shift(1);return Y[1].v=N.read_shift(ue,"utf8"),Y}return I.qpro&&N.l++,Y[1].v=N.read_shift(F-N.l,"cstr"),Y}function f(N,U,I){var F=X(7+I.length);F.write_shift(1,255),F.write_shift(2,U),F.write_shift(2,N),F.write_shift(1,39);for(var Y=0;Y<F.length;++Y){var ue=I.charCodeAt(Y);F.write_shift(1,ue>=128?95:ue)}return F.write_shift(1,0),F}function u(N,U,I){var F=c(N,U,I);return F[1].v=N.read_shift(2,"i"),F}function g(N,U,I){var F=X(7);return F.write_shift(1,255),F.write_shift(2,U),F.write_shift(2,N),F.write_shift(2,I,"i"),F}function p(N,U,I){var F=c(N,U,I);return F[1].v=N.read_shift(8,"f"),F}function m(N,U,I){var F=X(13);return F.write_shift(1,255),F.write_shift(2,U),F.write_shift(2,N),F.write_shift(8,I,"f"),F}function x(N,U,I){var F=N.l+U,Y=c(N,U,I);if(Y[1].v=N.read_shift(8,"f"),I.qpro)N.l=F;else{var ue=N.read_shift(2);k(N.slice(N.l,N.l+ue),Y),N.l+=ue}return Y}function v(N,U,I){var F=U&32768;return U&=-32769,U=(F?N:0)+(U>=8192?U-16384:U),(F?"":"$")+(I?pt(U):ft(U))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(N,U){It(N,0);for(var I=[],F=0,Y="",ue="",ge="",fe="";N.l<N.length;){var oe=N[N.l++];switch(oe){case 0:I.push(N.read_shift(8,"f"));break;case 1:ue=v(U[0].c,N.read_shift(2),!0),Y=v(U[0].r,N.read_shift(2),!1),I.push(ue+Y);break;case 2:{var Ce=v(U[0].c,N.read_shift(2),!0),we=v(U[0].r,N.read_shift(2),!1);ue=v(U[0].c,N.read_shift(2),!0),Y=v(U[0].r,N.read_shift(2),!1),I.push(Ce+we+":"+ue+Y)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(N.read_shift(2));break;case 6:{for(var at="";oe=N[N.l++];)at+=String.fromCharCode(oe);I.push('"'+at.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:fe=I.pop(),ge=I.pop(),I.push(["AND","OR"][oe-20]+"("+ge+","+fe+")");break;default:if(oe<32&&_[oe])fe=I.pop(),ge=I.pop(),I.push(ge+_[oe]+fe);else if(b[oe]){if(F=b[oe][1],F==69&&(F=N[N.l++]),F>I.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+I.join("|")+"|");return}var ke=I.slice(-F);I.length-=F,I.push(b[oe][0]+"("+ke.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}I.length==1?U[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function O(N){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=N.read_shift(2),U[3]=N[N.l++],U[0].c=N[N.l++],U}function P(N,U){var I=O(N);return I[1].t="s",I[1].v=N.read_shift(U-4,"cstr"),I}function C(N,U,I,F){var Y=X(6+F.length);Y.write_shift(2,N),Y.write_shift(1,I),Y.write_shift(1,U),Y.write_shift(1,39);for(var ue=0;ue<F.length;++ue){var ge=F.charCodeAt(ue);Y.write_shift(1,ge>=128?95:ge)}return Y.write_shift(1,0),Y}function R(N,U){var I=O(N);I[1].v=N.read_shift(2);var F=I[1].v>>1;if(I[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return I[1].v=F,I}function D(N,U){var I=O(N),F=N.read_shift(4),Y=N.read_shift(4),ue=N.read_shift(2);if(ue==65535)return F===0&&Y===3221225472?(I[1].t="e",I[1].v=15):F===0&&Y===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var ge=ue&32768;return ue=(ue&32767)-16446,I[1].v=(1-ge*2)*(Y*Math.pow(2,ue+32)+F*Math.pow(2,ue)),I}function M(N,U,I,F){var Y=X(14);if(Y.write_shift(2,N),Y.write_shift(1,I),Y.write_shift(1,U),F==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var ue=0,ge=0,fe=0,oe=0;return F<0&&(ue=1,F=-F),ge=Math.log2(F)|0,F/=Math.pow(2,ge-31),oe=F>>>0,oe&2147483648||(F/=2,++ge,oe=F>>>0),F-=oe,oe|=2147483648,oe>>>=0,F*=Math.pow(2,32),fe=F>>>0,Y.write_shift(4,fe),Y.write_shift(4,oe),ge+=16383+(ue?32768:0),Y.write_shift(2,ge),Y}function z(N,U){var I=D(N);return N.l+=U-14,I}function G(N,U){var I=O(N),F=N.read_shift(4);return I[1].v=F>>6,I}function Z(N,U){var I=O(N),F=N.read_shift(8,"f");return I[1].v=F,I}function Q(N,U){var I=Z(N);return N.l+=U-10,I}function V(N,U){return N[N.l+U-1]==0?N.read_shift(U,"cstr"):""}function me(N,U){var I=N[N.l++];I>U-1&&(I=U-1);for(var F="";F.length<I;)F+=String.fromCharCode(N[N.l++]);return F}function ee(N,U,I){if(!(!I.qpro||U<21)){var F=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var Y=N.read_shift(U-21,"cstr");return[F,Y]}}function B(N,U){for(var I={},F=N.l+U;N.l<F;){var Y=N.read_shift(2);if(Y==14e3){for(I[Y]=[0,""],I[Y][0]=N.read_shift(2);N[N.l];)I[Y][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return I}function le(N,U){var I=X(5+N.length);I.write_shift(2,14e3),I.write_shift(2,U);for(var F=0;F<N.length;++F){var Y=N.charCodeAt(F);I[I.l++]=Y>127?95:Y}return I[I.l++]=0,I}var Ee={0:{n:"BOF",f:yf},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:V},222:{n:"SHEETNAMELP",f:me},65535:{n:""}},Me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:B},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:Q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:V},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}(),Ib=/^\s|\s$|[\t\n\r]/;function Tf(r,e){if(!e.bookSST)return"";var t=[Ze];t[t.length]=se("sst",null,{xmlns:Gn[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var s=r[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(Ib)&&(i+=' xml:space="preserve"'),i+=">"+Ie(s.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function Pb(r){return[r.read_shift(4),r.read_shift(4)]}function Rb(r,e){return e||(e=X(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var jb=E_;function Mb(r){var e=At();q(e,159,Rb(r));for(var t=0;t<r.length;++t)q(e,19,jb(r[t]));return q(e,160),e.end()}function Lb(r){for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function Ef(r){var e=0,t,n=Lb(r),s=n.length+1,i,a,o,l,c;for(t=dn(s),t[0]=n.length,i=1;i!=s;++i)t[i]=n[i-1];for(i=s-1;i>=0;--i)a=t[i],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var Bb=function(){function r(s,i){switch(i.type){case"base64":return e(Sr(s),i);case"binary":return e(s,i);case"buffer":return e(Ae&&Buffer.isBuffer(s)?s.toString("binary"):Gs(s),i);case"array":return e(Ta(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var u=/\\\w+\b/g,g=0,p,m=-1;p=u.exec(h);){switch(p[0]){case"\\cell":var x=h.slice(g,u.lastIndex-p[0].length);if(x[0]==" "&&(x=x.slice(1)),++m,x.length){var v={v:x,t:"s"};Array.isArray(o)?o[f][m]=v:o[Pe({r:f,c:m})]=v}break}g=u.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Je(c),o}function t(s,i){return mn(r(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=$e(s["!ref"]),o,l=Array.isArray(s),c=a.s.r;c<=a.e.r;++c){i.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=Pe({r:c,c:h});o=l?(s[c]||[])[h]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Tr(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}}();function W0(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}var Ub=6,wr=Ub;function na(r){return Math.floor((r+Math.round(128/wr)/256)*wr)}function sa(r){return Math.floor((r-5)/wr*100+.5)/100}function Do(r){return Math.round((r*wr+5)/wr*256)/256}function ml(r){r.width?(r.wpx=na(r.width),r.wch=sa(r.wpx),r.MDW=wr):r.wpx?(r.wch=sa(r.wpx),r.width=Do(r.wch),r.MDW=wr):typeof r.wch=="number"&&(r.width=Do(r.wch),r.wpx=na(r.width),r.MDW=wr),r.customWidth&&delete r.customWidth}var $b=96,Af=$b;function ia(r){return r*96/Af}function Cf(r){return r*Af/96}function Wb(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=se("numFmt",null,{numFmtId:n,formatCode:Ie(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=se("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function Hb(r){var e=[];return e[e.length]=se("cellXfs",null),r.forEach(function(t){e[e.length]=se("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=se("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function Nf(r,e){var t=[Ze,se("styleSheet",null,{xmlns:Gn[0],"xmlns:vt":nt.vt})],n;return r.SSF&&(n=Wb(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Hb(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function zb(r,e){var t=r.read_shift(2),n=vt(r);return[t,n]}function Vb(r,e,t){t||(t=X(6+4*e.length)),t.write_shift(2,r),it(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function Gb(r,e,t){var n={};n.sz=r.read_shift(2)/20;var s=I_(r);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=r.read_shift(2);switch(i===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(n.underline=a);var o=r.read_shift(1);o>0&&(n.family=o);var l=r.read_shift(1);switch(l>0&&(n.charset=l),r.l++,n.color=D_(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=vt(r),n}function Xb(r,e){e||(e=X(25+4*32)),e.write_shift(2,r.sz*20),P_(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),ta(r.color,e);var n=0;return r.scheme=="major"&&(n=1),r.scheme=="minor"&&(n=2),e.write_shift(1,n),it(r.name,e),e.length>e.l?e.slice(0,e.l):e}var Kb=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],so,Yb=hr;function H0(r,e){e||(e=X(4*3+8*7+16*1)),so||(so=nl(Kb));var t=so[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(ta({auto:1},e),ta({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function qb(r,e){var t=r.l+e,n=r.read_shift(2),s=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:s}}function Of(r,e,t){t||(t=X(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function is(r,e){return e||(e=X(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Jb=hr;function Zb(r,e){return e||(e=X(51)),e.write_shift(1,0),is(null,e),is(null,e),is(null,e),is(null,e),is(null,e),e.length>e.l?e.slice(0,e.l):e}function Qb(r,e){return e||(e=X(12+4*10)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,+r.builtinId),e.write_shift(1,0),ea(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function ew(r,e,t){var n=X(2052);return n.write_shift(4,r),ea(e,n),ea(t,n),n.length>n.l?n.slice(0,n.l):n}function tw(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++t}),t!=0&&(q(r,615,Zt(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&q(r,44,Vb(s,e[s]))}),q(r,616))}}function rw(r){var e=1;q(r,611,Zt(e)),q(r,43,Xb({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),q(r,612)}function nw(r){var e=2;q(r,603,Zt(e)),q(r,45,H0({patternType:"none"})),q(r,45,H0({patternType:"gray125"})),q(r,604)}function sw(r){var e=1;q(r,613,Zt(e)),q(r,46,Zb()),q(r,614)}function iw(r){var e=1;q(r,626,Zt(e)),q(r,47,Of({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),q(r,627)}function aw(r,e){q(r,617,Zt(e.length)),e.forEach(function(t){q(r,47,Of(t,0))}),q(r,618)}function ow(r){var e=1;q(r,619,Zt(e)),q(r,48,Qb({xfId:0,builtinId:0,name:"Normal"})),q(r,620)}function lw(r){var e=0;q(r,505,Zt(e)),q(r,506)}function cw(r){var e=0;q(r,508,ew(e,"TableStyleMedium9","PivotStyleMedium4")),q(r,509)}function hw(r,e){var t=At();return q(t,278),tw(t,r.SSF),rw(t),nw(t),sw(t),iw(t),aw(t,e.cellXfs),ow(t),lw(t),cw(t),q(t,279),t.end()}function Ff(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[Ze];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function dw(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:vt(r)}}function fw(r){var e=X(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),it(r.name,e),e.slice(0,e.l)}function uw(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function gw(r){var e=X(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function mw(r,e){var t=X(8+2*e.length);return t.write_shift(4,r),it(e,t),t.slice(0,t.l)}function xw(r){return r.l+=4,r.read_shift(4)!=0}function pw(r,e){var t=X(8);return t.write_shift(4,r),t.write_shift(4,1),t}function vw(){var r=At();return q(r,332),q(r,334,Zt(1)),q(r,335,fw({name:"XLDAPR",version:12e4,flags:3496657072})),q(r,336),q(r,339,mw(1,"XLDAPR")),q(r,52),q(r,35,Zt(514)),q(r,4096,Zt(0)),q(r,4097,Ut(1)),q(r,36),q(r,53),q(r,340),q(r,337,pw(1)),q(r,51,gw([[1,0]])),q(r,338),q(r,333),r.end()}function Df(){var r=[Ze];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function yw(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=Pe(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var Dn=1024;function If(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[se("xml",null,{"xmlns:v":Pt.v,"xmlns:o":Pt.o,"xmlns:x":Pt.x,"xmlns:mv":Pt.mv}).replace(/\/>/,">"),se("o:shapelayout",se("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),se("v:shapetype",[se("v:stroke",null,{joinstyle:"miter"}),se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Dn<r*1e3;)Dn+=1e3;return e.forEach(function(i){var a=st(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=se("v:fill",l,o),h={on:"t",obscured:"t"};++Dn,s=s.concat(["<v:shape"+Ls({id:"_x0000_s"+Dn,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,se("v:shadow",null,h),se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",dt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),dt("x:AutoFill","False"),dt("x:Row",String(a.r)),dt("x:Column",String(a.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Pf(r){var e=[Ze,se("comments",null,{xmlns:Gn[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(s){var i=Ie(s.a);t.indexOf(i)==-1&&(t.push(i),e.push("<author>"+i+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=t.indexOf(Ie(l.a))),i.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)e.push(dt("t",Ie(i[0]||"")));else{for(var a=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)a+=`Reply:
    `+i[o]+`
`;e.push(dt("t",Ie(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function _w(r,e,t){var n=[Ze,se("ThreadedComments",null,{xmlns:nt.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(s){var i="";(s[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(se("threadedComment",dt("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function bw(r){var e=[Ze,se("personList",null,{xmlns:nt.TCMNT,"xmlns:x":Gn[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(se("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function ww(r){var e={};e.iauthor=r.read_shift(4);var t=yn(r);return e.rfx=t.s,e.ref=Pe(t.s),r.l+=16,e}function kw(r,e){return e==null&&(e=X(36)),e.write_shift(4,r[1].iauthor),Kn(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Sw=vt;function Tw(r){return it(r.slice(0,54))}function Ew(r){var e=At(),t=[];return q(e,628),q(e,630),r.forEach(function(n){n[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),q(e,632,Tw(s.a)))})}),q(e,631),q(e,633),r.forEach(function(n){n[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var i={s:st(n[0]),e:st(n[0])};q(e,635,kw([i,s])),s.t&&s.t.length>0&&q(e,637,C_(s)),q(e,636),delete s.iauthor})}),q(e,634),q(e,629),e.end()}function Aw(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Re.utils.cfb_add(r,s,e.FileIndex[n].content)}})}var Rf=["xlsb","xlsm","xlam","biff8","xla"],Cw=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?c+=e.r:--c,s+(o?"":"$")+pt(h)+(l?"":"$")+ft(c)}return function(s,i){return e=i,s.replace(r,t)}}(),xl=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,pl=function(){return function(e,t){return e.replace(xl,function(n,s,i,a,o,l){var c=hl(a)-(i?0:t.c),h=cl(l)-(o?0:t.r),f=h==0?"":o?h+1:"["+h+"]",u=c==0?"":i?c+1:"["+c+"]";return s+"R"+f+"C"+u})}}();function Nw(r,e){return r.replace(xl,function(t,n,s,i,a,o){return n+(s=="$"?s+i:pt(hl(i)+e.c))+(a=="$"?a+o:ft(cl(o)+e.r))})}function Ow(r){return r.length!=1}function Ke(r){r.l+=1}function Ur(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function jf(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Mf(r);t.biff==12&&(n=4)}var s=r.read_shift(n),i=r.read_shift(n),a=Ur(r),o=Ur(r);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Mf(r){var e=Ur(r),t=Ur(r),n=r.read_shift(1),s=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function Fw(r,e,t){if(t.biff<8)return Mf(r);var n=r.read_shift(t.biff==12?4:2),s=r.read_shift(t.biff==12?4:2),i=Ur(r),a=Ur(r);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function Lf(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return Dw(r);var n=r.read_shift(t&&t.biff==12?4:2),s=Ur(r);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Dw(r){var e=Ur(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Iw(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Pw(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return Rw(r);var s=r.read_shift(n>=12?4:2),i=r.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function Rw(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:s,rRel:n}}function jw(r,e,t){var n=(r[r.l++]&96)>>5,s=jf(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,s]}function Mw(r,e,t){var n=(r[r.l++]&96)>>5,s=r.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:r.l+=12,i=6;break;case 12:i=12;break}var a=jf(r,i,t);return[n,s,a]}function Lw(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function Bw(r,e,t){var n=(r[r.l++]&96)>>5,s=r.read_shift(2),i=8;if(t)switch(t.biff){case 5:r.l+=12,i=6;break;case 12:i=12;break}return r.l+=i,[n,s]}function Uw(r,e,t){var n=(r[r.l++]&96)>>5,s=Fw(r,e-1,t);return[n,s]}function $w(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function z0(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function Ww(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(r.read_shift(t&&t.biff==2?1:2));return s}function Hw(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function zw(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function Vw(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function Gw(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function Bf(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function Xw(r){return r.read_shift(2),Bf(r)}function Kw(r){return r.read_shift(2),Bf(r)}function Yw(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var s=Lf(r,0,t);return[n,s]}function qw(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var s=Pw(r,0,t);return[n,s]}function Jw(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var s=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var i=Lf(r,0,t);return[n,s,i]}function Zw(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var s=r.read_shift(t&&t.biff<=3?1:2);return[Z2[s],Wf[s],n]}function Qw(r,e,t){var n=r[r.l++],s=r.read_shift(1),i=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:e2(r);return[s,(i[0]===0?Wf:J2)[i[1]]]}function e2(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function t2(r,e,t){r.l+=t&&t.biff==2?3:4}function r2(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),s=r.read_shift(t&&t.biff==2?1:2);return[n,s]}function n2(r){return r.l++,Ys[r.read_shift(1)]}function s2(r){return r.l++,r.read_shift(2)}function i2(r){return r.l++,r.read_shift(1)!==0}function a2(r){return r.l++,Yn(r)}function o2(r,e,t){return r.l++,bf(r,e-1,t)}function l2(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=J_(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=Ys[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=Yn(r);break;case 2:t[1]=tb(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function c2(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((t.biff==12?yn:sb)(r));return s}function h2(r,e,t){var n=0,s=0;t.biff==12?(n=r.read_shift(4),s=r.read_shift(4)):(s=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=l2(r,t.biff);return a}function d2(r,e,t){var n=r.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,i=r.read_shift(s);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,i]}function f2(r,e,t){if(t.biff==5)return u2(r);var n=r.read_shift(1)>>>5&3,s=r.read_shift(2),i=r.read_shift(4);return[n,s,i]}function u2(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function g2(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var s=r.read_shift(t&&t.biff==2?1:2);return[n,s]}function m2(r,e,t){var n=r.read_shift(1)>>>5&3,s=r.read_shift(t&&t.biff==2?1:2);return[n,s]}function x2(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function p2(r,e,t){var n=(r[r.l++]&96)>>5,s=r.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return r.l+=i,[n,s]}var v2=hr,y2=hr,_2=hr;function qs(r,e,t){return r.l+=2,[Iw(r)]}function vl(r){return r.l+=6,[]}var b2=qs,w2=vl,k2=vl,S2=qs;function Uf(r){return r.l+=2,[yf(r),r.read_shift(2)&1]}var T2=qs,E2=Uf,A2=vl,C2=qs,N2=qs,O2=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function F2(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),s=r.read_shift(2),i=r.read_shift(2),a=O2[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:n,c:s,C:i}}function D2(r){return r.l+=2,[r.read_shift(4)]}function I2(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function P2(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function R2(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function j2(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function M2(r){return r.l+=4,[0,0]}var V0={1:{n:"PtgExp",f:r2},2:{n:"PtgTbl",f:_2},3:{n:"PtgAdd",f:Ke},4:{n:"PtgSub",f:Ke},5:{n:"PtgMul",f:Ke},6:{n:"PtgDiv",f:Ke},7:{n:"PtgPower",f:Ke},8:{n:"PtgConcat",f:Ke},9:{n:"PtgLt",f:Ke},10:{n:"PtgLe",f:Ke},11:{n:"PtgEq",f:Ke},12:{n:"PtgGe",f:Ke},13:{n:"PtgGt",f:Ke},14:{n:"PtgNe",f:Ke},15:{n:"PtgIsect",f:Ke},16:{n:"PtgUnion",f:Ke},17:{n:"PtgRange",f:Ke},18:{n:"PtgUplus",f:Ke},19:{n:"PtgUminus",f:Ke},20:{n:"PtgPercent",f:Ke},21:{n:"PtgParen",f:Ke},22:{n:"PtgMissArg",f:Ke},23:{n:"PtgStr",f:o2},26:{n:"PtgSheet",f:I2},27:{n:"PtgEndSheet",f:P2},28:{n:"PtgErr",f:n2},29:{n:"PtgBool",f:i2},30:{n:"PtgInt",f:s2},31:{n:"PtgNum",f:a2},32:{n:"PtgArray",f:$w},33:{n:"PtgFunc",f:Zw},34:{n:"PtgFuncVar",f:Qw},35:{n:"PtgName",f:d2},36:{n:"PtgRef",f:Yw},37:{n:"PtgArea",f:jw},38:{n:"PtgMemArea",f:g2},39:{n:"PtgMemErr",f:v2},40:{n:"PtgMemNoMem",f:y2},41:{n:"PtgMemFunc",f:m2},42:{n:"PtgRefErr",f:x2},43:{n:"PtgAreaErr",f:Lw},44:{n:"PtgRefN",f:qw},45:{n:"PtgAreaN",f:Uw},46:{n:"PtgMemAreaN",f:R2},47:{n:"PtgMemNoMemN",f:j2},57:{n:"PtgNameX",f:f2},58:{n:"PtgRef3d",f:Jw},59:{n:"PtgArea3d",f:Mw},60:{n:"PtgRefErr3d",f:p2},61:{n:"PtgAreaErr3d",f:Bw},255:{}},L2={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},B2={1:{n:"PtgElfLel",f:Uf},2:{n:"PtgElfRw",f:C2},3:{n:"PtgElfCol",f:b2},6:{n:"PtgElfRwV",f:N2},7:{n:"PtgElfColV",f:S2},10:{n:"PtgElfRadical",f:T2},11:{n:"PtgElfRadicalS",f:A2},13:{n:"PtgElfColS",f:w2},15:{n:"PtgElfColSV",f:k2},16:{n:"PtgElfRadicalLel",f:E2},25:{n:"PtgList",f:F2},29:{n:"PtgSxName",f:D2},255:{}},U2={0:{n:"PtgAttrNoop",f:M2},1:{n:"PtgAttrSemi",f:Gw},2:{n:"PtgAttrIf",f:zw},4:{n:"PtgAttrChoose",f:Ww},8:{n:"PtgAttrGoto",f:Hw},16:{n:"PtgAttrSum",f:t2},32:{n:"PtgAttrBaxcel",f:z0},33:{n:"PtgAttrBaxcel",f:z0},64:{n:"PtgAttrSpace",f:Xw},65:{n:"PtgAttrSpaceSemi",f:Kw},128:{n:"PtgAttrIfError",f:Vw},255:{}};function $2(r,e,t,n){if(n.biff<8)return hr(r,e);for(var s=r.l+e,i=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=h2(r,0,n),i.push(t[a][1]);break;case"PtgMemArea":t[a][2]=c2(r,t[a][1],n),i.push(t[a][2]);break;case"PtgExp":n&&n.biff==12&&(t[a][1][1]=r.read_shift(4),i.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=s-r.l,e!==0&&i.push(hr(r,e)),i}function W2(r,e,t){for(var n=r.l+e,s,i,a=[];n!=r.l;)e=n-r.l,i=r[r.l],s=V0[i]||V0[L2[i]],(i===24||i===25)&&(s=(i===24?B2:U2)[r[r.l+1]]),!s||!s.f?hr(r,e):a.push([s.n,s.f(r,e,t)]);return a}function H2(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var z2={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function V2(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function $f(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(t.biff>8)switch(r[n[0]][0]){case 357:return s=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?s:s+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return r[n[0]][0][3]?(s=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function G0(r,e,t){var n=$f(r,e,t);return n=="#REF"?n:V2(n,t)}function Wn(r,e,t,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,h,f=0,u=0,g,p="";if(!r[0]||!r[0][0])return"";for(var m=-1,x="",v=0,b=r[0].length;v<b;++v){var _=r[0][v];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(r[0][m][1][0]){case 0:x=ze(" ",r[0][m][1][1]);break;case 1:x=ze("\r",r[0][m][1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][m][1][0])}c=c+x,m=-1}o.push(c+z2[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Es(_[1][1],a,s),o.push(As(h,i));break;case"PtgRefN":h=t?Es(_[1][1],t,s):_[1][1],o.push(As(h,i));break;case"PtgRef3d":f=_[1][1],h=Es(_[1][2],a,s),p=G0(n,f,s),o.push(p+"!"+As(h,i));break;case"PtgFunc":case"PtgFuncVar":var k=_[1][0],O=_[1][1];k||(k=0),k&=127;var P=k==0?[]:o.slice(-k);o.length-=k,O==="User"&&(O=P.shift()),o.push(O+"("+P.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":g=O0(_[1][1],t?{s:t}:a,s),o.push(ro(g,s));break;case"PtgArea":g=O0(_[1][1],a,s),o.push(ro(g,s));break;case"PtgArea3d":f=_[1][1],g=_[1][2],p=G0(n,f,s),o.push(p+"!"+ro(g,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=_[1][2];var C=(n.names||[])[u-1]||(n[0]||[])[u],R=C?C.Name:"SH33TJSNAME"+String(u);R&&R.slice(0,6)=="_xlfn."&&!s.xlfn&&(R=R.slice(6)),o.push(R);break;case"PtgNameX":var D=_[1][1];u=_[1][2];var M;if(s.biff<=5)D<0&&(D=-D),n[D]&&(M=n[D][u]);else{var z="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][u]&&n[D][u].itab>0&&(z=n.SheetNames[n[D][u].itab-1]+"!"):z=n.SheetNames[u-1]+"!"),n[D]&&n[D][u])z+=n[D][u].Name;else if(n[0]&&n[0][u])z+=n[0][u].Name;else{var G=($f(n,D,s)||"").split(";;");G[u-1]?z=G[u-1]:z+="SH33TJSERRX"}o.push(z);break}M||(M={Name:"SH33TJSERRY"}),o.push(M.Name);break;case"PtgParen":var Z="(",Q=")";if(m>=0){switch(x="",r[0][m][1][0]){case 2:Z=ze(" ",r[0][m][1][1])+Z;break;case 3:Z=ze("\r",r[0][m][1][1])+Z;break;case 4:Q=ze(" ",r[0][m][1][1])+Q;break;case 5:Q=ze("\r",r[0][m][1][1])+Q;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][m][1][0])}m=-1}o.push(Z+o.pop()+Q);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:_[1][1],r:_[1][0]};var V={c:t.c,r:t.r};if(n.sharedf[Pe(h)]){var me=n.sharedf[Pe(h)];o.push(Wn(me,a,V,n,s))}else{var ee=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(h.c<c[0].s.c||h.c>c[0].e.c)&&!(h.r<c[0].s.r||h.r>c[0].e.r)){o.push(Wn(c[1],a,V,n,s)),ee=!0;break}ee||o.push(_[1])}break;case"PtgArray":o.push("{"+H2(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var B=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&B.indexOf(r[0][v][0])==-1){_=r[0][m];var le=!0;switch(_[1][0]){case 4:le=!1;case 0:x=ze(" ",_[1][1]);break;case 5:le=!1;case 1:x=ze("\r",_[1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((le?x:"")+o.pop()+(le?"":x)),m=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function G2(r){if(r==null){var e=X(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return fn(r);return fn(0)}function X2(r,e,t,n,s){var i=un(e,t,s),a=G2(r.v),o=X(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=X(r.bf.length),h=0;h<r.bf.length;++h)c[h]=r.bf[h];var f=ht([i,a,o,c]);return f}function Ea(r,e,t){var n=r.read_shift(4),s=W2(r,n,t),i=r.read_shift(4),a=i>0?$2(r,i,s,t):null;return[s,a]}var K2=Ea,Aa=Ea,Y2=Ea,q2=Ea,J2={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Wf={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Z2={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Q2(r){var e="of:="+r.replace(xl,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function ek(r){return r.replace(/\./,"!")}var Cs=typeof Map<"u";function yl(r,e,t){var n=0,s=r.length;if(t){if(Cs?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var i=Cs?t.get(e):t[e];n<i.length;++n)if(r[i[n]].t===e)return r.Count++,i[n]}}else for(;n<s;++n)if(r[n].t===e)return r.Count++,n;return r[s]={t:e},r.Count++,r.Unique++,t&&(Cs?(t.has(e)||t.set(e,[]),t.get(e).push(s)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(s))),s}function Ca(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(wr=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=sa(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=Do(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function Hf(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function Hr(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],s=60,i=r.length;if(n==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){Md(e.z,s),t.ssf[s]=e.z,t.revssf[e.z]=n=s;break}}for(s=0;s!=i;++s)if(r[s].numFmtId===n)return s;return r[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function tk(r,e,t){if(r&&r["!ref"]){var n=$e(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function rk(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+Je(r[t])+'"/>';return e+"</mergeCells>"}function nk(r,e,t,n,s){var i=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}i=!0,a.codeName=Ms(Ie(l))}if(r&&r["!outline"]){var c={summaryBelow:1,summaryRight:1};r["!outline"].above&&(c.summaryBelow=0),r["!outline"].left&&(c.summaryRight=0),o=(o||"")+se("outlinePr",null,c)}!i&&!o||(s[s.length]=se("sheetPr",o,a))}var sk=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ik=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ak(r){var e={sheet:1};return sk.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),ik.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=Ef(r.password).toString(16).toUpperCase()),se("sheetProtection",null,e)}function ok(r){return Hf(r),se("pageMargins",null,r)}function lk(r,e){for(var t=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(t[t.length]=se("col",null,Ca(s,n)));return t[t.length]="</cols>",t.join("")}function ck(r,e,t,n){var s=typeof r.ref=="string"?r.ref:Je(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,a=jt(s);a.s.r==a.e.r&&(a.e.r=jt(e["!ref"]).e.r,s=Je(a));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+t.SheetNames[n]+"'!"+s;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),se("autoFilter",null,{ref:s})}function hk(r,e,t,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),se("sheetViews",se("sheetView",null,s),{})}function dk(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var s="",i=r.t,a=r.v;if(r.t!=="z")switch(r.t){case"b":s=r.v?"1":"0";break;case"n":s=""+r.v;break;case"e":s=Ys[r.v];break;case"d":n&&n.cellDates?s=bt(r.v,-1).toISOString():(r=Nt(r),r.t="n",s=""+(r.v=Ct(bt(r.v)))),typeof r.z>"u"&&(r.z=Ve[14]);break;default:s=r.v;break}var o=dt("v",Ie(s)),l={r:e},c=Hr(n.cellXfs,r,n);switch(c!==0&&(l.s=c),r.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=dt("v",""+yl(n.Strings,r.v,n.revStrings)),l.t="s";break}l.t="str";break}if(r.t!=i&&(r.t=i,r.v=a),typeof r.f=="string"&&r.f){var h=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;o=se("f",Ie(r.f),h)+(r.v!=null?o:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(l.cm=1),se("c",o,l)}function fk(r,e,t,n){var s=[],i=[],a=$e(r["!ref"]),o="",l,c="",h=[],f=0,u=0,g=r["!rows"],p=Array.isArray(r),m={r:c},x,v=-1;for(u=a.s.c;u<=a.e.c;++u)h[u]=pt(u);for(f=a.s.r;f<=a.e.r;++f){for(i=[],c=ft(f),u=a.s.c;u<=a.e.c;++u){l=h[u]+c;var b=p?(r[f]||[])[u]:r[l];b!==void 0&&(o=dk(b,l,r,e))!=null&&i.push(o)}(i.length>0||g&&g[f])&&(m={r:c},g&&g[f]&&(x=g[f],x.hidden&&(m.hidden=1),v=-1,x.hpx?v=ia(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(m.ht=v,m.customHeight=1),x.level&&(m.outlineLevel=x.level)),s[s.length]=se("row",i.join(""),m))}if(g)for(;f<g.length;++f)g&&g[f]&&(m={r:f+1},x=g[f],x.hidden&&(m.hidden=1),v=-1,x.hpx?v=ia(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(m.ht=v,m.customHeight=1),x.level&&(m.outlineLevel=x.level),s[s.length]=se("row","",m));return s.join("")}function zf(r,e,t,n){var s=[Ze,se("worksheet",null,{xmlns:Gn[0],"xmlns:r":nt.r})],i=t.SheetNames[r],a=0,o="",l=t.Sheets[i];l==null&&(l={});var c=l["!ref"]||"A1",h=$e(c);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),c=Je(h)}n||(n={}),l["!comments"]=[];var f=[];nk(l,t,r,e,s),s[s.length]=se("dimension",null,{ref:c}),s[s.length]=hk(l,e,r,t),e.sheetFormat&&(s[s.length]=se("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=lk(l,l["!cols"])),s[a=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=fk(l,e),o.length>0&&(s[s.length]=o)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),l["!protect"]&&(s[s.length]=ak(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=ck(l["!autofilter"],l,t,r)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=rk(l["!merges"]));var u=-1,g,p=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(g={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=Oe(n,-1,Ie(m[1].Target).replace(/#.*$/,""),Se.HLINK),g["r:id"]="rId"+p),(u=m[1].Target.indexOf("#"))>-1&&(g.location=Ie(m[1].Target.slice(u+1))),m[1].Tooltip&&(g.tooltip=Ie(m[1].Tooltip)),s[s.length]=se("hyperlink",null,g))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=ok(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=dt("ignoredErrors",se("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(p=Oe(n,-1,"../drawings/drawing"+(r+1)+".xml",Se.DRAW),s[s.length]=se("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=f),l["!comments"].length>0&&(p=Oe(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Se.VML),s[s.length]=se("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function uk(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var s=r.read_shift(2);r.l+=1;var i=r.read_shift(1);return r.l=n,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=s/20),t}function gk(r,e,t){var n=X(145),s=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var i=320;s.hpx?i=ia(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var a=0;s.level&&(a|=s.level),s.hidden&&(a|=16),(s.hpx||s.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var f=-1,u=-1,g=h<<10;g<h+1<<10;++g){c.c=g;var p=Array.isArray(t)?(t[c.r]||[])[c.c]:t[Pe(c)];p&&(f<0&&(f=g),u=g)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,u))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function mk(r,e,t,n){var s=gk(n,t,e);(s.length>17||(e["!rows"]||[])[n])&&q(r,0,s)}var xk=yn,pk=Kn;function vk(){}function yk(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=N_(r),t}function _k(r,e,t){t==null&&(t=X(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var s=1;s<3;++s)t.write_shift(1,0);return ta({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),sf(r,t),t.slice(0,t.l)}function bk(r){var e=zt(r);return[e]}function wk(r,e,t){return t==null&&(t=X(8)),xn(e,t)}function kk(r){var e=pn(r);return[e]}function Sk(r,e,t){return t==null&&(t=X(4)),vn(e,t)}function Tk(r){var e=zt(r),t=r.read_shift(1);return[e,t,"b"]}function Ek(r,e,t){return t==null&&(t=X(9)),xn(e,t),t.write_shift(1,r.v?1:0),t}function Ak(r){var e=pn(r),t=r.read_shift(1);return[e,t,"b"]}function Ck(r,e,t){return t==null&&(t=X(5)),vn(e,t),t.write_shift(1,r.v?1:0),t}function Nk(r){var e=zt(r),t=r.read_shift(1);return[e,t,"e"]}function Ok(r,e,t){return t==null&&(t=X(9)),xn(e,t),t.write_shift(1,r.v),t}function Fk(r){var e=pn(r),t=r.read_shift(1);return[e,t,"e"]}function Dk(r,e,t){return t==null&&(t=X(8)),vn(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function Ik(r){var e=zt(r),t=r.read_shift(4);return[e,t,"s"]}function Pk(r,e,t){return t==null&&(t=X(12)),xn(e,t),t.write_shift(4,e.v),t}function Rk(r){var e=pn(r),t=r.read_shift(4);return[e,t,"s"]}function jk(r,e,t){return t==null&&(t=X(8)),vn(e,t),t.write_shift(4,e.v),t}function Mk(r){var e=zt(r),t=Yn(r);return[e,t,"n"]}function Lk(r,e,t){return t==null&&(t=X(16)),xn(e,t),fn(r.v,t),t}function Bk(r){var e=pn(r),t=Yn(r);return[e,t,"n"]}function Uk(r,e,t){return t==null&&(t=X(12)),vn(e,t),fn(r.v,t),t}function $k(r){var e=zt(r),t=af(r);return[e,t,"n"]}function Wk(r,e,t){return t==null&&(t=X(12)),xn(e,t),of(r.v,t),t}function Hk(r){var e=pn(r),t=af(r);return[e,t,"n"]}function zk(r,e,t){return t==null&&(t=X(8)),vn(e,t),of(r.v,t),t}function Vk(r){var e=zt(r),t=dl(r);return[e,t,"is"]}function Gk(r){var e=zt(r),t=vt(r);return[e,t,"str"]}function Xk(r,e,t){return t==null&&(t=X(12+4*r.v.length)),xn(e,t),it(r.v,t),t.length>t.l?t.slice(0,t.l):t}function Kk(r){var e=pn(r),t=vt(r);return[e,t,"str"]}function Yk(r,e,t){return t==null&&(t=X(8+4*r.v.length)),vn(e,t),it(r.v,t),t.length>t.l?t.slice(0,t.l):t}function qk(r,e,t){var n=r.l+e,s=zt(r);s.r=t["!row"];var i=r.read_shift(1),a=[s,i,"b"];if(t.cellFormula){r.l+=2;var o=Aa(r,n-r.l,t);a[3]=Wn(o,null,s,t.supbooks,t)}else r.l=n;return a}function Jk(r,e,t){var n=r.l+e,s=zt(r);s.r=t["!row"];var i=r.read_shift(1),a=[s,i,"e"];if(t.cellFormula){r.l+=2;var o=Aa(r,n-r.l,t);a[3]=Wn(o,null,s,t.supbooks,t)}else r.l=n;return a}function Zk(r,e,t){var n=r.l+e,s=zt(r);s.r=t["!row"];var i=Yn(r),a=[s,i,"n"];if(t.cellFormula){r.l+=2;var o=Aa(r,n-r.l,t);a[3]=Wn(o,null,s,t.supbooks,t)}else r.l=n;return a}function Qk(r,e,t){var n=r.l+e,s=zt(r);s.r=t["!row"];var i=vt(r),a=[s,i,"str"];if(t.cellFormula){r.l+=2;var o=Aa(r,n-r.l,t);a[3]=Wn(o,null,s,t.supbooks,t)}else r.l=n;return a}var eS=yn,tS=Kn;function rS(r,e){return e==null&&(e=X(4)),e.write_shift(4,r),e}function nS(r,e){var t=r.l+e,n=yn(r),s=fl(r),i=vt(r),a=vt(r),o=vt(r);r.l=t;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function sS(r,e){var t=X(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));Kn({s:st(r[0]),e:st(r[0])},t),ul("rId"+e,t);var n=r[1].Target.indexOf("#"),s=n==-1?"":r[1].Target.slice(n+1);return it(s||"",t),it(r[1].Tooltip||"",t),it("",t),t.slice(0,t.l)}function iS(){}function aS(r,e,t){var n=r.l+e,s=lf(r),i=r.read_shift(1),a=[s];if(a[2]=i,t.cellFormula){var o=K2(r,n-r.l,t);a[1]=o}else r.l=n;return a}function oS(r,e,t){var n=r.l+e,s=yn(r),i=[s];if(t.cellFormula){var a=q2(r,n-r.l,t);i[1]=a,r.l=n}else r.l=n;return i}function lS(r,e,t){t==null&&(t=X(18));var n=Ca(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),t.write_shift(2,s),t}var Vf=["left","right","top","bottom","header","footer"];function cS(r){var e={};return Vf.forEach(function(t){e[t]=Yn(r)}),e}function hS(r,e){return e==null&&(e=X(6*8)),Hf(r),Vf.forEach(function(t){fn(r[t],e)}),e}function dS(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function fS(r,e,t){t==null&&(t=X(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function uS(r){var e=X(24);return e.write_shift(4,4),e.write_shift(4,1),Kn(r,e),e}function gS(r,e){return e==null&&(e=X(16*4+2)),e.write_shift(2,r.password?Ef(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function mS(){}function xS(){}function pS(r,e,t,n,s,i,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Nt(e),e.z=e.z||Ve[14],e.v=Ct(bt(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:n};switch(l.s=Hr(s.cellXfs,e,s),e.l&&i["!links"].push([Pe(l),e.l]),e.c&&i["!comments"].push([Pe(l),e.c]),e.t){case"s":case"str":return s.bookSST?(o=yl(s.Strings,e.v,s.revStrings),l.t="s",l.v=o,a?q(r,18,jk(e,l)):q(r,7,Pk(e,l))):(l.t="str",a?q(r,17,Yk(e,l)):q(r,6,Xk(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?q(r,13,zk(e,l)):q(r,2,Wk(e,l)):a?q(r,16,Uk(e,l)):q(r,5,Lk(e,l)),!0;case"b":return l.t="b",a?q(r,15,Ck(e,l)):q(r,4,Ek(e,l)),!0;case"e":return l.t="e",a?q(r,14,Dk(e,l)):q(r,3,Ok(e,l)),!0}return a?q(r,12,Sk(e,l)):q(r,1,wk(e,l)),!0}function vS(r,e,t,n){var s=$e(e["!ref"]||"A1"),i,a="",o=[];q(r,145);var l=Array.isArray(e),c=s.e.r;e["!rows"]&&(c=Math.max(s.e.r,e["!rows"].length-1));for(var h=s.s.r;h<=c;++h){a=ft(h),mk(r,e,s,h);var f=!1;if(h<=s.e.r)for(var u=s.s.c;u<=s.e.c;++u){h===s.s.r&&(o[u]=pt(u)),i=o[u]+a;var g=l?(e[h]||[])[u]:e[i];if(!g){f=!1;continue}f=pS(r,g,h,u,n,e,f)}}q(r,146)}function yS(r,e){!e||!e["!merges"]||(q(r,177,rS(e["!merges"].length)),e["!merges"].forEach(function(t){q(r,176,tS(t))}),q(r,178))}function _S(r,e){!e||!e["!cols"]||(q(r,390),e["!cols"].forEach(function(t,n){t&&q(r,60,lS(n,t))}),q(r,391))}function bS(r,e){!e||!e["!ref"]||(q(r,648),q(r,649,uS($e(e["!ref"]))),q(r,650))}function wS(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var s=Oe(t,-1,n[1].Target.replace(/#.*$/,""),Se.HLINK);q(r,494,sS(n,s))}}),delete e["!links"]}function kS(r,e,t,n){if(e["!comments"].length>0){var s=Oe(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Se.VML);q(r,551,ul("rId"+s)),e["!legacy"]=s}}function SS(r,e,t,n){if(e["!autofilter"]){var s=e["!autofilter"],i=typeof s.ref=="string"?s.ref:Je(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=jt(i);o.s.r==o.e.r&&(o.e.r=jt(e["!ref"]).e.r,i=Je(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+t.SheetNames[n]+"'!"+i;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),q(r,161,Kn($e(i))),q(r,162)}}function TS(r,e,t){q(r,133),q(r,137,fS(e,t)),q(r,138),q(r,134)}function ES(r,e){e["!protect"]&&q(r,535,gS(e["!protect"]))}function AS(r,e,t,n){var s=At(),i=t.SheetNames[r],a=t.Sheets[i]||{},o=i;try{t&&t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}var l=$e(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],q(s,129),(t.vbaraw||a["!outline"])&&q(s,147,_k(o,a["!outline"])),q(s,148,pk(l)),TS(s,a,t.Workbook),_S(s,a),vS(s,a,r,e),ES(s,a),SS(s,a,t,r),yS(s,a),wS(s,a,n),a["!margins"]&&q(s,476,hS(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&bS(s,a),kS(s,a,r,n),q(s,130),s.end()}function CS(r,e){r.l+=10;var t=vt(r);return{name:t}}var NS=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function OS(r){return!r.Workbook||!r.Workbook.WBProps?"false":o_(r.Workbook.WBProps.date1904)?"true":"false"}var FS="][*?/\\".split("");function Gf(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return FS.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function DS(r,e,t){r.forEach(function(n,s){Gf(n);for(var i=0;i<s;++i)if(n==r[i])throw new Error("Duplicate Sheet Name: "+n);if(t){var a=e&&e[s]&&e[s].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function IS(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];DS(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)tk(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}function Xf(r){var e=[Ze];e[e.length]=se("workbook",null,{xmlns:Gn[0],"xmlns:r":nt.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(NS.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=se("workbookPr",null,n);var s=r.Workbook&&r.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=r.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==r.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=r.SheetNames.length;++i){var a={name:Ie(r.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=se("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=se("definedName",Ie(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function PS(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=Fo(r),t.name=vt(r),t}function RS(r,e){return e||(e=X(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),ul(r.strRelID,e),it(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function jS(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var s=e>8?vt(r):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function MS(r,e){e||(e=X(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),sf(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function LS(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var s=r.read_shift(4),i=O_(r),a=Y2(r,0,t),o=fl(r);r.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function BS(r,e){q(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,s={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};q(r,156,RS(s))}q(r,144)}function US(r,e){e||(e=X(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return it("SheetJS",e),it(Ki.version,e),it(Ki.version,e),it("7262",e),e.length>e.l?e.slice(0,e.l):e}function $S(r,e){e||(e=X(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function WS(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,s=-1,i=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&s==-1?s=n:t[n].Hidden==1&&i==-1&&(i=n);i>s||(q(r,135),q(r,158,$S(s)),q(r,136))}}function HS(r,e){var t=At();return q(t,131),q(t,128,US()),q(t,153,MS(r.Workbook&&r.Workbook.WBProps||null)),WS(t,r),BS(t,r),q(t,132),t.end()}function zS(r,e,t){return(e.slice(-4)===".bin"?HS:Xf)(r)}function VS(r,e,t,n,s){return(e.slice(-4)===".bin"?AS:zf)(r,t,n,s)}function GS(r,e,t){return(e.slice(-4)===".bin"?hw:Nf)(r,t)}function XS(r,e,t){return(e.slice(-4)===".bin"?Mb:Tf)(r,t)}function KS(r,e,t){return(e.slice(-4)===".bin"?Ew:Pf)(r)}function YS(r){return(r.slice(-4)===".bin"?vw:Df)()}function qS(r,e){var t=[];return r.Props&&t.push(G_(r.Props,e)),r.Custprops&&t.push(X_(r.Props,r.Custprops)),t.join("")}function JS(){return""}function ZS(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var i=[];i.push(se("NumberFormat",null,{"ss:Format":Ie(Ve[n.numFmtId])}));var a={"ss:ID":"s"+(21+s)};t.push(se("Style",i.join(""),a))}),se("Styles",t.join(""))}function Kf(r){return se("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+pl(r.Ref,{r:0,c:0})})}function QS(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(Kf(s)))}return se("Names",t.join(""))}function eT(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],a=0;a<s.length;++a){var o=s[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||i.push(Kf(o)))}return i.join("")}function tT(r,e,t,n){if(!r)return"";var s=[];if(r["!margins"]&&(s.push("<PageSetup>"),r["!margins"].header&&s.push(se("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&s.push(se("Footer",null,{"x:Margin":r["!margins"].footer})),s.push(se("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)s.push(se("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==t&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),r["!protect"]&&(s.push(dt("ProtectContents","True")),r["!protect"].objects&&s.push(dt("ProtectObjects","True")),r["!protect"].scenarios&&s.push(dt("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?s.push(dt("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&s.push(dt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){r["!protect"][a[0]]&&s.push("<"+a[1]+"/>")})),s.length==0?"":se("WorksheetOptions",s.join(""),{xmlns:Pt.x})}function rT(r){return r.map(function(e){var t=a_(e.t||""),n=se("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return se("Comment",n,{"ss:Author":e.a})}).join("")}function nT(r,e,t,n,s,i,a){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+Ie(pl(r.f,a))),r.F&&r.F.slice(0,e.length)==e){var l=st(r.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=Ie(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=Ie(r.l.Tooltip))),t["!merges"])for(var c=t["!merges"],h=0;h!=c.length;++h)c[h].s.c!=a.c||c[h].s.r!=a.r||(c[h].e.c>c[h].s.c&&(o["ss:MergeAcross"]=c[h].e.c-c[h].s.c),c[h].e.r>c[h].s.r&&(o["ss:MergeDown"]=c[h].e.r-c[h].s.r));var f="",u="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",u=String(r.v);break;case"b":f="Boolean",u=r.v?"1":"0";break;case"e":f="Error",u=Ys[r.v];break;case"d":f="DateTime",u=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||Ve[14]);break;case"s":f="String",u=i_(r.v||"");break}var g=Hr(n.cellXfs,r,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=a.c+1;var p=r.v!=null?u:"",m=r.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(r.c||[]).length>0&&(m+=rT(r.c)),se("Cell",m,o)}function sT(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Cf(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function iT(r,e,t,n){if(!r["!ref"])return"";var s=$e(r["!ref"]),i=r["!merges"]||[],a=0,o=[];r["!cols"]&&r["!cols"].forEach(function(x,v){ml(x);var b=!!x.width,_=Ca(v,x),k={"ss:Index":v+1};b&&(k["ss:Width"]=na(_.width)),x.hidden&&(k["ss:Hidden"]="1"),o.push(se("Column",null,k))});for(var l=Array.isArray(r),c=s.s.r;c<=s.e.r;++c){for(var h=[sT(c,(r["!rows"]||[])[c])],f=s.s.c;f<=s.e.c;++f){var u=!1;for(a=0;a!=i.length;++a)if(!(i[a].s.c>f)&&!(i[a].s.r>c)&&!(i[a].e.c<f)&&!(i[a].e.r<c)){(i[a].s.c!=f||i[a].s.r!=c)&&(u=!0);break}if(!u){var g={r:c,c:f},p=Pe(g),m=l?(r[c]||[])[f]:r[p];h.push(nT(m,p,r,e,t,n,g))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function aT(r,e,t){var n=[],s=t.SheetNames[r],i=t.Sheets[s],a=i?eT(i,e,r,t):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=i?iT(i,e,r,t):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(tT(i,e,r,t)),n.join("")}function oT(r,e){e||(e={}),r.SSF||(r.SSF=Nt(Ve)),r.SSF&&(ka(),wa(r.SSF),e.revssf=Sa(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],Hr(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(qS(r,e)),t.push(JS()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(se("Worksheet",aT(n,e,r),{"ss:Name":Ie(r.SheetNames[n])}));return t[2]=ZS(r,e),t[3]=QS(r),Ze+se("Workbook",t.join(""),{xmlns:Pt.ss,"xmlns:o":Pt.o,"xmlns:x":Pt.x,"xmlns:ss":Pt.ss,"xmlns:dt":Pt.dt,"xmlns:html":Pt.html})}var io={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function lT(r,e){var t=[],n=[],s=[],i=0,a,o=y0(D0,"n"),l=y0(I0,"n");if(r.Props)for(a=ut(r.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(o,a[i])?t:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],r.Props[a[i]]]);if(r.Custprops)for(a=ut(r.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(r.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(o,a[i])?t:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],r.Custprops[a[i]]]);var c=[];for(i=0;i<s.length;++i)vf.indexOf(s[i][0])>-1||mf.indexOf(s[i][0])>-1||s[i][1]!=null&&c.push(s[i]);n.length&&Re.utils.cfb_add(e,"/SummaryInformation",L0(n,io.SI,l,I0)),(t.length||c.length)&&Re.utils.cfb_add(e,"/DocumentSummaryInformation",L0(t,io.DSI,o,D0,c.length?c:null,io.UDI))}function cT(r,e){var t=e||{},n=Re.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Re.utils.cfb_add(n,s,Yf(r,t)),t.biff==8&&(r.Props||r.Custprops)&&lT(r,n),t.biff==8&&r.vbaraw&&Aw(n,Re.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var hT={0:{f:uk},1:{f:bk},2:{f:$k},3:{f:Nk},4:{f:Tk},5:{f:Mk},6:{f:Gk},7:{f:Ik},8:{f:Qk},9:{f:Zk},10:{f:qk},11:{f:Jk},12:{f:kk},13:{f:Hk},14:{f:Fk},15:{f:Ak},16:{f:Bk},17:{f:Kk},18:{f:Rk},19:{f:dl},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:LS},40:{},42:{},43:{f:Gb},44:{f:zb},45:{f:Yb},46:{f:Jb},47:{f:qb},48:{},49:{f:k_},50:{},51:{f:uw},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Sb},62:{f:Vk},63:{f:yw},64:{f:mS},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:dS},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:yk},148:{f:xk,p:16},151:{f:iS},152:{},153:{f:jS},154:{},155:{},156:{f:PS},157:{},158:{},159:{T:1,f:Pb},160:{T:-1},161:{T:1,f:yn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:eS},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:dw},336:{T:-1},337:{f:xw,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Fo},357:{},358:{},359:{},360:{T:1},361:{},362:{f:vb},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:aS},427:{f:oS},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:cS},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:vk},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:nS},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Fo},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Sw},633:{T:1},634:{T:-1},635:{T:1,f:ww},636:{T:-1},637:{f:A_},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:CS},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xS},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ie(r,e,t,n){var s=e;if(!isNaN(s)){var i=n||(t||[]).length||0,a=r.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&ll(t)&&r.push(t)}}function dT(r,e,t,n){var s=(t||[]).length||0;if(s<=8224)return ie(r,e,t,s);var i=e;if(!isNaN(i)){for(var a=t.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var h=r.next(4);for(h.write_shift(2,i),h.write_shift(2,c),r.push(t.slice(l,l+c)),l+=c;l<s;){for(h=r.next(4),h.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;h.write_shift(2,c),r.push(t.slice(l,l+c)),l+=c}}}function Js(r,e,t){return r||(r=X(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function fT(r,e,t,n){var s=X(9);return Js(s,r,e),_f(t,n||"b",s),s}function uT(r,e,t){var n=X(8+2*t.length);return Js(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function gT(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?Ct(bt(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?ie(r,2,Cb(t,n,s)):ie(r,3,Ab(t,n,s));return;case"b":case"e":ie(r,5,fT(t,n,e.v,e.t));return;case"s":case"str":ie(r,4,uT(t,n,(e.v||"").slice(0,255)));return}ie(r,1,Js(null,t,n))}function mT(r,e,t,n){var s=Array.isArray(e),i=$e(e["!ref"]||"A1"),a,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=Je(i)}for(var c=i.s.r;c<=i.e.r;++c){o=ft(c);for(var h=i.s.c;h<=i.e.c;++h){c===i.s.r&&(l[h]=pt(h)),a=l[h]+o;var f=s?(e[c]||[])[h]:e[a];f&&gT(r,f,c,h)}}}function xT(r,e){for(var t=e||{},n=At(),s=0,i=0;i<r.SheetNames.length;++i)r.SheetNames[i]==t.sheet&&(s=i);if(s==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return ie(n,t.biff==4?1033:t.biff==3?521:9,gl(r,16,t)),mT(n,r.Sheets[r.SheetNames[s]],s,t),ie(n,10),n.end()}function pT(r,e,t){ie(r,49,hb({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}function vT(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&ie(r,1054,ub(s,e[s],t))})}function yT(r,e){var t=X(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),ie(r,2151,t),t=X(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),kf($e(e["!ref"]||"A1"),t),t.write_shift(4,4),ie(r,2152,t)}function _T(r,e){for(var t=0;t<16;++t)ie(r,224,U0({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ie(r,224,U0(n,0,e))})}function bT(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];ie(r,440,bb(n)),n[1].Tooltip&&ie(r,2048,wb(n))}delete e["!links"]}function wT(r,e){if(e){var t=0;e.forEach(function(n,s){++t<=256&&n&&ie(r,125,Tb(Ca(s,n),s))})}}function kT(r,e,t,n,s){var i=16+Hr(s.cellXfs,e,s);if(e.v==null&&!e.bf){ie(r,513,un(t,n,i));return}if(e.bf)ie(r,6,X2(e,t,n,s,i));else switch(e.t){case"d":case"n":var a=e.t=="d"?Ct(bt(e.v)):e.v;ie(r,515,pb(t,n,a,i));break;case"b":case"e":ie(r,517,xb(t,n,e.v,i,s,e.t));break;case"s":case"str":if(s.bookSST){var o=yl(s.Strings,e.v,s.revStrings);ie(r,253,db(t,n,o,i))}else ie(r,516,fb(t,n,(e.v||"").slice(0,255),i,s));break;default:ie(r,513,un(t,n,i))}}function ST(r,e,t){var n=At(),s=t.SheetNames[r],i=t.Sheets[s]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[r]||{},l=Array.isArray(i),c=e.biff==8,h,f="",u=[],g=$e(i["!ref"]||"A1"),p=c?65536:16384;if(g.e.c>255||g.e.r>=p){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,p-1)}ie(n,2057,gl(t,16,e)),ie(n,13,Ut(1)),ie(n,12,Ut(100)),ie(n,15,_t(!0)),ie(n,17,_t(!1)),ie(n,16,fn(.001)),ie(n,95,_t(!0)),ie(n,42,_t(!1)),ie(n,43,_t(!1)),ie(n,130,Ut(1)),ie(n,128,mb()),ie(n,131,_t(!1)),ie(n,132,_t(!1)),c&&wT(n,i["!cols"]),ie(n,512,gb(g,e)),c&&(i["!links"]=[]);for(var m=g.s.r;m<=g.e.r;++m){f=ft(m);for(var x=g.s.c;x<=g.e.c;++x){m===g.s.r&&(u[x]=pt(x)),h=u[x]+f;var v=l?(i[m]||[])[x]:i[h];v&&(kT(n,v,m,x,e),c&&v.l&&i["!links"].push([h,v.l]))}}var b=o.CodeName||o.name||s;return c&&ie(n,574,cb((a.Views||[])[0])),c&&(i["!merges"]||[]).length&&ie(n,229,_b(i["!merges"])),c&&bT(n,i),ie(n,442,wf(b)),c&&yT(n,i),ie(n,10),n.end()}function TT(r,e,t){var n=At(),s=(r||{}).Workbook||{},i=s.Sheets||[],a=s.WBProps||{},o=t.biff==8,l=t.biff==5;if(ie(n,2057,gl(r,5,t)),t.bookType=="xla"&&ie(n,135),ie(n,225,o?Ut(1200):null),ie(n,193,q_(2)),l&&ie(n,191),l&&ie(n,192),ie(n,226),ie(n,92,ib("SheetJS",t)),ie(n,66,Ut(o?1200:1252)),o&&ie(n,353,Ut(0)),o&&ie(n,448),ie(n,317,Eb(r.SheetNames.length)),o&&r.vbaraw&&ie(n,211),o&&r.vbaraw){var c=a.CodeName||"ThisWorkbook";ie(n,442,wf(c))}ie(n,156,Ut(17)),ie(n,25,_t(!1)),ie(n,18,_t(!1)),ie(n,19,Ut(0)),o&&ie(n,431,_t(!1)),o&&ie(n,444,Ut(0)),ie(n,61,lb()),ie(n,64,_t(!1)),ie(n,141,Ut(0)),ie(n,34,_t(OS(r)=="true")),ie(n,14,_t(!0)),o&&ie(n,439,_t(!1)),ie(n,218,Ut(0)),pT(n,r,t),vT(n,r.SSF,t),_T(n,t),o&&ie(n,352,_t(!1));var h=n.end(),f=At();o&&ie(f,140,kb()),o&&t.Strings&&dT(f,252,ob(t.Strings)),ie(f,10);var u=f.end(),g=At(),p=0,m=0;for(m=0;m<r.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*r.SheetNames[m].length;var x=h.length+p+u.length;for(m=0;m<r.SheetNames.length;++m){var v=i[m]||{};ie(g,133,ab({pos:x,hs:v.Hidden||0,dt:0,name:r.SheetNames[m]},t)),x+=e[m].length}var b=g.end();if(p!=b.length)throw new Error("BS8 "+p+" != "+b.length);var _=[];return h.length&&_.push(h),b.length&&_.push(b),u.length&&_.push(u),ht(_)}function ET(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=Nt(Ve)),r&&r.SSF&&(ka(),wa(r.SSF),t.revssf=Sa(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,_l(t),t.cellXfs=[],Hr(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var s=0;s<r.SheetNames.length;++s)n[n.length]=ST(s,t,r);return n.unshift(TT(r,n,t)),ht(n)}function Yf(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var s=jt(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return ET(r,e);case 4:case 3:case 2:return xT(r,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function AT(r,e,t,n){for(var s=r["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>t||s[c].s.c>a)&&!(s[c].e.r<t||s[c].e.c<a)){if(s[c].s.r<t||s[c].s.c<a){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var h=Pe({r:t,c:a}),f=n.dense?(r[t]||[])[a]:r[h],u=f&&f.v!=null&&(f.h||s_(f.w||(Tr(f),f.w)||""))||"",g={};o>1&&(g.rowspan=o),l>1&&(g.colspan=l),n.editable?u='<span contenteditable="true">'+u+"</span>":f&&(g["data-t"]=f&&f.t||"z",f.v!=null&&(g["data-v"]=f.v),f.z!=null&&(g["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+f.l.Target+'">'+u+"</a>")),g.id=(n.id||"sjs")+"-"+h,i.push(se("td",u,g))}}var p="<tr>";return p+i.join("")+"</tr>"}var CT='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',NT="</body></html>";function OT(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function qf(r,e){var t=e||{},n=t.header!=null?t.header:CT,s=t.footer!=null?t.footer:NT,i=[n],a=jt(r["!ref"]);t.dense=Array.isArray(r),i.push(OT(r,a,t));for(var o=a.s.r;o<=a.e.r;++o)i.push(AT(r,a,o,t));return i.push("</table>"+s),i.join("")}function Jf(r,e,t){var n=t||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?st(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(r["!ref"]){var h=jt(r["!ref"]);c.s.r=Math.min(c.s.r,h.s.r),c.s.c=Math.min(c.s.c,h.s.c),c.e.r=Math.max(c.e.r,h.e.r),c.e.c=Math.max(c.e.c,h.e.c),s==-1&&(c.e.r=s=h.e.r+1)}var f=[],u=0,g=r["!rows"]||(r["!rows"]=[]),p=0,m=0,x=0,v=0,b=0,_=0;for(r["!cols"]||(r["!cols"]=[]);p<o.length&&m<l;++p){var k=o[p];if(X0(k)){if(n.display)continue;g[m]={hidden:!0}}var O=k.children;for(x=v=0;x<O.length;++x){var P=O[x];if(!(n.display&&X0(P))){var C=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):l_(P.innerHTML),R=P.getAttribute("data-z")||P.getAttribute("z");for(u=0;u<f.length;++u){var D=f[u];D.s.c==v+i&&D.s.r<m+s&&m+s<=D.e.r&&(v=D.e.c+1-i,u=-1)}_=+P.getAttribute("colspan")||1,((b=+P.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:m+s,c:v+i},e:{r:m+s+(b||1)-1,c:v+i+(_||1)-1}});var M={t:"s",v:C},z=P.getAttribute("data-t")||P.getAttribute("t")||"";C!=null&&(C.length==0?M.t=z||"z":n.raw||C.trim().length==0||z=="s"||(C==="TRUE"?M={t:"b",v:!0}:C==="FALSE"?M={t:"b",v:!1}:isNaN(br(C))?isNaN(js(C).getDate())||(M={t:"d",v:bt(C)},n.cellDates||(M={t:"n",v:Ct(M.v)}),M.z=n.dateNF||Ve[14]):M={t:"n",v:br(C)})),M.z===void 0&&R!=null&&(M.z=R);var G="",Z=P.getElementsByTagName("A");if(Z&&Z.length)for(var Q=0;Q<Z.length&&!(Z[Q].hasAttribute("href")&&(G=Z[Q].getAttribute("href"),G.charAt(0)!="#"));++Q);G&&G.charAt(0)!="#"&&(M.l={Target:G}),n.dense?(r[m+s]||(r[m+s]=[]),r[m+s][v+i]=M):r[Pe({c:v+i,r:m+s})]=M,c.e.c<v+i&&(c.e.c=v+i),v+=_}}++m}return f.length&&(r["!merges"]=(r["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+s),r["!ref"]=Je(c),m>=l&&(r["!fullref"]=Je((c.e.r=o.length-p+m-1+s,c))),r}function Zf(r,e){var t=e||{},n=t.dense?[]:{};return Jf(n,r,e)}function FT(r,e){return mn(Zf(r,e),e)}function X0(r){var e="",t=DT(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function DT(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var IT=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Ls({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return Ze+e}}(),K0=function(){var r=function(i){return Ie(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(i,a,o){var l=[];l.push('      <table:table table:name="'+Ie(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,h=0,f=jt(i["!ref"]||"A1"),u=i["!merges"]||[],g=0,p=Array.isArray(i);if(i["!cols"])for(h=0;h<=f.e.c;++h)l.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var m="",x=i["!rows"]||[];for(c=0;c<f.s.r;++c)m=x[c]?' table:style-name="ro'+x[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=f.e.r;++c){for(m=x[c]?' table:style-name="ro'+x[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),h=0;h<f.s.c;++h)l.push(e);for(;h<=f.e.c;++h){var v=!1,b={},_="";for(g=0;g!=u.length;++g)if(!(u[g].s.c>h)&&!(u[g].s.r>c)&&!(u[g].e.c<h)&&!(u[g].e.r<c)){(u[g].s.c!=h||u[g].s.r!=c)&&(v=!0),b["table:number-columns-spanned"]=u[g].e.c-u[g].s.c+1,b["table:number-rows-spanned"]=u[g].e.r-u[g].s.r+1;break}if(v){l.push(t);continue}var k=Pe({r:c,c:h}),O=p?(i[c]||[])[h]:i[k];if(O&&O.f&&(b["table:formula"]=Ie(Q2(O.f)),O.F&&O.F.slice(0,k.length)==k)){var P=jt(O.F);b["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,b["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!O){l.push(e);continue}switch(O.t){case"b":_=O.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=O.v?"true":"false";break;case"n":_=O.w||String(O.v||0),b["office:value-type"]="float",b["office:value"]=O.v||0;break;case"s":case"str":_=O.v==null?"":O.v,b["office:value-type"]="string";break;case"d":_=O.w||bt(O.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=bt(O.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var C=r(_);if(O.l&&O.l.Target){var R=O.l.Target;R=R.charAt(0)=="#"?"#"+ek(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),C=se("text:a",C,{"xlink:href":R.replace(/&/g,"&amp;")})}l.push("          "+se("table:table-cell",se("text:p",C,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(i,a){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var h=0;h<c["!cols"].length;++h)if(c["!cols"][h]){var f=c["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;ml(f),f.ods=o;var u=c["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var h=0;h<c["!rows"].length;++h)if(c["!rows"][h]){c["!rows"][h].ods=l;var f=c["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Ze],c=Ls({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Ls({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+h+`>
`),l.push(uf().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),s(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(n(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Qf(r,e){if(e.bookType=="fods")return K0(r,e);var t=sl(),n="",s=[],i=[];return n="mimetype",_e(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",_e(t,n,K0(r,e)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",_e(t,n,IT(r,e)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",_e(t,n,Ze+uf()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",_e(t,n,V_(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",_e(t,n,H_(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function aa(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function PT(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):qt(Ms(r))}function RT(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function $r(r){var e=r.reduce(function(s,i){return s+i.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(s){t.set(s,n),n+=s.length}),t}function jT(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)r[e+i]=s&255;r[e+15]|=t>=0?0:128}function Bs(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function Ne(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Ln(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function Qe(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],s=Bs(r,t),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=t[0];r[t[0]++]>=128;);o=r.slice(l,t[0])}break;case 5:a=4,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=Bs(r,t),o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:i};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function ot(r){var e=[];return r.forEach(function(t,n){t.forEach(function(s){s.data&&(e.push(Ne(n*8+s.type)),s.type==2&&e.push(Ne(s.data.length)),e.push(s.data))})}),$r(e)}function Gt(r){for(var e,t=[],n=[0];n[0]<r.length;){var s=Bs(r,n),i=Qe(r.slice(n[0],n[0]+s));n[0]+=s;var a={id:Ln(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=Qe(o.data),c=Ln(l[3][0].data);a.messages.push({meta:l,data:r.slice(n[0],n[0]+c)}),n[0]+=c}),(e=i[3])!=null&&e[0]&&(a.merge=Ln(i[3][0].data)>>>0>0),t.push(a)}return t}function Cn(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:Ne(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:Ne(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(a){s.push(a.data),a.meta[3]=[{type:0,data:Ne(a.data.length)}],n[2].push({data:ot(a.meta),type:2})});var i=ot(n);e.push(Ne(i.length)),e.push(i),s.forEach(function(a){return e.push(a)})}),$r(e)}function MT(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=Bs(e,t),s=[];t[0]<e.length;){var i=e[t[0]]&3;if(i==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}s.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,c=0;if(i==1?(c=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(c=(e[t[0]++]>>2)+1,i==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),s=[$r(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var h=$r(s);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Xt(r){for(var e=[],t=0;t<r.length;){var n=r[t++],s=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(MT(n,r.slice(t,t+s))),t+=s}if(t!==r.length)throw new Error("data is not a valid framed stream!");return $r(e)}function Nn(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),s=new Uint8Array(4);e.push(s);var i=Ne(n),a=i.length;e.push(i),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),a+=n,s[0]=0,s[1]=a&255,s[2]=a>>8&255,s[3]=a>>16&255,t+=n}return $r(e)}function ao(r,e){var t=new Uint8Array(32),n=aa(t),s=12,i=0;switch(t[0]=5,r.t){case"n":t[1]=2,jT(t,s,r.v),i|=1,s+=16;break;case"b":t[1]=6,n.setFloat64(s,r.v?1:0,!0),i|=2,s+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(s,e.indexOf(r.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,i,!0),t.slice(0,s)}function oo(r,e){var t=new Uint8Array(32),n=aa(t),s=12,i=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(s,r.v,!0),i|=32,s+=8;break;case"b":t[2]=6,n.setFloat64(s,r.v?1:0,!0),i|=32,s+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(s,e.indexOf(r.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,i,!0),t.slice(0,s)}function Ar(r){var e=Qe(r);return Bs(e[1][0].data)}function LT(r,e,t){var n,s,i,a;if(!((n=r[6])!=null&&n[0])||!((s=r[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(i=r[8])==null?void 0:i[0])==null?void 0:a.data)&&Ln(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=aa(r[7][0].data),h=0,f=[],u=aa(r[4][0].data),g=0,p=[],m=0;m<e.length;++m){if(e[m]==null){c.setUint16(m*2,65535,!0),u.setUint16(m*2,65535);continue}c.setUint16(m*2,h,!0),u.setUint16(m*2,g,!0);var x,v;switch(typeof e[m]){case"string":x=ao({t:"s",v:e[m]},t),v=oo({t:"s",v:e[m]},t);break;case"number":x=ao({t:"n",v:e[m]},t),v=oo({t:"n",v:e[m]},t);break;case"boolean":x=ao({t:"b",v:e[m]},t),v=oo({t:"b",v:e[m]},t);break;default:throw new Error("Unsupported value "+e[m])}f.push(x),h+=x.length,p.push(v),g+=v.length,++l}for(r[2][0].data=Ne(l);m<r[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),u.setUint16(m*2,65535,!0);return r[6][0].data=$r(f),r[3][0].data=$r(p),l}function BT(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=jt(t["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Je(n)));var i=oa(t,{range:n,header:1}),a=["~Sh33tJ5~"];i.forEach(function(U){return U.forEach(function(I){typeof I=="string"&&a.push(I)})});var o={},l=[],c=Re.read(e.numbers,{type:"base64"});c.FileIndex.map(function(U,I){return[U,c.FullPaths[I]]}).forEach(function(U){var I=U[0],F=U[1];if(I.type==2&&I.name.match(/\.iwa/)){var Y=I.content,ue=Xt(Y),ge=Gt(ue);ge.forEach(function(fe){l.push(fe.id),o[fe.id]={deps:[],location:F,type:Ln(fe.messages[0].meta[1][0].data)}})}}),l.sort(function(U,I){return U-I});var h=l.filter(function(U){return U>1}).map(function(U){return[U,Ne(U)]});c.FileIndex.map(function(U,I){return[U,c.FullPaths[I]]}).forEach(function(U){var I=U[0];if(U[1],!!I.name.match(/\.iwa/)){var F=Gt(Xt(I.content));F.forEach(function(Y){Y.messages.forEach(function(ue){h.forEach(function(ge){Y.messages.some(function(fe){return Ln(fe.meta[1][0].data)!=11006&&RT(fe.data,ge[1])})&&o[ge[0]].deps.push(Y.id)})})})}});for(var f=Re.find(c,o[1].location),u=Gt(Xt(f.content)),g,p=0;p<u.length;++p){var m=u[p];m.id==1&&(g=m)}var x=Ar(Qe(g.messages[0].data)[1][0].data);for(f=Re.find(c,o[x].location),u=Gt(Xt(f.content)),p=0;p<u.length;++p)m=u[p],m.id==x&&(g=m);for(x=Ar(Qe(g.messages[0].data)[2][0].data),f=Re.find(c,o[x].location),u=Gt(Xt(f.content)),p=0;p<u.length;++p)m=u[p],m.id==x&&(g=m);for(x=Ar(Qe(g.messages[0].data)[2][0].data),f=Re.find(c,o[x].location),u=Gt(Xt(f.content)),p=0;p<u.length;++p)m=u[p],m.id==x&&(g=m);var v=Qe(g.messages[0].data);{v[6][0].data=Ne(n.e.r+1),v[7][0].data=Ne(n.e.c+1);var b=Ar(v[46][0].data),_=Re.find(c,o[b].location),k=Gt(Xt(_.content));{for(var O=0;O<k.length&&k[O].id!=b;++O);if(k[O].id!=b)throw"Bad ColumnRowUIDMapArchive";var P=Qe(k[O].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var C=0;C<=n.e.c;++C){var R=[];R[1]=R[2]=[{type:0,data:Ne(C+420690)}],P[1].push({type:2,data:ot(R)}),P[2].push({type:0,data:Ne(C)}),P[3].push({type:0,data:Ne(C)})}P[4]=[],P[5]=[],P[6]=[];for(var D=0;D<=n.e.r;++D)R=[],R[1]=R[2]=[{type:0,data:Ne(D+726270)}],P[4].push({type:2,data:ot(R)}),P[5].push({type:0,data:Ne(D)}),P[6].push({type:0,data:Ne(D)});k[O].messages[0].data=ot(P)}_.content=Nn(Cn(k)),_.size=_.content.length,delete v[46];var M=Qe(v[4][0].data);{M[7][0].data=Ne(n.e.r+1);var z=Qe(M[1][0].data),G=Ar(z[2][0].data);_=Re.find(c,o[G].location),k=Gt(Xt(_.content));{if(k[0].id!=G)throw"Bad HeaderStorageBucket";var Z=Qe(k[0].messages[0].data);for(D=0;D<i.length;++D){var Q=Qe(Z[2][0].data);Q[1][0].data=Ne(D),Q[4][0].data=Ne(i[D].length),Z[2][D]={type:Z[2][0].type,data:ot(Q)}}k[0].messages[0].data=ot(Z)}_.content=Nn(Cn(k)),_.size=_.content.length;var V=Ar(M[2][0].data);_=Re.find(c,o[V].location),k=Gt(Xt(_.content));{if(k[0].id!=V)throw"Bad HeaderStorageBucket";for(Z=Qe(k[0].messages[0].data),C=0;C<=n.e.c;++C)Q=Qe(Z[2][0].data),Q[1][0].data=Ne(C),Q[4][0].data=Ne(n.e.r+1),Z[2][C]={type:Z[2][0].type,data:ot(Q)};k[0].messages[0].data=ot(Z)}_.content=Nn(Cn(k)),_.size=_.content.length;var me=Ar(M[4][0].data);(function(){for(var U=Re.find(c,o[me].location),I=Gt(Xt(U.content)),F,Y=0;Y<I.length;++Y){var ue=I[Y];ue.id==me&&(F=ue)}var ge=Qe(F.messages[0].data);{ge[3]=[];var fe=[];a.forEach(function(we,at){fe[1]=[{type:0,data:Ne(at)}],fe[2]=[{type:0,data:Ne(1)}],fe[3]=[{type:2,data:PT(we)}],ge[3].push({type:2,data:ot(fe)})})}F.messages[0].data=ot(ge);var oe=Cn(I),Ce=Nn(oe);U.content=Ce,U.size=U.content.length})();var ee=Qe(M[3][0].data);{var B=ee[1][0];delete ee[2];var le=Qe(B.data);{var Ee=Ar(le[2][0].data);(function(){for(var U=Re.find(c,o[Ee].location),I=Gt(Xt(U.content)),F,Y=0;Y<I.length;++Y){var ue=I[Y];ue.id==Ee&&(F=ue)}var ge=Qe(F.messages[0].data);{delete ge[6],delete ee[7];var fe=new Uint8Array(ge[5][0].data);ge[5]=[];for(var oe=0,Ce=0;Ce<=n.e.r;++Ce){var we=Qe(fe);oe+=LT(we,i[Ce],a),we[1][0].data=Ne(Ce),ge[5].push({data:ot(we),type:2})}ge[1]=[{type:0,data:Ne(n.e.c+1)}],ge[2]=[{type:0,data:Ne(n.e.r+1)}],ge[3]=[{type:0,data:Ne(oe)}],ge[4]=[{type:0,data:Ne(n.e.r+1)}]}F.messages[0].data=ot(ge);var at=Cn(I),ke=Nn(at);U.content=ke,U.size=U.content.length})()}B.data=ot(le)}M[3][0].data=ot(ee)}v[4][0].data=ot(M)}g.messages[0].data=ot(v);var Me=Cn(u),N=Nn(Me);return f.content=N,f.size=f.content.length,c}function UT(r){return function(t){for(var n=0;n!=r.length;++n){var s=r[n];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function _l(r){UT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function $T(r,e){return e.bookType=="ods"?Qf(r,e):e.bookType=="numbers"?BT(r,e):e.bookType=="xlsb"?WT(r,e):HT(r,e)}function WT(r,e){Dn=1024,r&&!r.SSF&&(r.SSF=Nt(Ve)),r&&r.SSF&&(ka(),wa(r.SSF),e.revssf=Sa(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Cs?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=Rf.indexOf(e.bookType)>-1,s=hf();_l(e=e||{});var i=sl(),a="",o=0;if(e.cellXfs=[],Hr(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",_e(i,a,gf(r.Props,e)),s.coreprops.push(a),Oe(e.rels,2,a,Se.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],c=0;c<r.SheetNames.length;++c)(r.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(r.SheetNames[c]);r.Props.SheetNames=l}for(r.Props.Worksheets=r.Props.SheetNames.length,_e(i,a,xf(r.Props)),s.extprops.push(a),Oe(e.rels,3,a,Se.EXT_PROPS),r.Custprops!==r.Props&&ut(r.Custprops||{}).length>0&&(a="docProps/custom.xml",_e(i,a,pf(r.Custprops)),s.custprops.push(a),Oe(e.rels,4,a,Se.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var h={"!id":{}},f=r.Sheets[r.SheetNames[o-1]],u=(f||{})["!type"]||"sheet";switch(u){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,_e(i,a,VS(o-1,a,e,r,h)),s.sheets.push(a),Oe(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Se.WS[0])}if(f){var g=f["!comments"],p=!1,m="";g&&g.length>0&&(m="xl/comments"+o+"."+t,_e(i,m,KS(g,m)),s.comments.push(m),Oe(h,-1,"../comments"+o+"."+t,Se.CMNT),p=!0),f["!legacy"]&&p&&_e(i,"xl/drawings/vmlDrawing"+o+".vml",If(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&_e(i,ff(a),jn(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,_e(i,a,XS(e.Strings,a,e)),s.strs.push(a),Oe(e.wbrels,-1,"sharedStrings."+t,Se.SST)),a="xl/workbook."+t,_e(i,a,zS(r,a)),s.workbooks.push(a),Oe(e.rels,1,a,Se.WB),a="xl/theme/theme1.xml",_e(i,a,Ff(r.Themes,e)),s.themes.push(a),Oe(e.wbrels,-1,"theme/theme1.xml",Se.THEME),a="xl/styles."+t,_e(i,a,GS(r,a,e)),s.styles.push(a),Oe(e.wbrels,-1,"styles."+t,Se.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",_e(i,a,r.vbaraw),s.vba.push(a),Oe(e.wbrels,-1,"vbaProject.bin",Se.VBA)),a="xl/metadata."+t,_e(i,a,YS(a)),s.metadata.push(a),Oe(e.wbrels,-1,"metadata."+t,Se.XLMETA),_e(i,"[Content_Types].xml",df(s,e)),_e(i,"_rels/.rels",jn(e.rels)),_e(i,"xl/_rels/workbook."+t+".rels",jn(e.wbrels)),delete e.revssf,delete e.ssf,i}function HT(r,e){Dn=1024,r&&!r.SSF&&(r.SSF=Nt(Ve)),r&&r.SSF&&(ka(),wa(r.SSF),e.revssf=Sa(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Cs?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=Rf.indexOf(e.bookType)>-1,s=hf();_l(e=e||{});var i=sl(),a="",o=0;if(e.cellXfs=[],Hr(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",_e(i,a,gf(r.Props,e)),s.coreprops.push(a),Oe(e.rels,2,a,Se.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],c=0;c<r.SheetNames.length;++c)(r.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(r.SheetNames[c]);r.Props.SheetNames=l}r.Props.Worksheets=r.Props.SheetNames.length,_e(i,a,xf(r.Props)),s.extprops.push(a),Oe(e.rels,3,a,Se.EXT_PROPS),r.Custprops!==r.Props&&ut(r.Custprops||{}).length>0&&(a="docProps/custom.xml",_e(i,a,pf(r.Custprops)),s.custprops.push(a),Oe(e.rels,4,a,Se.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=r.SheetNames.length;++o){var f={"!id":{}},u=r.Sheets[r.SheetNames[o-1]],g=(u||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,_e(i,a,zf(o-1,e,r,f)),s.sheets.push(a),Oe(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Se.WS[0])}if(u){var p=u["!comments"],m=!1,x="";if(p&&p.length>0){var v=!1;p.forEach(function(b){b[1].forEach(function(_){_.T==!0&&(v=!0)})}),v&&(x="xl/threadedComments/threadedComment"+o+"."+t,_e(i,x,_w(p,h,e)),s.threadedcomments.push(x),Oe(f,-1,"../threadedComments/threadedComment"+o+"."+t,Se.TCMNT)),x="xl/comments"+o+"."+t,_e(i,x,Pf(p)),s.comments.push(x),Oe(f,-1,"../comments"+o+"."+t,Se.CMNT),m=!0}u["!legacy"]&&m&&_e(i,"xl/drawings/vmlDrawing"+o+".vml",If(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}f["!id"].rId1&&_e(i,ff(a),jn(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,_e(i,a,Tf(e.Strings,e)),s.strs.push(a),Oe(e.wbrels,-1,"sharedStrings."+t,Se.SST)),a="xl/workbook."+t,_e(i,a,Xf(r)),s.workbooks.push(a),Oe(e.rels,1,a,Se.WB),a="xl/theme/theme1.xml",_e(i,a,Ff(r.Themes,e)),s.themes.push(a),Oe(e.wbrels,-1,"theme/theme1.xml",Se.THEME),a="xl/styles."+t,_e(i,a,Nf(r,e)),s.styles.push(a),Oe(e.wbrels,-1,"styles."+t,Se.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",_e(i,a,r.vbaraw),s.vba.push(a),Oe(e.wbrels,-1,"vbaProject.bin",Se.VBA)),a="xl/metadata."+t,_e(i,a,Df()),s.metadata.push(a),Oe(e.wbrels,-1,"metadata."+t,Se.XLMETA),h.length>1&&(a="xl/persons/person.xml",_e(i,a,bw(h)),s.people.push(a),Oe(e.wbrels,-1,"persons/person.xml",Se.PEOPLE)),_e(i,"[Content_Types].xml",df(s,e)),_e(i,"_rels/.rels",jn(e.rels)),_e(i,"xl/_rels/workbook."+t+".rels",jn(e.wbrels)),delete e.revssf,delete e.ssf,i}function zT(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=Sr(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function eu(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Xs(e.file,Re.write(r,{type:Ae?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Re.write(r,e)}function VT(r,e){var t=Nt(e||{}),n=$T(r,t);return GT(n,t)}function GT(r,e){var t={},n=Ae?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=r.FullPaths?Re.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(ba(s))}return e.password&&typeof encrypt_agile<"u"?eu(encrypt_agile(s,e.password),e):e.type==="file"?Xs(e.file,s):e.type=="string"?Ss(s):s}function XT(r,e){var t=e||{},n=cT(r,t);return eu(n,t)}function ar(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return Rs(Ms(n));case"binary":return Ms(n);case"string":return r;case"file":return Xs(e.file,n,"utf8");case"buffer":return Ae?Er(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ar(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function KT(r,e){switch(e.type){case"base64":return Rs(r);case"binary":return r;case"string":return r;case"file":return Xs(e.file,r,"binary");case"buffer":return Ae?Er(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Ei(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?Rs(t):e.type=="string"?Ss(t):t;case"file":return Xs(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function tu(r,e){wy(),IS(r);var t=Nt(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=tu(r,t);return t.type="array",ba(n)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=r.SheetNames.indexOf(t.sheet),!r.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return ar(oT(r,t),t);case"slk":case"sylk":return ar(Ob.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"htm":case"html":return ar(qf(r.Sheets[r.SheetNames[s]],t),t);case"txt":return KT(ru(r.Sheets[r.SheetNames[s]],t),t);case"csv":return ar(bl(r.Sheets[r.SheetNames[s]],t),t,"\uFEFF");case"dif":return ar(Fb.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"dbf":return Ei(Nb.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"prn":return ar(Db.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"rtf":return ar(Bb.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"eth":return ar(Sf.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"fods":return ar(Qf(r,t),t);case"wk1":return Ei($0.sheet_to_wk1(r.Sheets[r.SheetNames[s]],t),t);case"wk3":return Ei($0.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Ei(Yf(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),XT(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return VT(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function YT(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function qT(r,e,t){var n={};return n.type="file",n.file=e,YT(n),tu(r,n)}function JT(r,e,t,n,s,i,a,o){var l=ft(t),c=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,u=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:t,enumerable:!1})}catch{u.__rowNum__=t}else u.__rowNum__=t;if(!a||r[t])for(var g=e.s.c;g<=e.e.c;++g){var p=a?r[t][g]:r[n[g]+l];if(p===void 0||p.t===void 0){if(c===void 0)continue;i[g]!=null&&(u[i[g]]=c);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[g]!=null){if(m==null)if(p.t=="e"&&m===null)u[i[g]]=null;else if(c!==void 0)u[i[g]]=c;else if(h&&m===null)u[i[g]]=null;else continue;else u[i[g]]=h&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:Tr(p,m,o);m!=null&&(f=!1)}}return{row:u,isempty:f}}function oa(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},h=c.range!=null?c.range:r["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof h){case"string":l=$e(h);break;case"number":l=$e(r["!ref"]),l.s.r=h;break;default:l=h}n>0&&(s=0);var f=ft(l.s.r),u=[],g=[],p=0,m=0,x=Array.isArray(r),v=l.s.r,b=0,_={};x&&!r[v]&&(r[v]=[]);var k=c.skipHidden&&r["!cols"]||[],O=c.skipHidden&&r["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(k[b]||{}).hidden)switch(u[b]=pt(b),t=x?r[v][b]:r[u[b]+f],n){case 1:i[b]=b-l.s.c;break;case 2:i[b]=u[b];break;case 3:i[b]=c.header[b-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=Tr(t,null,c),m=_[a]||0,!m)_[a]=1;else{do o=a+"_"+m++;while(_[o]);_[a]=m,_[o]=1}i[b]=o}for(v=l.s.r+s;v<=l.e.r;++v)if(!(O[v]||{}).hidden){var P=JT(r,l,v,u,n,i,x,c);(P.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(g[p++]=P.row)}return g.length=p,g}var Y0=/"/g;function ZT(r,e,t,n,s,i,a,o){for(var l=!0,c=[],h="",f=ft(t),u=e.s.c;u<=e.e.c;++u)if(n[u]){var g=o.dense?(r[t]||[])[u]:r[n[u]+f];if(g==null)h="";else if(g.v!=null){l=!1,h=""+(o.rawNumbers&&g.t=="n"?g.v:Tr(g,null,o));for(var p=0,m=0;p!==h.length;++p)if((m=h.charCodeAt(p))===s||m===i||m===34||o.forceQuotes){h='"'+h.replace(Y0,'""')+'"';break}h=="ID"&&(h='"ID"')}else g.f!=null&&!g.F?(l=!1,h="="+g.f,h.indexOf(",")>=0&&(h='"'+h.replace(Y0,'""')+'"')):h="";c.push(h)}return o.blankrows===!1&&l?null:c.join(a)}function bl(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var s=$e(r["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),h="",f=[];n.dense=Array.isArray(r);for(var u=n.skipHidden&&r["!cols"]||[],g=n.skipHidden&&r["!rows"]||[],p=s.s.c;p<=s.e.c;++p)(u[p]||{}).hidden||(f[p]=pt(p));for(var m=0,x=s.s.r;x<=s.e.r;++x)(g[x]||{}).hidden||(h=ZT(r,s,x,f,a,l,i,n),h!=null&&(n.strip&&(h=h.replace(c,"")),(h||n.blankrows!==!1)&&t.push((m++?o:"")+h)));return delete n.dense,t.join("")}function ru(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=bl(r,e);return t}function QT(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var s=$e(r["!ref"]),i="",a=[],o,l=[],c=Array.isArray(r);for(o=s.s.c;o<=s.e.c;++o)a[o]=pt(o);for(var h=s.s.r;h<=s.e.r;++h)for(i=ft(h),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,t=c?(r[h]||[])[o]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}l[l.length]=e+"="+n}return l}function nu(r,e,t){var n=t||{},s=+!n.skipHeader,i=r||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?st(n.origin):n.origin;a=l.r,o=l.c}var c,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var f=$e(i["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+e.length-1+s)}else a==-1&&(a=0,h.e.r=e.length-1+s);var u=n.header||[],g=0;e.forEach(function(m,x){ut(m).forEach(function(v){(g=u.indexOf(v))==-1&&(u[g=u.length]=v);var b=m[v],_="z",k="",O=Pe({c:o+g,r:a+x+s});c=Us(i,O),b&&typeof b=="object"&&!(b instanceof Date)?i[O]=b:(typeof b=="number"?_="n":typeof b=="boolean"?_="b":typeof b=="string"?_="s":b instanceof Date?(_="d",n.cellDates||(_="n",b=Ct(b)),k=n.dateNF||Ve[14]):b===null&&n.nullError&&(_="e",b=0),c?(c.t=_,c.v=b,delete c.w,delete c.R,k&&(c.z=k)):i[O]=c={t:_,v:b},k&&(c.z=k))})}),h.e.c=Math.max(h.e.c,o+u.length-1);var p=ft(a);if(s)for(g=0;g<u.length;++g)i[pt(g+o)+p]={t:"s",v:u[g]};return i["!ref"]=Je(h),i}function eE(r,e){return nu(null,r,e)}function Us(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=st(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?Us(r,Pe(e)):Us(r,Pe({r:e,c:t||0}))}function tE(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function rE(){return{SheetNames:[],Sheets:{}}}function nE(r,e,t,n){var s=1;if(!t)for(;s<=65535&&r.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||t;for(++s;s<=65535&&r.SheetNames.indexOf(t=a+s)!=-1;++s);}if(Gf(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function sE(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=tE(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function iE(r,e){return r.z=e,r}function su(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function aE(r,e,t){return su(r,"#"+e,t)}function oE(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function lE(r,e,t,n){for(var s=typeof e!="string"?e:$e(e),i=typeof e=="string"?e:Je(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=Us(r,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=t,n&&(l.D=!0))}return r}var lo={encode_col:pt,encode_row:ft,encode_cell:Pe,encode_range:Je,decode_col:hl,decode_row:cl,split_cell:w_,decode_cell:st,decode_range:jt,format_cell:Tr,sheet_add_aoa:nf,sheet_add_json:nu,sheet_add_dom:Jf,aoa_to_sheet:Xn,json_to_sheet:eE,table_to_sheet:Zf,table_to_book:FT,sheet_to_csv:bl,sheet_to_txt:ru,sheet_to_json:oa,sheet_to_html:qf,sheet_to_formulae:QT,sheet_to_row_object_array:oa,sheet_get_cell:Us,book_new:rE,book_append_sheet:nE,book_set_sheet_visibility:sE,cell_set_number_format:iE,cell_set_hyperlink:su,cell_set_internal_link:aE,cell_add_comment:oE,sheet_set_array_formula:lE,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function cE(r){const{transactions:e,accounts:t,categories:n,dateRange:s,exchangeRate:i}=r,a=lo.book_new(),o=v=>{if(i){const b=v/i;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b)}return`₦${new Intl.NumberFormat("en-NG").format(v)}`},l=[["CHURCH OF CHRIST, KAGINI"],["STATEMENT OF ACCOUNT"],[`Period: ${s.label}`],[`Generated on: ${Ge(new Date,"MMMM dd, yyyy")}`],[""],["TOTAL INCOME",o(f)],[""],["TOTAL EXPENSES",o(u)],[""]],c=e.filter(v=>v.type==="income"),h=e.filter(v=>v.type==="expense"),f=c.reduce((v,b)=>v+b.amount,0),u=h.reduce((v,b)=>v+b.amount,0);l.push(["NET INCOME",o(f-u)]),l.push([""]),l.push(["DETAILED TRANSACTIONS"]),l.push(["Date","Description","Account","Category","Type","Amount"]);const g=e.sort((v,b)=>new Date(v.date).getTime()-new Date(b.date).getTime()).map(v=>{const b=t.find(P=>P.id===v.account_id),_=n.find(P=>P.id===v.category_id),k=t.find(P=>P.id===v.target_account_id);let O=v.description||"Transaction";return v.type==="transfer"&&(O=`Transfer: ${b==null?void 0:b.name} → ${k==null?void 0:k.name}`),[Ge(new Date(v.date),"MMM dd, yyyy"),O,(b==null?void 0:b.name)||"Unknown Account",v.type==="transfer"?"Transfer":(_==null?void 0:_.name)||"Uncategorized",v.type.charAt(0).toUpperCase()+v.type.slice(1),v.type==="expense"?`-${o(Math.abs(v.amount))}`:o(Math.abs(v.amount))]}),p=[...l,...g],m=lo.aoa_to_sheet(p);m["!cols"]=[{width:20},{width:30},{width:20},{width:20},{width:15},{width:15}],lo.book_append_sheet(a,m,"Statement of Account");const x=`Statement_of_Account_${Ge(s.start,"yyyy-MM-dd")}_to_${Ge(s.end,"yyyy-MM-dd")}.xlsx`;qT(a,x)}const Jr=10;function hE({addToast:r}){const[e,t]=J.useState(!1),[n,s]=J.useState(null),[i,a]=J.useState(null),[o,l]=J.useState("all"),[c,h]=J.useState("all"),[f,u]=J.useState(null),[g,p]=J.useState(Jr),[m,x]=J.useState("thisMonth"),[v,b]=J.useState(Ge(nn(new Date),"yyyy-MM-dd")),[_,k]=J.useState(Ge(yr(new Date),"yyyy-MM-dd")),[O,P]=J.useState(!1),[C,R]=J.useState(!1),{transactions:D,accounts:M,categories:z,deleteTransaction:G,exchangeRate:Z}=Ht(),Q=dr(),V=(Q==null?void 0:Q.isAdmin)??!1,ee=(()=>{const ne=new Date;switch(m){case"thisMonth":return{start:nn(ne),end:yr(ne),label:Ge(ne,"MMMM yyyy")};case"lastMonth":const xe=lh(ne,1);return{start:nn(xe),end:yr(xe),label:Ge(xe,"MMMM yyyy")};case"custom":return{start:new Date(v),end:new Date(_),label:`${Ge(new Date(v),"MMM dd, yyyy")} - ${Ge(new Date(_),"MMM dd, yyyy")}`};default:return{start:nn(ne),end:yr(ne),label:Ge(ne,"MMMM yyyy")}}})(),B=D.filter(ne=>{const xe=new Date(ne.date);return xe<ee.start||xe>ee.end||o!=="all"&&ne.type!==o?!1:c!=="all"?c==="uncategorized"?!ne.category_id:ne.category_id===c:!0}).sort((ne,xe)=>new Date(xe.created_at).getTime()-new Date(ne.created_at).getTime()),le=B.slice(0,g),Ee=B.length>g,Me=B.reduce((ne,xe)=>ne+Math.abs(xe.amount),0),N=ne=>{if(Z){const xe=ne/Z;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(xe)}return`₦${new Intl.NumberFormat("en-NG").format(ne)}`},U=ne=>{switch(ne){case"income":return In;case"expense":return Ii;case"transfer":return Pi;default:return In}},I=ne=>{switch(ne){case"income":return"text-green-600 dark:text-green-400";case"expense":return"text-red-600 dark:text-red-400";case"transfer":return"text-blue-600 dark:text-blue-400";default:return"text-gray-600 dark:text-gray-400"}},F=()=>{t(!1),r({type:"success",title:"Transaction added"})},Y=()=>{s(null),r({type:"success",title:"Transaction updated"})},ue=async()=>{if(i)try{await G(i.id),a(null),r({type:"success",title:"Transaction deleted"})}catch{r({type:"error",title:"Delete failed"})}},ge=ne=>{u(f===ne?null:ne)},fe=()=>{p(ne=>ne+Jr)},oe=()=>{cE({transactions:B,accounts:M,categories:z,dateRange:ee,exchangeRate:Z}),P(!1),r({type:"success",title:"Excel file downloaded",message:"Statement of Account has been exported to Excel"})},Ce=()=>{R(!0),P(!1)},we=z.filter(ne=>D.some(xe=>xe.category_id===ne.id)),at=D.some(ne=>!ne.category_id),ke=()=>{if(c==="all")return"all categories";if(c==="uncategorized")return"uncategorized";const ne=z.find(xe=>xe.id===c);return ne?ne.name.toLowerCase():"selected category"};return d.jsxs("div",{className:"p-4 sm:p-6 bg-gray-50 dark:bg-gray-950 transition-colors duration-200",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-4",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white",children:"Transactions"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm sm:text-base",children:V?"Track church income, expenses, and transfers":"View church income, expenses, and transfers"})]}),V&&d.jsxs("button",{onClick:()=>t(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 dark:from-blue-500 dark:to-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all duration-200 flex items-center justify-center gap-2 text-sm sm:text-base shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95",children:[d.jsx(Bn,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Add Transaction"]}),V&&d.jsxs("div",{className:"relative",children:[d.jsxs("button",{onClick:()=>P(!O),className:"bg-gradient-to-r from-green-600 to-green-700 dark:from-green-500 dark:to-green-600 text-white px-4 py-2 rounded-lg font-medium hover:from-green-700 hover:to-green-800 dark:hover:from-green-600 dark:hover:to-green-700 transition-all duration-200 flex items-center justify-center gap-2 text-sm sm:text-base shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95",children:[d.jsx(co,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Export"]}),O&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>P(!1)}),d.jsxs("div",{className:"absolute right-0 top-full mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-2 z-20",children:[d.jsxs("button",{onClick:Ce,className:"w-full px-4 py-3 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-3",children:[d.jsx(Lu,{className:"w-4 h-4"}),d.jsxs("div",{children:[d.jsx("div",{className:"font-medium",children:"Print Statement"}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Open printable version"})]})]}),d.jsxs("button",{onClick:oe,className:"w-full px-4 py-3 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-3",children:[d.jsx(co,{className:"w-4 h-4"}),d.jsxs("div",{children:[d.jsx("div",{className:"font-medium",children:"Download Excel"}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Export as XLSX file"})]})]})]})]})]})]}),d.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4 mb-6",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(sh,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 dark:text-gray-500"}),d.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Period:"}),d.jsxs("select",{value:m,onChange:ne=>{x(ne.target.value),p(Jr)},className:"px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors duration-200",children:[d.jsx("option",{value:"thisMonth",children:"This Month"}),d.jsx("option",{value:"lastMonth",children:"Last Month"}),d.jsx("option",{value:"custom",children:"Custom Range"})]})]}),m==="custom"&&d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"date",value:v,onChange:ne=>{b(ne.target.value),p(Jr)},className:"px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors duration-200"}),d.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"to"}),d.jsx("input",{type:"date",value:_,onChange:ne=>{k(ne.target.value),p(Jr)},className:"px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors duration-200"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(ih,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 dark:text-gray-500"}),d.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Type:"}),d.jsx("div",{className:"flex gap-2 overflow-x-auto",children:[{id:"all",label:"All"},{id:"income",label:"Income"},{id:"expense",label:"Expenses"},{id:"transfer",label:"Transfers"}].map(ne=>d.jsx("button",{onClick:()=>{l(ne.id),p(Jr)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 whitespace-nowrap ${o===ne.id?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-700":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:ne.label},ne.id))})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(oh,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 dark:text-gray-500"}),d.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Category:"}),d.jsxs("select",{value:c,onChange:ne=>{h(ne.target.value),p(Jr)},className:"px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors duration-200",children:[d.jsx("option",{value:"all",children:"All Categories"}),at&&d.jsx("option",{value:"uncategorized",children:"Uncategorized"}),we.map(ne=>d.jsx("option",{value:ne.id,children:ne.name},ne.id))]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 lg:ml-auto text-sm text-gray-500 dark:text-gray-400",children:[d.jsxs("span",{children:["Showing ",le.length," of ",B.length," transactions for ",ee.label]}),B.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"hidden sm:inline",children:"•"}),d.jsxs("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:["Total: ",N(Me)," for ",ke()]})]})]})]}),B.length>0?d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm",children:[d.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:le.map(ne=>{const xe=M.find(Mt=>Mt.id===ne.account_id),he=M.find(Mt=>Mt.id===ne.target_account_id),tt=z.find(Mt=>Mt.id===ne.category_id),Vt=U(ne.type),tr=I(ne.type);return d.jsx("div",{className:"p-4 sm:p-6 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 min-w-0 flex-1",children:[d.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center ${tr} flex-shrink-0`,children:d.jsx(Vt,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),d.jsxs("div",{className:"min-w-0 flex-1",children:[d.jsx("h3",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base truncate",children:ne.type==="transfer"?`Transfer: ${xe==null?void 0:xe.name} → ${he==null?void 0:he.name}`:ne.description||"Transaction"}),d.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2 text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:ne.type==="transfer"?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"truncate",children:ne.description||"Transfer"}),d.jsx("span",{className:"hidden sm:inline",children:"•"}),d.jsx("span",{className:"whitespace-nowrap",children:Ge(new Date(ne.date),"MMM d, yyyy")})]}):d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"truncate",children:xe==null?void 0:xe.name}),tt&&d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"hidden sm:inline",children:"•"}),d.jsxs("span",{className:"truncate flex items-center gap-1",style:{color:tt.color},children:[d.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:tt.color}}),tt.name]})]}),!tt&&d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"hidden sm:inline",children:"•"}),d.jsx("span",{className:"text-gray-400 dark:text-gray-500 italic",children:"Uncategorized"})]}),d.jsx("span",{className:"hidden sm:inline",children:"•"}),d.jsx("span",{className:"whitespace-nowrap",children:Ge(new Date(ne.date),"MMM d, yyyy")})]})})]})]}),d.jsxs("div",{className:"text-right flex items-center gap-2 sm:gap-3 ml-3",children:[d.jsxs("div",{children:[d.jsx("p",{className:`text-base sm:text-lg font-semibold ${tr}`,children:ne.type==="transfer"?N(Math.abs(ne.amount)):`${ne.type==="income"?"+":"-"}${N(Math.abs(ne.amount))}`}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:ne.type})]}),ne.sync_status==="pending"&&d.jsx("div",{className:"w-3 h-3 bg-orange-400 rounded-full flex-shrink-0",title:"Not synced"}),V&&d.jsxs("div",{className:"relative",children:[d.jsx("button",{onClick:()=>ge(ne.id),className:"p-2 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:d.jsx(ah,{className:"w-4 h-4"})}),f===ne.id&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>u(null)}),d.jsxs("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-20",children:[d.jsxs("button",{onClick:()=>{s(ne),u(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-2",children:[d.jsx(Fi,{className:"w-4 h-4"}),"Edit Transaction"]}),d.jsxs("button",{onClick:()=>{a(ne),u(null)},className:"w-full px-4 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2",children:[d.jsx(Di,{className:"w-4 h-4"}),"Delete Transaction"]})]})]})]})]})]})},ne.id)})}),Ee&&d.jsx("div",{className:"p-4 sm:p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:d.jsxs("button",{onClick:fe,className:"w-full flex items-center justify-center gap-2 px-4 py-3 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all duration-200 text-sm font-medium",children:[d.jsx(Bu,{className:"w-4 h-4"}),"Load More (",B.length-g," remaining)"]})})]}):d.jsxs("div",{className:"text-center py-12",children:[d.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:d.jsx(In,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),d.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 dark:text-white mb-2",children:o==="all"&&c==="all"?"No transactions yet":"No transactions match your filters"}),d.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 text-sm sm:text-base",children:o==="all"&&c==="all"?V?"Start by recording your first transaction":"No transactions have been recorded yet":"Try adjusting your filters or create a new transaction"}),V&&d.jsxs("button",{onClick:()=>t(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 dark:from-blue-500 dark:to-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all duration-200 inline-flex items-center gap-2 text-sm sm:text-base shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95",children:[d.jsx(Bn,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Add Transaction"]})]}),e&&V&&d.jsx(kd,{onClose:()=>t(!1),onSuccess:F}),n&&V&&d.jsx(vy,{transaction:n,onClose:()=>s(null),onSuccess:Y}),d.jsx(wd,{isOpen:!!i,title:"Delete Transaction",message:"Are you sure you want to delete this transaction? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",type:"danger",onConfirm:ue,onCancel:()=>a(null)}),C&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:d.jsxs("div",{className:"bg-white rounded-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 sticky top-0 bg-white rounded-t-2xl",children:[d.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Statement of Account - ",ee.label]}),d.jsx("button",{onClick:()=>R(!1),className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:"×"})]}),d.jsx(yy,{transactions:B,accounts:M,categories:z,dateRange:ee,exchangeRate:Z})]})})]})}function dE({onClose:r,onSuccess:e}){const[t,n]=J.useState(""),[s,i]=J.useState("expense"),[a,o]=J.useState("#6366f1"),[l,c]=J.useState(!1),[h,f]=J.useState(""),{user:u}=dr(),{createCategory:g}=Ht(),p=["#6366f1","#8b5cf6","#ec4899","#ef4444","#f97316","#f59e0b","#eab308","#84cc16","#22c55e","#10b981","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6"],m=async x=>{if(x.preventDefault(),!(!u||!t.trim())){c(!0),f("");try{await g({user_id:u.id,name:t.trim(),type:s,color:a}),e()}catch(v){console.error("Error creating category:",v),f(v.message||"Failed to create category. Please try again.")}finally{c(!1)}}};return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-3 sm:p-4 z-50",children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-md w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto border border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-900 rounded-t-2xl",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center",children:d.jsx(oh,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),d.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white",children:"Create Category"})]}),d.jsx("button",{onClick:r,className:"w-8 h-8 flex items-center justify-center text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:d.jsx(Qt,{className:"w-5 h-5"})})]}),d.jsxs("form",{onSubmit:m,className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[h&&d.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 text-red-700 dark:text-red-400 px-3 sm:px-4 py-2 sm:py-3 rounded-lg text-sm",children:h}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category Name"}),d.jsx("input",{id:"name",type:"text",value:t,onChange:x=>n(x.target.value),placeholder:"e.g., Groceries, Rent, Salary",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm sm:text-base transition-colors duration-200",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Category Type"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[d.jsxs("button",{type:"button",onClick:()=>i("income"),className:`p-3 sm:p-4 border-2 rounded-lg text-left transition-colors ${s==="income"?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`,children:[d.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[d.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base",children:"Income"})]}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Money coming in"})]}),d.jsxs("button",{type:"button",onClick:()=>i("expense"),className:`p-3 sm:p-4 border-2 rounded-lg text-left transition-colors ${s==="expense"?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`,children:[d.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[d.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base",children:"Expense"})]}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Money going out"})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Category Color"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("input",{type:"color",value:a,onChange:x=>o(x.target.value),className:"w-10 h-10 sm:w-12 sm:h-12 rounded-lg border border-gray-300 dark:border-gray-600 cursor-pointer"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Custom Color"}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Click to choose any color"})]})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Quick Colors"}),d.jsx("div",{className:"grid grid-cols-8 gap-2",children:p.map(x=>d.jsx("button",{type:"button",onClick:()=>o(x),className:`w-6 h-6 sm:w-8 sm:h-8 rounded-lg border-2 transition-all ${a===x?"border-gray-900 dark:border-gray-100 scale-110":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`,style:{backgroundColor:x}},x))})]})]})]}),d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[d.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:a}}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base",children:t||"Category Name"}),d.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-1 rounded-full capitalize",children:s})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 sticky bottom-0 bg-white dark:bg-gray-900 pb-2",children:[d.jsx("button",{type:"button",onClick:r,className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm sm:text-base",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:l||!t.trim(),className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 bg-purple-600 dark:bg-purple-500 text-white rounded-lg font-medium hover:bg-purple-700 dark:hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm sm:text-base",children:l?"Creating...":"Create Category"})]})]})]})})}function fE({addToast:r}){const e=dr(),{user:t}=e,n=(e==null?void 0:e.isAdmin)??!1,{categories:s,loadData:i,updateCategory:a,deleteCategory:o}=Ht(),[l,c]=J.useState(null),[h,f]=J.useState(!0),[u,g]=J.useState(!1),[p,m]=J.useState(!1),[x,v]=J.useState(null),[b,_]=J.useState(""),[k,O]=J.useState(""),[P,C]=J.useState("");J.useEffect(()=>{t&&(R(),i(t.id))},[t,i]);const R=async()=>{if(t)try{const{data:ee,error:B}=await Le.from("user_profiles").select("*").eq("id",t.id).single();if(B){console.error("Error loading profile:",B),r({type:"error",title:"Profile load failed"});return}c(ee),C(ee.full_name||"")}catch(ee){console.error("Error loading profile:",ee),r({type:"error",title:"Profile load failed"})}finally{f(!1)}},D=async()=>{if(!(!t||!l)){g(!0);try{const{error:ee}=await Le.from("user_profiles").update({full_name:P,currency:"NGN",updated_at:new Date().toISOString()}).eq("id",t.id);if(ee){console.error("Error saving profile:",ee),r({type:"error",title:"Save failed"});return}c(B=>B?{...B,full_name:P,currency:"NGN"}:null),r({type:"success",title:"Profile updated"})}catch(ee){console.error("Error saving profile:",ee),r({type:"error",title:"Save failed"})}finally{g(!1)}}},M=ee=>{v(ee.id),_(ee.name),O(ee.color)},z=async ee=>{try{const B=s.find(Ee=>Ee.id===ee);if(!B)return;const le={...B,name:b,color:k};await a(le),v(null),r({type:"success",title:"Category updated"})}catch(B){console.error("Error updating category:",B),r({type:"error",title:"Update failed"})}},G=async ee=>{if(confirm("Are you sure you want to delete this category?"))try{await o(ee),r({type:"success",title:"Category deleted"})}catch(B){console.error("Error deleting category:",B),r({type:"error",title:"Delete failed"})}},Z=()=>{v(null),_(""),O("")},Q=()=>{m(!1),r({type:"success",title:"Category created"})},V=s.filter(ee=>ee.type==="income"),me=s.filter(ee=>ee.type==="expense");return h?d.jsx("div",{className:"p-4 sm:p-6 bg-gray-50 dark:bg-gray-950 min-h-screen transition-colors duration-200",children:d.jsxs("div",{className:"text-center py-12",children:[d.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 dark:border-blue-400 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading settings..."})]})}):d.jsxs("div",{className:"p-4 sm:p-6 max-w-4xl mx-auto space-y-6 sm:space-y-8 bg-gray-50 dark:bg-gray-950 min-h-screen transition-colors duration-200",children:[d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700 p-4 sm:p-6 shadow-sm",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:d.jsx(Uu,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white",children:"Profile Settings"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm sm:text-base",children:n?"Manage administrator information":"Manage your profile information"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Full Name"}),d.jsx("input",{id:"fullName",type:"text",value:P,onChange:ee=>C(ee.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base transition-colors duration-200 placeholder-gray-400 dark:placeholder-gray-500",placeholder:"Enter your full name"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Default Currency"}),d.jsx("div",{className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg text-sm sm:text-base",children:"Nigerian Naira (₦)"}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Amounts will be displayed in Nigerian Naira"})]})]}),d.jsx("div",{className:"flex justify-end mt-6",children:d.jsxs("button",{onClick:D,disabled:u,className:"bg-gradient-to-r from-blue-600 to-blue-700 dark:from-blue-500 dark:to-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 dark:hover:from-blue-600 dark:hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-2 text-sm sm:text-base shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95",children:[d.jsx(Ra,{className:"w-4 h-4"}),u?"Saving...":"Save Changes"]})})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700 p-4 sm:p-6 shadow-sm",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center",children:d.jsx($u,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white",children:"Categories"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm sm:text-base",children:n?"Manage transaction categories":"View transaction categories"})]})]}),n&&d.jsxs("button",{onClick:()=>m(!0),className:"bg-gradient-to-r from-purple-600 to-purple-700 dark:from-purple-500 dark:to-purple-600 text-white px-4 py-2 rounded-lg font-medium hover:from-purple-700 hover:to-purple-800 dark:hover:from-purple-600 dark:hover:to-purple-700 transition-all duration-200 flex items-center justify-center gap-2 text-sm sm:text-base shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95",children:[d.jsx(Bn,{className:"w-4 h-4"}),"Add Category"]})]}),d.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 sm:gap-8",children:[d.jsxs("div",{children:[d.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Income Categories"]}),d.jsx("div",{className:"space-y-3",children:V.map(ee=>d.jsx("div",{className:"flex items-center justify-between p-3 sm:p-4 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:x===ee.id?d.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1",children:[d.jsx("input",{type:"color",value:k,onChange:B=>O(B.target.value),className:"w-6 h-6 sm:w-8 sm:h-8 rounded border border-gray-300 dark:border-gray-600"}),d.jsx("input",{type:"text",value:b,onChange:B=>_(B.target.value),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base transition-colors duration-200"}),d.jsxs("div",{className:"flex gap-1 sm:gap-2",children:[d.jsx("button",{onClick:()=>z(ee.id),className:"p-2 text-green-600 dark:text-green-400 hover:bg-green-100 dark:hover:bg-green-900/20 rounded-lg transition-colors",children:d.jsx(Ra,{className:"w-4 h-4"})}),d.jsx("button",{onClick:Z,className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:d.jsx(Qt,{className:"w-4 h-4"})})]})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[d.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:ee.color}}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base truncate",children:ee.name}),!ee.user_id&&d.jsx("span",{className:"text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-2 py-1 rounded-full whitespace-nowrap",children:"Default"})]}),ee.user_id&&d.jsxs("div",{className:"flex gap-1 sm:gap-2 ml-2",children:[d.jsx("button",{onClick:()=>M(ee),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors",children:d.jsx(Fi,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>G(ee.id),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:d.jsx(Di,{className:"w-4 h-4"})})]})]})},ee.id))})]}),d.jsxs("div",{children:[d.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),"Expense Categories"]}),d.jsx("div",{className:"space-y-3",children:me.map(ee=>d.jsx("div",{className:"flex items-center justify-between p-3 sm:p-4 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:x===ee.id?d.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1",children:[d.jsx("input",{type:"color",value:k,onChange:B=>O(B.target.value),className:"w-6 h-6 sm:w-8 sm:h-8 rounded border border-gray-300 dark:border-gray-600"}),d.jsx("input",{type:"text",value:b,onChange:B=>_(B.target.value),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base transition-colors duration-200"}),d.jsxs("div",{className:"flex gap-1 sm:gap-2",children:[d.jsx("button",{onClick:()=>z(ee.id),className:"p-2 text-green-600 dark:text-green-400 hover:bg-green-100 dark:hover:bg-green-900/20 rounded-lg transition-colors",children:d.jsx(Ra,{className:"w-4 h-4"})}),d.jsx("button",{onClick:Z,className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:d.jsx(Qt,{className:"w-4 h-4"})})]})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[d.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:ee.color}}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm sm:text-base truncate",children:ee.name}),!ee.user_id&&d.jsx("span",{className:"text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-2 py-1 rounded-full whitespace-nowrap",children:"Default"})]}),ee.user_id&&d.jsxs("div",{className:"flex gap-1 sm:gap-2 ml-2",children:[d.jsx("button",{onClick:()=>M(ee),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors",children:d.jsx(Fi,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>G(ee.id),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:d.jsx(Di,{className:"w-4 h-4"})})]})]})},ee.id))})]})]})]}),p&&n&&d.jsx(dE,{onClose:()=>m(!1),onSuccess:Q})]})}function uE({id:r,type:e,title:t,message:n,duration:s=4e3,onClose:i}){J.useEffect(()=>{const h=setTimeout(()=>{i(r)},s);return()=>clearTimeout(h)},[r,s,i]);const a={success:Wu,error:Hu,warning:zu,info:Vu},o={success:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-700 text-green-800 dark:text-green-300",error:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-700 text-red-800 dark:text-red-300",warning:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-700 text-yellow-800 dark:text-yellow-300",info:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-700 text-blue-800 dark:text-blue-300"},l={success:"text-green-500 dark:text-green-400",error:"text-red-500 dark:text-red-400",warning:"text-yellow-500 dark:text-yellow-400",info:"text-blue-500 dark:text-blue-400"},c=a[e];return d.jsx("div",{className:`max-w-xs sm:max-w-sm w-full ${o[e]} border rounded-lg shadow-lg p-3 sm:p-4 pointer-events-auto transition-colors duration-200`,children:d.jsxs("div",{className:"flex items-start",children:[d.jsx("div",{className:"flex-shrink-0",children:d.jsx(c,{className:`h-4 w-4 sm:h-5 sm:w-5 ${l[e]}`})}),d.jsxs("div",{className:"ml-2 sm:ml-3 w-0 flex-1",children:[d.jsx("p",{className:"text-sm font-medium",children:t}),n&&d.jsx("p",{className:"mt-1 text-xs sm:text-sm opacity-90",children:n})]}),d.jsx("div",{className:"ml-2 sm:ml-4 flex-shrink-0 flex",children:d.jsx("button",{onClick:()=>i(r),className:"inline-flex text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",children:d.jsx(Qt,{className:"h-3 w-3 sm:h-4 sm:w-4"})})})]})})}function q0({toasts:r,onClose:e}){return d.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:d.jsx("div",{className:"flex flex-col items-center space-y-2 max-w-xs sm:max-w-sm w-full px-4",children:r.map(t=>d.jsx(uE,{...t,onClose:e},t.id))})})}function J0({pwaHook:r}){const{showInstallPrompt:e,isIOS:t,isAndroid:n,canInstall:s,installApp:i,dismissInstallPrompt:a,timeSpent:o,pagesVisited:l,engagementMet:c}=r;if(!e)return null;const h=async()=>{s&&await i()},f=()=>t?d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:d.jsxs("p",{children:["To install: Tap ",d.jsx("strong",{children:"Share"})," → ",d.jsx("strong",{children:"Add to Home Screen"})]})}):null,u=()=>["Instant access from your home screen","Works offline when you're not connected","Faster loading and smoother experience","No browser bars for distraction-free use"];return d.jsx("div",{className:"fixed bottom-20 left-4 right-4 lg:bottom-4 lg:left-auto lg:right-4 lg:max-w-sm z-50 animate-slide-up",children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 p-4 backdrop-blur-sm",children:[d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-blue-700 dark:from-blue-500 dark:to-blue-600 rounded-xl flex items-center justify-center flex-shrink-0 shadow-lg",children:n||!t&&window.innerWidth<768?d.jsx(Gu,{className:"w-6 h-6 text-white"}):d.jsx(Xu,{className:"w-6 h-6 text-white"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("h3",{className:"font-bold text-gray-900 dark:text-white text-base",children:"Install FinTrack App"}),d.jsx("button",{onClick:a,className:"p-1 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors flex-shrink-0",children:d.jsx(Qt,{className:"w-4 h-4"})})]}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Get the full app experience with these benefits:"}),d.jsx("ul",{className:"text-xs text-gray-500 dark:text-gray-400 space-y-1 mb-3",children:u().slice(0,2).map((g,p)=>d.jsxs("li",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-1 h-1 bg-blue-500 rounded-full flex-shrink-0"}),g]},p))}),d.jsxs("div",{className:"flex items-center gap-3 mb-3 text-xs text-gray-500 dark:text-gray-400",children:[d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(Ku,{className:"w-3 h-3"}),d.jsxs("span",{children:[o,"s spent"]})]}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(th,{className:"w-3 h-3"}),d.jsxs("span",{children:[l," pages viewed"]})]})]}),f()]})]}),s&&!t&&d.jsxs("div",{className:"mt-4 flex gap-2",children:[d.jsxs("button",{onClick:h,className:"flex-1 bg-gradient-to-r from-blue-600 to-blue-700 dark:from-blue-500 dark:to-blue-600 text-white px-4 py-2.5 rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all duration-200 flex items-center justify-center gap-2 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95",children:[d.jsx(co,{className:"w-4 h-4"}),"Install App"]}),d.jsx("button",{onClick:a,className:"px-4 py-2.5 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 text-sm font-medium transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:"Later"})]}),t&&d.jsx("div",{className:"mt-4 flex justify-end",children:d.jsx("button",{onClick:a,className:"px-4 py-2.5 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 text-sm font-medium transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:"Got it"})})]})})}function Z0({isAppInstalled:r,newServiceWorker:e}){const[t,n]=J.useState(!1);J.useEffect(()=>{e&&n(!0)},[e]);const s=()=>{e&&(e.postMessage({type:"SKIP_WAITING"}),n(!1),window.location.reload())},i=()=>{n(!1)};return!t||!r||!e?null:d.jsx("div",{className:"fixed top-4 left-4 right-4 lg:left-auto lg:right-4 lg:max-w-sm z-50 animate-slide-up",children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-4 backdrop-blur-sm",children:[d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-600 to-green-700 dark:from-green-500 dark:to-green-600 rounded-lg flex items-center justify-center flex-shrink-0",children:d.jsx(Oi,{className:"w-5 h-5 text-white"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-sm",children:"Update Available"}),d.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"A new version of FinTrack is ready to install"})]}),d.jsx("button",{onClick:i,className:"p-1 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors flex-shrink-0",children:d.jsx(Qt,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"mt-3 flex gap-2",children:[d.jsxs("button",{onClick:s,className:"flex-1 bg-gradient-to-r from-green-600 to-green-700 dark:from-green-500 dark:to-green-600 text-white px-3 py-2 rounded-lg text-sm font-medium hover:from-green-700 hover:to-green-800 dark:hover:from-green-600 dark:hover:to-green-700 transition-all duration-200 flex items-center justify-center gap-2",children:[d.jsx(Oi,{className:"w-4 h-4"}),"Update Now"]}),d.jsx("button",{onClick:i,className:"px-3 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 text-sm font-medium transition-colors",children:"Later"})]})]})})}function gE(){const[r,e]=J.useState("dashboard"),[t,n]=J.useState(!1),[s,i]=J.useState(!1),a=dr(),{user:o,loading:l,initialize:c}=a,h=(a==null?void 0:a.isAdmin)??!1,{updateSyncStatus:f}=Ht(),{toasts:u,addToast:g,removeToast:p}=Mx();Lh();const m=Lx(r);if(J.useEffect(()=>{(async()=>{c(),await Ye()})()},[c]),J.useEffect(()=>{const _=setInterval(f,5e3);return()=>clearInterval(_)},[f]),J.useEffect(()=>{const _=new URLSearchParams(window.location.search),k=_.get("action"),O=_.get("tab");k==="add-transaction"&&o&&i(!0),O&&o&&e(O)},[o]),l)return d.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 flex items-center justify-center transition-colors duration-200",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 dark:border-blue-400 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading..."})]})});if(!o)return d.jsxs(d.Fragment,{children:[d.jsx(Bx,{}),d.jsx(q0,{toasts:u,onClose:p}),d.jsx(J0,{pwaHook:m}),d.jsx(Z0,{isAppInstalled:m.isInstalled,newServiceWorker:m.newWorker})]});const x=()=>{switch(r){case"dashboard":return"Dashboard";case"accounts":return"Accounts";case"transactions":return"Transactions";case"settings":return"Settings";default:return"Dashboard"}},v=()=>{const _={addToast:g};switch(r){case"dashboard":return d.jsx(c0,{..._});case"accounts":return d.jsx(py,{..._});case"transactions":return d.jsx(hE,{..._});case"settings":return d.jsx(fE,{..._});default:return d.jsx(c0,{..._})}},b=()=>{i(!1),g({type:"success",title:"Transaction added"})};return d.jsxs("div",{className:"h-screen bg-gray-50 dark:bg-gray-950 flex transition-colors duration-200",children:[t&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>n(!1)}),d.jsx("div",{className:`
        fixed lg:static inset-y-0 left-0 z-50 w-64 transform transition-transform duration-300 ease-in-out lg:transform-none
        ${t?"translate-x-0":"-translate-x-full lg:translate-x-0"}
      `,children:d.jsx(Ux,{activeTab:r,onTabChange:_=>{e(_),n(!1)},isAdmin:h})}),d.jsxs("div",{className:"flex-1 flex flex-col min-w-0 lg:ml-0",children:[d.jsx($x,{title:x(),onMenuClick:()=>n(!0)}),d.jsxs("main",{className:"flex-1 overflow-auto relative",children:[d.jsx("div",{className:"min-h-full",children:v()}),d.jsx("div",{className:"px-4 sm:px-6 py-3 mb-16 lg:mb-0",children:d.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:["ChurchTrack ver. 1.2.0 by"," ",d.jsx("a",{href:"https://elxis.com.ng",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors",children:"eLxis"})]})})]})]}),d.jsx(Wx,{activeTab:r,onTabChange:e,onAddTransaction:()=>i(!0),isAdmin:h}),s&&h&&d.jsx(kd,{onClose:()=>i(!1),onSuccess:b}),d.jsx(J0,{pwaHook:m}),d.jsx(Z0,{isAppInstalled:m.isInstalled,newServiceWorker:m.newWorker}),d.jsx(q0,{toasts:u,onClose:p})]})}dh(document.getElementById("root")).render(d.jsx(J.StrictMode,{children:d.jsx(gE,{})}));
